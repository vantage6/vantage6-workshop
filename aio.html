<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Introduction to vantage6: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/incubator/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicons/incubator/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicons/incubator/favicon-16x16.png">
<link rel="manifest" href="favicons/incubator/site.webmanifest">
<link rel="mask-icon" href="favicons/incubator/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Introduction to vantage6
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Introduction to vantage6
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introduction to vantage6
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="chap1_introduction_FL.html">1. Introduction to privacy enhancing technologies (PET)</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="chap2_introduction_v6.html">2. vantage6 basics</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="chap3_run_analysis_ui.html">3. Running a PET analysis without programming on vantage6</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="chap4_manage_via_ui.html">4. Managing vantage6 server via the user interface</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="chap5_python_client.html">5. Running a PET analysis using the Python client</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="chap6_setup_node.html">6. Setting up a vantage6 node</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="chap7_algo_dev.html">7. Algorithm development</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="chap8_own_project.html">8. Work on your own project</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-chap1_introduction_FL"><p>Content from <a href="chap1_introduction_FL.html">Introduction to privacy enhancing technologies (PET)</a></p>
<hr>
<p>Last updated on 2024-11-18 |

        <a href="https://github.com/vantage6/vantage6-workshop/edit/main/episodes/chap1_introduction_FL.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What techniques exist for analyzing data while protecting
privacy?</li>
<li>What are issues with only using data anonymization or
pseudonymization?</li>
<li>What are the building blocks to create a privacy enhancing
analysis?</li>
<li>What what are some non-technical challenges for performing privacy
enhancing analysis?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand PET, FL, MPC, homomorphic encryption, differential
privacy</li>
<li>Understand how different PET techniques relate</li>
<li>Understand scenarios where PET could be applied</li>
<li>Understand horizontal vs vertical partitioning</li>
<li>Decompose a simple analysis in a federated way</li>
<li>Understand that there is paperwork to be done (DPIA etc.)</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>In this course, we will explore how privacy-enhancing technologies
(PETs) can support your research. On the first day, we will cover some
of the core concepts of PET analysis, followed by a hands-on session
where we’ll apply these techniques using the vantage6 user interface. We
will also discuss how to manage PET analysis collaborations, one of the
vantage6’s key distinguising features.</p>
<p>In the second part of the workshop, we will focus on the python
client, which can do the same as the UI, but also much more. You will
also learn how to create a federated algorithm using the platform’s
algorithm tools.</p>
<p>This course provides a high-level overview of PETs, focusing on their
practical applications in data analysis. While we won’t dive into the
detailed mathematics behind these technologies, we encourage you to
explore other resources for those specifics. Our goal here is to equip
you with enough knowledge to apply PETs effectively in your work.</p>
</section><section><h2 class="section-heading" id="problem-statement">Problem statement<a class="anchor" aria-label="anchor" href="#problem-statement"></a>
</h2>
<hr class="half-width">
<p>The amount of data being generated nowadays is absolutely
mind-boggling. This data can be a valuable resource for researchers.
However, personal data should be handled with great care and
responsibility because of its sensitive nature. This is why there are
privacy regulations in place like <a href="https://gdpr-info.eu/" class="external-link">GDPR</a> to prohibit easy access to this
wealth of data.</p>
<p>However, often researchers are not interested in the personal records
that make up the data, but rather in the <em>insights</em> derived from
it. This raises an intriguing question: Can we unlock these valuable
insights in a manner that upholds and respects privacy standards?</p>
<p>In classic data analysis, all data is copied over into a single
place. This makes it very easy to use conventional data analysis
software and tools to gain insights.</p>
<figure><img src="fig/chapter1/classic_analysis.jpg" alt="Two tables with data are moved to a central location" class="figure mx-auto d-block"><div class="figcaption">In classic analysis all the data is brought
together</div>
</figure><p>Unfortunately this way of working does not respect the privacy of the
people contained within the dataset. All their personal details end up
at another party.</p>
<div id="other-problems-with-copying-data" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="other-problems-with-copying-data" class="callout-inner">
<h3 class="callout-title">1. Other problems with copying data</h3>
<div class="callout-content">
<p>There are other issues with copying data to a central place that are
not directly related to privacy. Some examples:</p>
<ul>
<li>The original data owner loses control of the data</li>
<li>Results in multiple versions of the data</li>
<li>What to do when the data needs to be updated?</li>
<li>If there was consent in the first place, how can you retract
consent?</li>
</ul>
</div>
</div>
</div>
<div id="data-sharing-story-time" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="data-sharing-story-time" class="callout-inner">
<h3 class="callout-title">1. Data sharing story time</h3>
<div class="callout-content">
<p>Now it’s your turn. Have you personally experienced any issues doing
research with data collected into a central place? Discuss with your
peers.</p>
</div>
</div>
</div>
<p>In this lesson, we will discuss various privacy-enhancing
technologies (PET) that can be used to analyze data in a
privacy-preserving manner, and what the risks associated with different
technologies are.</p>
</section><section><h2 class="section-heading" id="data-anonymization-and-pseudonymization">Data anonymization and pseudonymization<a class="anchor" aria-label="anchor" href="#data-anonymization-and-pseudonymization"></a>
</h2>
<hr class="half-width">
<p>The first step in the process is often <em>data anonymization</em>.
Personal identifiable information will in this case be removed so that
individuals stay anonymous. Data <em>pseudonimization</em> is a similar
process, but in this case, the records will be assigned an id that will
make it possible to link individuals across datasets.</p>
<figure><img src="fig/chapter1/data_anonymization.jpg" alt="Names are censored before the datasets are sent to a central place" class="figure mx-auto d-block"><div class="figcaption">Data anonymization</div>
</figure><p>While data anonymization and pseudonymization are often a good first
step, there is no guarantee that the data will never be reidentified. A
famous example of reidentification is the story of the <a href="https://en.wikipedia.org/wiki/Netflix_Prize" class="external-link">Netflix prize</a>.
The Netflix prize was an open competition to build the best recommender
system to predict user ratings for films based on previous ratings. The
data was anonymized, but in 2007 two researchers from The University of
Texas at Austin were able to identify a large number of users by
matching the dataset with film ratings on the Internet Movie Database
(IMDB).</p>
</section><section><h2 class="section-heading" id="federated-data-analysis">Federated data analysis<a class="anchor" aria-label="anchor" href="#federated-data-analysis"></a>
</h2>
<hr class="half-width">
<p>There are different ways in which privacy risks can be mitigated. For
example, a well-known technique is to send the data to a trusted third
party (TTP). The data can then be analyzed at that location in a
traditional way. However, there are issues with this technique. When the
data is copied to the TTP, the original owner loses control over it.
Another issue with it is that this technique results in a single point
of failure. If the security at the TTP is breached, all the data it
handled could be exposed.</p>
<p>In this course we will focus on federated analysis. In a federated
setting, the data with the data owner, who keeps full control over it.
In this case, it is not the data that travels, but the analysis itself.
The system sends a query or instruction to the data and only the results
will get back to the user. The results are often akin to a form of
<em>aggregation</em> of the data. This can be in the shape of
traditional statistics like the mean, or it can be more intricate like a
machine learning model. When data is aggregated, it doesn’t have a
direct link with an individual anymore. Since the aggregated data cannot
be be traced back to individuals individuals directly, the privacy is
considered protected.</p>
<p>Aggregating the data does not ensure complete protection of
person-level information, but it certainly makes it less likely that
this will happen. It is usually the case that the larger the dataset,
the lower the risk of data leakage. For instance, if you would like to
take the mean of all records that fit a certain requirement, like age
&gt; 90, and there happens to be only one records that fits the
requirement, the aggregation will be equal to the one matching
individual record.</p>
<figure><img src="fig/chapter1/federated_sum.jpg" alt="In federated analysis, an aggregation of the local data is sent to a central point. At the central point the local aggregations are combined. This can also be a small step in a larger analysis." class="figure mx-auto d-block"><div class="figcaption">In federated analysis, an aggregation of the
local data is sent to a central point. At the central point the local
aggregations are combined. This can also be a small step in a larger
analysis.</div>
</figure></section><section><h2 class="section-heading" id="federated-learning">Federated learning<a class="anchor" aria-label="anchor" href="#federated-learning"></a>
</h2>
<hr class="half-width">
<p>The term federated learning was introduced in 2016 by researchers at
Google <a href="https://doi.org/10.48550/arXiv.1602.05629" class="external-link">(McMahan et
al.)</a> and refers to a “loose federation of participating devices
(which we refer to as clients) which are coordinated by a central
server.” In traditional federated learning, the clients train machine
learning models, and only the updates of the models are sent back to the
central server. The central server combines the updates from all the
individual clients into one final machine learning model.</p>
<figure><img src="fig/chapter1/federated_learning.jpg" alt="In federated learning only the gradients of models are shared" class="figure mx-auto d-block"><div class="figcaption">In federated learning only the gradients of
models are shared</div>
</figure><p>There are caveats to using this type of data analysis though.
Although the data transmitted from the clients to the server are an
aggregation of the raw data, researchers have found a way to use this
data to reconstruct the original data. This vulnerability is called
<em>gradient leakage</em>.</p>
<figure><img src="fig/chapter1/gradient_leakage.jpg" alt="An example of gradient leakage. The order might not be correct but the images are still very close to the originals." class="figure mx-auto d-block"><div class="figcaption">An example of gradient leakage. The order might
not be correct but the images are still very close to the
originals.</div>
</figure></section><section><h2 class="section-heading" id="secure-multiparty-computation">Secure Multiparty Computation<a class="anchor" aria-label="anchor" href="#secure-multiparty-computation"></a>
</h2>
<hr class="half-width">
<p>There are different solutions to prevent the reconstruction of raw
data. One solution is to make sure that no party other than the data
owner is actually able to see the intermediate data. One branch of
techniques that can be used for this is Secure Multiparty Computation
(MPC). With MPC, computations are performed collaboratively by multiple
parties. Data is encrypted in such a way that other parties cannot see
the original values, but values of multiple parties can still be
combined ( e.g. added or multiplied). A classic technique from the field
of MPC is secret sharing. With this technique data is encrypted, after
which pieces of the encryption are sent to the other parties. No single
party will be able to reconstruct the original value. Only when a
certain minimum of parties work together (n-1 in many cases) the
original value can be retrieved.</p>
<p>When combining multiple values using secret sharing, this will result
in the parties owning new puzzle pieces that when put together will
reveal the result of the computation.</p>
<figure><img src="fig/chapter1/mpc.jpg" alt="In secure multiparty computation parties collaboratively perform an analysis while holding only encrypted pieces of the data" class="figure mx-auto d-block"><div class="figcaption">In secure multiparty computation parties
collaboratively perform an analysis while holding only encrypted pieces
of the data</div>
</figure><div id="secret-sharing-an-example" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="secret-sharing-an-example" class="callout-inner">
<h3 class="callout-title">Secret sharing, an example</h3>
<div class="callout-content">
<p>Mees, Sara and Noor want to know how much they weigh in total. Mees
weighs 43 kg, Sara weighs 39, Noor weighs 45. All three they think of 2
random numbers <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span> so that <span class="math inline">\(weight = r_1 + r_2 + x\)</span>. Finally they
compute <span class="math inline">\(x\)</span> by <span class="math inline">\(x=weight - r_1 - r_2\)</span>. These random
numbers can be seen as encrypted data.</p>
<p>After computing the secret shares, they distribute these
“cryptographical puzzle pieces” among their peers.</p>
<figure><img src="fig/chapter1/secret_sharing_example_1.jpg" alt="Mees, Sara and Noor distibute their secret shares" class="figure mx-auto d-block"><div class="figcaption">Mees, Sara and Noor distibute their secret
shares</div>
</figure><table class="table">
<colgroup>
<col width="26%">
<col width="22%">
<col width="22%">
<col width="22%">
<col width="5%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>Mees receives</th>
<th>Sara receives</th>
<th>Noor receives</th>
<th>Sum</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Mees generates:</td>
<td>-11</td>
<td>50</td>
<td>4</td>
<td>43</td>
</tr>
<tr class="even">
<td>Sara generates:</td>
<td>-12</td>
<td>17</td>
<td>34</td>
<td>39</td>
</tr>
<tr class="odd">
<td>Noor generates:</td>
<td>19</td>
<td>-38</td>
<td>64</td>
<td>45</td>
</tr>
</tbody>
</table>
<p>They sum their shares:</p>
<table class="table"><tbody>
<tr class="odd">
<td>Mees</td>
<td>-4</td>
</tr>
<tr class="even">
<td>Sara</td>
<td>29</td>
</tr>
<tr class="odd">
<td>Noor</td>
<td>102</td>
</tr>
</tbody></table>
<figure><img src="fig/chapter1/secret_sharing_example_2.jpg" alt="Mees, Sara and Noor sum their secret shares" class="figure mx-auto d-block"><div class="figcaption">Mees, Sara and Noor sum their secret
shares</div>
</figure><p>They add their sums together: -4 + 29 + 102 = 127 In this way, they
have aggregated their data without sharing their individual data with
anyone else.</p>
<figure><img src="fig/chapter1/secret_sharing_example_3.jpg" alt="Mees, Sara and Noor add their shares together for the final result" class="figure mx-auto d-block"><div class="figcaption">Mees, Sara and Noor add their shares together
for the final result</div>
</figure>
</div>
</div>
</div>
<div id="oh-no-a-hacker" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="oh-no-a-hacker" class="callout-inner">
<h3 class="callout-title">Oh no! A hacker!</h3>
<div class="callout-content">
<p>A hacker manages to get access to Mees’ computer that contains his
data and the secret shares he received. He also knows the result of the
aggregation. Will the secrecy of the three weights still be preserved?
What if the hacker gets access to Sara’s computer as well? Will Noors
privacy be protected?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>If the hacker has access to the result, he can reconstruct Noors
weight by subtracting Mees’ and Sara’s weight from the total. The secret
shares are not adding any more relevant information.</p>
</div>
</div>
</div>
</div>
<div id="aggregation-preserves-privacy" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="aggregation-preserves-privacy" class="callout-inner">
<h3 class="callout-title">3. Aggregation preserves privacy?</h3>
<div class="callout-content">
<p>Consider the dataset with the 3 childrens weights again. The only
unencrypted data everybody receives, is the result. Consider the
situation where Sara knows Mees very well, and might know approximately
how much he weighs. Do you think the privacy of the three individuals is
properly preserved?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>When receiving a sum from a set of 3 individuals, every record makes
up roughly 30% of the final answer. That is a big contribution. It can
be quite easy to reconstruct the individual records, for example by
crossreferencing with other datasets. Also, if you are able to get your
hands on 2 of the datapoints, you will be able to fully reconstruct the
third one.</p>
<p>Usually there are guard rails in place when performing PET analysis
to reject situations where there are very few datapoints, because the
original data is too easy to reconstruct.</p>
<p>Trust is another factor here. If the different parties (Mees, Sara
and Noor) have a high level of trust in eachother not to share their
data, the risk level is lower than when the parties are known to
occasionally leak their data, or don’t have proper security set in
place.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="differential-privacy">Differential privacy<a class="anchor" aria-label="anchor" href="#differential-privacy"></a>
</h2>
<hr class="half-width">
<p>As mentioned before, aggregation of data will not always prevent
leaks of sensitive information. Consider the example of Mees, Sara and
Noor. We know their total weight is 127 kg. If Sara and Noor get
together and subtract their weights off of the total, they will be able
to infer how much Mees weighs.</p>
<p>An aggregation is fully differentially private when someone cannot
infer whether a particular individual was used in the computation. In
the field of differential privacy there are different techniques for
adapting analyses to be more differentially private. Often these
techniques involve adding noise to either the raw data or the result of
the analysis. This makes the result less precise, but with the added
benefit that it will be more difficult to infer the original data.</p>
<p>The figure below shows a differential privacy technique where a
random subset of the data is replaced with random values. This gives an
individual plausible deniability regarding whether they were part of the
original dataset. Their data might have been used, or it might have been
replaced with noise.</p>
<figure><img src="fig/chapter1/differential_privacy.jpg" alt="Differential privacy sometimes replaces a subset of the data with random values" class="figure mx-auto d-block"><div class="figcaption">Differential privacy sometimes replaces a subset
of the data with random values</div>
</figure></section><section><h2 class="section-heading" id="blocks-upon-blocks">Blocks upon blocks<a class="anchor" aria-label="anchor" href="#blocks-upon-blocks"></a>
</h2>
<hr class="half-width">
<p>The previously mentioned techniques are not used in isolation, but
are usually stacked on top of eachother to mitigate the privacy risks
that are relevant within the usecase. Typically, the process begins by
anonymizing or pseudonymizing the data. With vantage6, the data is then
placed in a federated setting. Then, the data is analyzed using
federated learning, which may also include, for instance, MPC protocols
to further safeguard data privacy. Additionally, noise may be added to
the raw data as well before it is analyzed, using techniques from
differential privacy.</p>
</section><section><h2 class="section-heading" id="data-partitioning">Data partitioning<a class="anchor" aria-label="anchor" href="#data-partitioning"></a>
</h2>
<hr class="half-width">
<p>Data sharing challenges come in many different shapes and sizes, but
in the end, the goal of the researchers is often to analyze data <em>as
if</em> it were available in one big table in one place. There are 2
main ways in which the dataset can be separated over different sources:
<strong>horizontal</strong> and <strong>vertical</strong>
partioning.</p>
<p>In horizontal partitioning, this giant table has been snipped in
pieces by making horizontal cuts. The result is that information of an
individual record will stay in one place, but the records themselves
have been scattered around in different locations. A common example of
horizontal partitioning is when different hospitals have the same data
on different patients.</p>
<p>In vertical partitioning, the cuts have been made vertically. Columns
have now been divided over different locations. For example, this would
be the case if a hospital has data on a set of patients and the GP has
different information for the same set of patients. This type of
partitioning is usually more challenging because often a way needs to be
found to link identities across datasources. Vertical partitioning
requires different types of privacy enhancing algorithms than horizontal
partitioning.</p>
<p>Data can even be horizontally and vertically partitioned at the same
time. In these cases, it may be necessary to combine multiple
techniques. For example, you might want to combine census data with
medical records from hospitals. This is vertically partitioned because
the census and medical features are stored in different places. On top
of that, you might want to combine multiple hospitals, that all store
their records separately. Since the medical records are physically
separated as well, it is horizontally partitioned.</p>
<figure><img src="fig/chapter1/horizontal_vertical_partitioning.jpg" alt="Horizontal and vertical partitioning refers to how data is separated" class="figure mx-auto d-block"><div class="figcaption">Horizontal and vertical partitioning refers to
how data is separated</div>
</figure></section><section><h2 class="section-heading" id="technology-doesnt-solve-everything">Technology doesn’t solve everything<a class="anchor" aria-label="anchor" href="#technology-doesnt-solve-everything"></a>
</h2>
<hr class="half-width">
<p>You have now learned about various technologies for analyzing data
while preserving privacy of individuals. However, it should be
emphasized that these technologies do not solve all your data sharing
problems. Rather, they are only a small piece of the puzzle. In research
projects involving privacy enhancing technologies, a lot of work goes
into complying with regulations and building trust.</p>
<p>Since these projects have a risk of affecting the privacy of
individuals, a Data Protection Impact Assessment (DPIA) is usually
required. This is a process that will help identify and minimize privacy
risks of a project and is required by the GDPR. There is already a <a href="https://vantage6.ai/documents/28/DPIA_vantage6_version2023.pdf" class="external-link">DPIA
available for vantage6</a></p>
<p>Apart from procedures required by GDPR there might be other
regulations in place enforced by the owners of the data
(e.g. hospitals). For healthcare specifically there will be the <a href="https://health.ec.europa.eu/ehealth-digital-health-and-care/european-health-data-space_en" class="external-link">European
Health Data Space (EHDS)</a>. EHDS builds upon the GDPR and ensures the
exchange and reuse of healthcare data in a safe and secure way.</p>
<p>The specific situation of a project can affect the way in which the
data is allowed to be processed. Some privacy enhancing technologies
might be allowed in one project but prohibited in another. It is always
important to stay transparent about privacy risks of the technologies
you intend to use.</p>
<p>Another factor in performing PET analysis is <em>data
harmonization</em>. All parties need to make sure that their data is in
the right shape to be combined. For instance, if you have two datasets
where one stores the height of patients in a column “height” in
centimeters, and another dataset where it is stored in meters in the
column “patient_height” you cannot perform your analysis. You will need
to make sure all datasets follow the same standards and schemas in order
to process them together. There are a couple of datastandards out there
to help you with that, such as <a href="https://www.ohdsi.org/data-standardization/" class="external-link">OMOP CDM</a> or <a href="https://hl7.org/fhir/" class="external-link">FHIR</a> together with <a href="https://www.snomed.org/" class="external-link">SNOMED-CT</a>.</p>
<p>In conclusion, PETs will help you to extract valuable insights from
sensitive data, but they are only one aspect of the process. It is also
important to consider other factors such as regulations and data
preprocessing.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Privacy enhancing analysis can derive insights from data without
seeing individual records.</li>
<li>Privacy enhancing analysis usually starts with the anonymization or
pseudonymization of the data.</li>
<li>In federated data analysis the analysis moves to the data, while in
classic analysis the data moves around.</li>
<li>In secure multiparty computation, computations are performed
collaboratively without any one party being able to see all the raw
data.</li>
<li>Techniques from differential privacy add noise to the data to make
it harder to reconstruct the original records from an aggregation.</li>
<li>Privacy enhancing analyses usually stack multiple techniques on top
of each other to provide multiple layers of protection.</li>
<li>Horizontal partitioning means the records are split, while in
vertical partitioning the features are split.</li>
<li>Technology is only one part of the story, when doing research on
privacy sensitive data.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-chap2_introduction_v6"><p>Content from <a href="chap2_introduction_v6.html">vantage6 basics</a></p>
<hr>
<p>Last updated on 2024-10-03 |

        <a href="https://github.com/vantage6/vantage6-workshop/edit/main/episodes/chap2_introduction_v6.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Why should I use vantage6?</li>
<li>How does vantage6 work?</li>
<li>How do federated algorithms run in vantage6?</li>
<li>What will be available in vantage6 in the future?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>List the high-level infrastructure components of vantage6 (server,
client, node)</li>
<li>Understand the added value of vantage6</li>
<li>Understand that there are different actors in the vantage6
network</li>
<li>Understand that the vantage6 server does not run algorithms</li>
<li>Explain how a simple analysis runs on vantage6</li>
<li>Understand the future of vantage6 (policies, etc.)</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="why-choose-vantage6">Why choose vantage6<a class="anchor" aria-label="anchor" href="#why-choose-vantage6"></a>
</h2>
<hr class="half-width">
<p>vantage6 is a platform to execute privacy enhancing techniques
(PETs). Several alternative platforms for PETs are available, but
vantage6 is unique as it provides:</p>
<ul>
<li>Open source and free to use under Apache-2.0 licence.</li>
<li>Container orchestration for privacy enhancing techniques.</li>
<li>Easily extensible to different types of data sources.</li>
<li>Algorithms can be developed in any language.</li>
<li>A Graphical User Interface is provided to operate the platform.</li>
<li>Other applications can connect to vantage6 using the API.</li>
<li>Managing and enforcing collaboration policies</li>
<li>Minimal network requirements at data stations</li>
</ul></section><section><h2 class="section-heading" id="project-administration-in-vantage6">Project administration in vantage6<a class="anchor" aria-label="anchor" href="#project-administration-in-vantage6"></a>
</h2>
<hr class="half-width">
<p>vantage6 encompasses a project administration system that allows the
user to manage permissions and access to the resources, while assuring
the protection of the data. The fundamental concepts of the
administration system are defined as follows:</p>
<ul>
<li>An <strong>Organization</strong> is a group of users that share a
common goal or interest (e.g., a consortium, an institute, etc.).</li>
<li>A <strong>Collaboration</strong> involves one or more
<strong>organizations</strong> working together towards a shared
objective.</li>
<li>A <strong>Node</strong> is a vantage6 component with access to the
<strong>organization</strong> data, which is capable of executes
algorithms on it. It represents the organization’s contributions to the
network.</li>
<li>A <strong>Task</strong> is a request for the execution of a given
analysis <strong>algorithm</strong> on one or more
<strong>organizations</strong> within a <strong>collaboration</strong>.
These execution requests are handled by the corresponding organizations’
<strong>nodes</strong>.</li>
<li>A <strong>user</strong> is a person that belongs to one
<strong>organization</strong> who can create <strong>tasks</strong> for
one or more <strong>organizations</strong> within a
<strong>collaboration</strong>.</li>
<li>An <strong>algorithm</strong> is a computational model or process
-that adhere to the vantage6 framework-, which can be securely
distributed to <strong>nodes</strong> for execution on the corresponding
organization’s data.</li>
<li>An <strong>algorithm store</strong> is a centralized platform for
managing pre-registered <strong>algorithms</strong>. This serves as an
alternative to using algorithms from unknown authors or those lacking
transparency regarding their development process and status.</li>
</ul>
<p>The diagram below illustrates a collaboration between two
organizations. In this scenario, users from <code>Organization 1</code>
and <code>Organization 3</code> — with the appropriate credentials — can
request the execution of <strong>tasks</strong> within <em>Collaboration
A</em>. In this case, a user from <code>Organization 1</code> might
request the execution of an <strong>algorithm</strong> (previously
registered in an <strong>algorithm store</strong> trusted by the
collaboration) across all participating organization nodes. In response,
each node from the involved organizations executes the
<strong>algorithm</strong> on its local data. The resulting (aggregated)
data is then sent back to the server, where it can be accessed by the
requesting user. To enhance the security of the communication, messages
between organizations can be encrypted. In this case, an organization
can have a public key that the other collaborating organizations have to
use in order to exchange messages.</p>
<figure><img src="fig/chapter2/collaboration_animated_exp.gif" class="figure mx-auto d-block"></figure><p>The following diagram expand the previous scenario further: what if
<code>Organization 1</code> needs to participate on an additional
<strong>collaboration</strong> with another
<strong>organization</strong> (e.g., <code>Organization 2</code>)? In
this case, <code>Organization 1</code> will have two running nodes, one
for each collaboration. Moreover, as also depicted on the diagram below,
each <strong>collaboration</strong> can make use of one or more
<strong>algorithm stores</strong>:</p>
<figure><img src="fig/chapter2/v6-core-concepts-illustrated.drawio.png" class="figure mx-auto d-block"></figure><p>Finally, the concept of <strong>study</strong> is an important one
when using vantage6 for data analysis. A <strong>study</strong>
represents a subset of organizations within a given collaboration that
are engaged in a specific research question. By setting up studies, you
can more efficiently assign tasks to a specific group of organizations
within a collaboration and better manage the results of these
analyses.</p>
<p>For example, consider the <code>Collaboration W</code> below, which
includes six organizations. This collaboration might involve two
distinct research questions: one that requires data from organizations
1, 2, 3, and 4, and another that focuses on data from organizations 4,
5, and 6. By establishing <code>Study Alpha</code> and
<code>Study Beta</code>, you, as a researcher, can target your data
analysis tasks in three different ways: you can address the entire
<code>Collaboration W</code> (including nodes <code>A</code> to
<code>F</code>), focus on <code>Study Alpha</code> (nodes <code>A</code>
to <code>D</code>), or concentrate on <code>Study Beta</code> (nodes
<code>D</code> to <code>F</code>).</p>
<figure><img src="fig/chapter2/v6-concepts-study.png" class="figure mx-auto d-block"></figure><div id="challenge-1-mapping-vantage6-to-real-life" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1-mapping-vantage6-to-real-life" class="callout-inner">
<h3 class="callout-title">Challenge 1: Mapping vantage6 to “real life”</h3>
<div class="callout-content">
<p>Let’s consider a scenario where you, on behalf of your research
institute, want to conduct a new study on a particular illness across
three major academic hospitals in the Netherlands: VUmc in Amsterdam,
Maastricht UMC+, and UMC Utrecht, as these have valuable data related to
the illness. Consider the following:</p>
<ul>
<li>Your research institute has an existing collaboration (with a
different purpose, not related with yours) with UMC Utrecht and UMC
Groningen. Hence, there is a vantage6 node already running on your
institution for the said collaboration.</li>
<li>You will be conducting this study with a colleague from your
institute named Daphne. Both of you are already registered on the
organization but without access to the existing collaborations.</li>
</ul>
<figure><img src="fig/chapter2/exercise_1_question.png" class="figure mx-auto d-block"></figure><p>How would the concepts described above map to your potential use
case?</p>
<ol style="list-style-type: decimal">
<li>Which organizations will you need to add to your collaboration?</li>
<li>How many new nodes would you need to set up and on which
organizations?</li>
<li>How many users would be created?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>In this case the organizations would be the academic hospitals as
well as your own organization: VUmc, Maastricht UMC+, UMC Utrecht
<em>and</em> your research institute. Note that UMC Utrecht must be
added to the new collaboration despite being already part of an existing
one.</li>
<li>One node for every organization in the collaboration, so 4. Note
that UMC Utrecht needs a new node despite already having one, as the
existing one is for a different collaboration.</li>
<li>There is no need to create new users, as these are already
registered on the organization. Note that the users are linked only to
the organization, not to the nodes.</li>
</ol>
<figure><img src="fig/chapter2/exercise_1_answer.png" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="the-vantage6-infrastructure">The vantage6 infrastructure<a class="anchor" aria-label="anchor" href="#the-vantage6-infrastructure"></a>
</h2>
<hr class="half-width">
<p>Now that we have an overview of how vantage6 manages the project
resources and how it can be used to setup the analysis framework, we can
see how vantage6 works on a technical level and how the infrastructure
maps the aforementioned concepts. In vantage6, a user can pose a
question through a <strong>client</strong> to the vantage6
<strong>server</strong>. Each organization with sensitive data
contributes one <strong>node</strong> to the network. The nodes collect
the computation request from the server and fetches the
<strong>algorithm</strong> from the <strong>algorithm store</strong> to
answer it. When the algorithm completes, the node sends the aggregated
results back to the server.</p>
<figure><img src="fig/chapter2/v6-infrastructure-illustrated.png" alt="High level overview of the vantage6 infrastructure. Client(s) and node(s) communicate through the Server. Nodes are able to communicate directly with each other when the optional VPN feature is enabled." class="figure mx-auto d-block"><div class="figcaption">High level overview of the vantage6
infrastructure. Client(s) and node(s) communicate through the Server.
Nodes are able to communicate directly with each other when the optional
VPN feature is enabled.</div>
</figure><p>On a technical level, vantage6 may be seen as a container
orchestration tool for privacy preserving analyses. It deploys a network
of containerized applications that together ensure insights can be
exchanged without sharing record-level data.</p>
<p>Let’s explain in some more detail what these network actors are
responsible for, and which subcomponents they contain.</p>
<div class="section level3">
<h3 id="server">Server<a class="anchor" aria-label="anchor" href="#server"></a>
</h3>
<p>The vantage6 <strong>server</strong> acts as communication hub
between clients and nodes. The <a href="https://docs.vantage6.ai/en/main/server/index.html" class="external-link">server</a>
tracks the status of the computation requests and handles administrative
functions such as authentication and authorization. It consists of
multiple applications:</p>
<ul>
<li><p><strong>Vantage6 server</strong>: Contains the users,
organizations, collaborations, tasks and their results. It handles
authentication and authorization to the system and acts as the
communication hub for clients and nodes.</p></li>
<li><p><strong>Docker registry</strong>: Contains algorithms stored in
container images which can be used by clients to request a computation.
The node will retrieve the algorithm from this registry and execute it.
It is possible to use public registries for this purpose like <a href="https://hub.docker.com/" class="external-link">Docker hub</a> or <a href="https://ghcr.io" class="external-link">Github Containers</a>. However it is also
possible to host your own registry, for example a <a href="https://goharbor.io/" class="external-link">Harbor</a> instance.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="data-station">Data Station<a class="anchor" aria-label="anchor" href="#data-station"></a>
</h3>
<p>The data station hosts the local data and the <a href="https://docs.vantage6.ai/en/main/node/index.html" class="external-link">node</a>
(vantage6-node). The <strong>Vantage6 node</strong> is responsible for
executing the algorithms on the local data. It protects the data by
allowing only specified algorithms to be executed after verifying their
origin. The node is responsible for picking up the task and running them
in parallel, executing the algorithm and sending the results back to the
server. For more details see the <a href="https://docs.vantage6.ai/en/main/node/index.html" class="external-link">technical
documentation of the node</a>.</p>
</div>
<div class="section level3">
<h3 id="client">Client<a class="anchor" aria-label="anchor" href="#client"></a>
</h3>
<p>A user or application who interacts with the vantage6-server. They
create tasks, retrieve their results, or manage entities at the server
(i.e. creating or editing users, organizations and collaborations).</p>
<p>The vantage6 server is an API, which means that there are many ways
to interact with it programmatically. There are however a number of
applications available that make is easier for users to interact with
the vantage6 server:</p>
<ul>
<li><p><strong>User interface</strong>: The <a href="https://docs.vantage6.ai/en/main/user/ui.html" class="external-link">user interface</a>
is a web application (hosted at the server) that allows users to
interact with the server. It is used to create and manage organizations,
collaborations, users, tasks and algorithms. It also allows users to
view and download the results of tasks. Use of the user interface
recommended for ease of use.</p></li>
<li><p><strong>Python client</strong>: The <a href="https://docs.vantage6.ai/en/main/user/pyclient.html" class="external-link">vantage6
python client</a> <python-client> is a Python package that allows users
to interact with the server from a Python environment. This is
especially usefull for data scientists who want to integrate vantage6
into their workflow.</python-client></p></li>
</ul>
</div>
<div class="section level3">
<h3 id="algorithm-store">Algorithm store<a class="anchor" aria-label="anchor" href="#algorithm-store"></a>
</h3>
<p>While a vantage6-supported research infrastructure offers a strong
defense against many data privacy risks, there remains one crucial
security aspect that falls outside the platform’s scope: the validation
of the code that will run on this infrastructure. For instance, the
administrators of the nodes running within each organization are
responsible for defining which algorithms (i.e., <a href="https://docs.vantage6.ai/en/main/node/configure.html#all-configuration-options" class="external-link">which
container images</a>) will be allowed for execution on the respective
collaborations. As this is a critical and complex task that entails
activities like code analysis and verification, working with algorithms
from trusted sources is the primary line of defense against potential
threats.</p>
<p>Vantage6’s algorithm store is a repository for trusted algorithms
within a certain project that aims to enhance trustworthiness by
offering a centralized platform for managing pre-registered algorithms.
This serves as an alternative to using algorithms from unknown authors
or those lacking transparency regarding their development process and
status. The algorithm store currently allows researchers to explore
which algorithms are available and how to run them. This, streamlines
task execution requests within collaborations. Also, the algorithm store
integrates additional information to the algorithm metadata such who
developed and reviewed the algorithm. Only after complying with the
review policies of a store, a new algorithm will be published in the
store.</p>
</div>
<div class="section level3">
<h3 id="the-workflow-of-a-task-running-in-vantage6">The workflow of a task running in vantage6<a class="anchor" aria-label="anchor" href="#the-workflow-of-a-task-running-in-vantage6"></a>
</h3>
<p>The diagram below illustrates what happens when a request is sent by
a user to vantage6. In this scenario, a user — with the appropriate
credentials — can request the execution of <strong>tasks</strong> within
using the UI. In this case, the user might request the execution of an
<strong>algorithm</strong> (previously registered in an
<strong>algorithm store</strong> trusted by the collaboration) across
all participating organization nodes. In response, each node from the
involved organizations executes the <strong>algorithm</strong> on its
local data. The resulting (aggregated) data is then sent back to the
server, where it can be accessed by the requesting user. To enhance the
security of the communication, messages between organizations can be
encrypted. In this case, an organization can have a public key that the
other collaborating organizations have to use in order to exchange
messages.</p>
<figure><img src="fig/chapter2/infrastructure_animated.gif" class="figure mx-auto d-block"></figure>
</div>
</section><section><h2 class="section-heading" id="how-algorithms-run-in-vantage6">How algorithms run in vantage6<a class="anchor" aria-label="anchor" href="#how-algorithms-run-in-vantage6"></a>
</h2>
<hr class="half-width">
<p>So how does vantage6 relate to the privacy enhancing techniques that
we discussed in chapter 1? Let us consider the federated sum from
chapter 1 again</p>
<figure><img src="fig/chapter2/federated_analysis_applied.jpg" alt="Federated analysis orchestrated by vantage6" class="figure mx-auto d-block"><div class="figcaption">Federated analysis orchestrated by
vantage6</div>
</figure><p>As you can see, both the datasources and the aggregation entity are
mapped to nodes. The vantage6 server is on the side, coordinating the
analysis.</p>
<p>Federated algorithms can be split in a <strong>federated</strong> and
a <strong>central</strong> part:</p>
<ul>
<li><p><strong>Central</strong>: The central part of the algorithm is
responsible for orchestration and aggregation of the partial results. In
our example this would be the aggregation.</p></li>
<li><p><strong>Federated</strong>: The partial tasks are executing
computations on the local privacy sensitive data. These would be the
nodes on the left.</p></li>
</ul>
<figure><img src="fig/chapter2/algorithm_central_and_subtasks.png" alt="vantage6 central and federated tasks." class="figure mx-auto d-block"><div class="figcaption">vantage6 central and federated tasks.</div>
</figure><p>Now, let’s see what typically happens if a task is created in
vantage6:</p>
<ul>
<li>The user creates a task for the central part of the algorithm. This
is registered at the server.</li>
<li>The task registration leads to the creation of a central algorithm
container on one of the nodes.</li>
<li>The central algorithm creates subtasks for the federated parts of
the algorithm, which again are registered at the server.</li>
<li>All nodes for which the subtask is intended start their work by
executing the federated part of the algorithm.</li>
<li>When finished, the nodes send the results back to the server</li>
<li>Each node’s results are picked up by the central algorithm. The
central algorithm then computes the final result and sends it to the
server</li>
<li>The user retrieves the result from the server.</li>
</ul>
<div id="vantage6-server-vs-central-part-of-an-algorithm" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="vantage6-server-vs-central-part-of-an-algorithm" class="callout-inner">
<h3 class="callout-title">vantage6-server vs central part of an algorithm</h3>
<div class="callout-content">
<p>It is easy to confuse the vantage6 server with the central part of
the algorithm: the server is the central part of the infrastructure but
not the place where the central part of the algorithm is executed. The
central part is actually executed at one of the nodes, because it gives
more flexibility: for instance, an algorithm may need heavy compute
resources to do the aggregation, and it is better to do this at a node
that has these resources rather than having to upgrade the server
whenever a new algorithm needs more resources.</p>
</div>
</div>
</div>
<div id="challenge-2-who-computes-what" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-who-computes-what" class="callout-inner">
<h3 class="callout-title">Challenge 2: Who computes what?</h3>
<div class="callout-content">
<p>Two centers <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> have the following data regarding the
age of a set of patients:</p>
<p><span class="math inline">\(a = [34, 42, 28, 49]\)</span></p>
<p><span class="math inline">\(b = [51, 23, 44]\)</span></p>
<p>Each center has a data station and we want to compute the overall
average age of the patients.</p>
<figure><img src="fig/chapter2/schema_exercise.png" alt="Architecture." class="figure mx-auto d-block"><div class="figcaption">Architecture.</div>
</figure><p>Given that the central average can be computed by summing up all the
values and dividing the sum by the number of values, using the following
equation:</p>
<p><span class="math inline">\(\overline{x} =\dfrac{1}n \sum_{i=1}^{n}
x_i = \dfrac{34+42+28+49+51+23+44}7\)</span></p>
<p>To make it ready for a federate computation, the equation can be
rewritten as the sum of the elements of A plus the sum of the elements
of B, divided by the number of elements of A plus the number of elements
of B:</p>
<p><span class="math inline">\(\overline{x} =\dfrac{1}{n_a+n_b}
(\sum_{i=1}^{n_a} a_i+\sum_{i=1}^{n_b} b_i) =
\dfrac{1}{4+3}[(34+42+28+49)+(51+23+44)]\)</span></p>
<p>Can you determine which part of the infrastructure will execute each
part of the computation, and which is the result returned by the
different parts?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>The Server starts the central task on one of the two nodes (e.g. Data
station A).</p>
<p>The node A starts two subtasks, one per node. Node A will run the
following computation:</p>
<p><span class="math inline">\(S_a =\sum_{i=1}^{n_a} a_i =
(34+42+28+49)\)</span></p>
<p>and it will return the following results to the central task:</p>
<p><span class="math inline">\(S_a=153\)</span></p>
<p><span class="math inline">\(n_a=4\)</span></p>
<p>Node B will run the following computation:</p>
<p><span class="math inline">\(S_b =\sum_{i=1}^{n_b} a_i =
(51+23+44)\)</span></p>
<p>and it will return the following results to the central task:</p>
<p><span class="math inline">\(S_b=118\)</span></p>
<p><span class="math inline">\(n_b=3\)</span></p>
<p>The central task receives <span class="math inline">\(S_a\)</span>
and <span class="math inline">\(n_a\)</span> from node A and <span class="math inline">\(S_b\)</span> and <span class="math inline">\(n_b\)</span> from node B, and will run the
following computation:</p>
<p><span class="math inline">\(\overline{x}
=\dfrac{S_a+S_b}{n_a+n_b}=\dfrac{153+118}{4+3}=38.71\)</span></p>
<figure><img src="fig/chapter2/algorithm_workflow.png" alt="vantage6 algorithm workflow." class="figure mx-auto d-block"><div class="figcaption">vantage6 algorithm workflow.</div>
</figure>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="future-developments-of-vantage6">Future developments of vantage6<a class="anchor" aria-label="anchor" href="#future-developments-of-vantage6"></a>
</h2>
<hr class="half-width">
<p>Back in 2018 when the development of vantage6 started, the focus was
on federated learning. Since then, vantage6 has been extended to support
different types of data sources, different types of algorithms and
improved its user experience. Privacy Enhancing Technologies (PET) are a
rapidly evolving field. To keep up with the latest developments, the
vantage6 platform is designed to be flexible and to adapt to new
developments in the field.</p>
<p>From the development team we are working towards making vantage6 the
PETOps platform for all your (distributed) analysis needs.</p>
<p>We identified a number of areas where we want to improve and extend
vantage6 in order to achieve this goal:</p>
</section><section><h2 class="section-heading" id="policies">Policies<a class="anchor" aria-label="anchor" href="#policies"></a>
</h2>
<hr class="half-width">
<p>Currently, vantage6 lets you set several policies, such as the
organizations that are allowed to participate in a collaboration, the
algorithms that are allowed to run on the nodes, and the data that is
allowed to be used in a collaboration. We want to extend this to a more
generic policy framework in which any aspect of the vantage6 platform
can be controlled by policies. This will maximize the flexibility of the
platform and make it easier to adapt to new use cases.</p>
<p>For example, it would be possible:</p>
<ul>
<li>Define the version of vantage6 that is allowed to be used in a
collaboration</li>
<li>Which users is allowed to run a certain algorithm</li>
<li>Which algorithms are allowed in a collaboration/study</li>
<li>Define privacy guards at algorithm level</li>
</ul></section><section><h2 class="section-heading" id="model-repository">Model Repository<a class="anchor" aria-label="anchor" href="#model-repository"></a>
</h2>
<hr class="half-width">
<p>Currently, vantage6 is focused on privacy enhancing techniques. Some
of these techniques result in a model that can be used to make
predictions. We want to extend vantage6 with a model repository in which
these models can be stored, shared and used. This will make it easier to
reuse models and to compare the performance of different models.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>vantage6 is an open source platform to execute PET analysis.</li>
<li>A client is used to interact with the system.</li>
<li>A vantage6 server orchestrates the execution of algorithms.</li>
<li>The nodes contain the data and execute the computation.</li>
<li>The algorithms in vantage6 have a federated part, running on local
data, and a central part, aggregating the results.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-chap3_run_analysis_ui"><p>Content from <a href="chap3_run_analysis_ui.html">Running a PET analysis without programming on vantage6</a></p>
<hr>
<p>Last updated on 2024-10-15 |

        <a href="https://github.com/vantage6/vantage6-workshop/edit/main/episodes/chap3_run_analysis_ui.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I perform basic administrative activities on vantage6 using
the web-based UI?</li>
<li>How do I check the status of a specific collaboration or study in
the vantage6 UI?</li>
<li>How do I request a task through the vantage6 UI?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explore specific data analysis scenarios that further illustrate the
concepts introduced in episode 2.</li>
<li>Understand the UI-based workflow for performing a data analysis on
the given scenarios.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="prerequisite" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="prerequisite" class="callout-inner">
<h3 class="callout-title">Prerequisite</h3>
<div class="callout-content">
<p>Make sure you completed the <a href="./chap2_introduction_v6.html">Episode 2</a> where the concepts the
UI is based on are introduced.</p>
</div>
</div>
</div>
<section><h2 class="section-heading" id="from-theory-to-practice-a-hypothetical-case-study-using-vantage6-collaborations">From theory to practice: a hypothetical case study using vantage6
collaborations<a class="anchor" aria-label="anchor" href="#from-theory-to-practice-a-hypothetical-case-study-using-vantage6-collaborations"></a>
</h2>
<hr class="half-width">
<p>In vantage6 a collaboration refers to an agreement between two or
more parties to participate in a study or to answer a research question
together. This concept is central to the Privacy Enhancing Technologies
(PETs) that vantage6 supports. Each party involved in a collaboration
remains autonomous, meaning they retain control over their data and can
decide how much of their data to contribute to the collaboration’s
global model and which algorithms are allowed for execution.</p>
<p>To illustrate this in practice, you will work on a simulated
collaboration scenario: an international consortium project of multiple
health research institutes, working together on two studies:</p>
<ul>
<li><p><em>Age-Related Variations in Overweight Prevalence: A
Comparative Study Across Gender and Age Groups</em>
<strong>(AGOT2024)</strong> .</p></li>
<li><p><em>The Effect of Gender on Height Development Across Various Age
Groups</em> <strong>(GGA2024)</strong>.</p></li>
</ul>
<p>The first study, <strong>AGOT2024</strong>, involves the analysis of
age and weight-related data available on a subset of the institutions
participating in the collaboration. Likewise, <strong>GGA2024</strong>
involves the analysis of age and height-related data from a different
(and potentially overlapping) subset of the collaboration’s
participants. In this Episode you will play the role of a researcher of
one of the institutions that conform the consortium. As seen on the
previous <a href="./chap2_introduction_v6.html">Episode</a>, this means
that you will be able to perform data analysis on the whole
collaboration, or on any of the two studies defined for it. The
following illustrates the kind of collaboration you will be part of
(yours may have a different number of nodes, with different names and
study configurations).</p>
<figure><img src="fig/chapter3/case-study-example.drawio.png" alt="Hypothetical collaborations scenario" class="figure mx-auto d-block"><div class="figcaption">Hypothetical collaborations scenario</div>
</figure><p>The consortium members already took care to ensure that their
corresponding datasets follow the same structure (variable names and
data types). This is key for making the federated analysis possible. The
following is an example of how the ‘default’ database on all the nodes
within the collaboration look like.</p>
<table class="table">
<thead><tr class="header">
<th>gender</th>
<th>age</th>
<th>height</th>
<th>weight</th>
<th>isOverweight</th>
<th>ageGroup</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>M</td>
<td>39</td>
<td>152</td>
<td>108</td>
<td>False</td>
<td>30 - 40</td>
</tr>
<tr class="even">
<td>M</td>
<td>8</td>
<td>118</td>
<td>106</td>
<td>False</td>
<td>0 - 10</td>
</tr>
<tr class="odd">
<td>M</td>
<td>16</td>
<td>161</td>
<td>110</td>
<td>True</td>
<td>10 - 20</td>
</tr>
<tr class="even">
<td>M</td>
<td>94</td>
<td>110</td>
<td>115</td>
<td>True</td>
<td>90 - 100</td>
</tr>
<tr class="odd">
<td>M</td>
<td>47</td>
<td>117</td>
<td>152</td>
<td>True</td>
<td>40 - 50</td>
</tr>
<tr class="even">
<td>F</td>
<td>29</td>
<td>127</td>
<td>110</td>
<td>True</td>
<td>20 - 30</td>
</tr>
<tr class="odd">
<td>M</td>
<td>5</td>
<td>95</td>
<td>65</td>
<td>False</td>
<td>0 - 10</td>
</tr>
<tr class="even">
<td>M</td>
<td>39</td>
<td>142</td>
<td>196</td>
<td>False</td>
<td>30 - 40</td>
</tr>
<tr class="odd">
<td>F</td>
<td>20</td>
<td>189</td>
<td>112</td>
<td>False</td>
<td>20 - 30</td>
</tr>
<tr class="even">
<td>F</td>
<td>84</td>
<td>145</td>
<td>116</td>
<td>False</td>
<td>80 - 90</td>
</tr>
</tbody>
</table></section><section><h2 class="section-heading" id="interacting-with-the-v6-server">Interacting with the v6 server<a class="anchor" aria-label="anchor" href="#interacting-with-the-v6-server"></a>
</h2>
<hr class="half-width">
<p>To perform a data analysis, or any other kind of management activity
within the collaboration you are part of, you need to interact with the
vantage6 server. As described in <a href="./chap2_introduction_v6.html">Episode 2</a>, the vantage6 server
is the central component responsible for managing the entire
federated/multi-party computation infrastructure and facilitating
communication between the various entities within the vantage6 platform.
There are two ways of interacting with the server: either by using a
web-based user interface, or by programmatically requesting actions to
the server API -the same API that powers the web interface behind the
scenes. In this Episode you will perform data analyses on the simulated
collaboration scenario using the web-based interface, the most
user-friendly one (in <a href="./chap4_manage_via_ui.html">Episode 4</a>
you will learn how to configure your own collaborations, and on <a href="./chap5_python_client.html">Episode 5</a>, you will explore how to
interact with the server programmatically for more advanced use
cases).</p>
<figure><img src="fig/chapter3/v6-API.png" alt="Vantage6 API clients" class="figure mx-auto d-block"><div class="figcaption">Vantage6 API clients</div>
</figure><div class="section level3">
<h3 id="navigating-through-vantage6s-ui">Navigating through vantage6’s UI<a class="anchor" aria-label="anchor" href="#navigating-through-vantage6s-ui"></a>
</h3>
<p>The elements and navigability of vantage6’s UI are based on the
concepts introduced in <a href="./chap2_introduction_v6.html">Chapter
2</a>. For instance, as seen on the screenshots below, upon selecting a
collaboration on the start page, if you select ‘Tasks’ you will see the
status of the tasks created for that particular collaboration.</p>
<figure><img src="fig/chapter3/ui_start_page.png" alt="vantage6 UI start page" class="figure mx-auto d-block"><div class="figcaption">vantage6 UI start page</div>
</figure><figure><img src="fig/chapter3/ui_task_page.png" alt="vantage6 UI tasks page" class="figure mx-auto d-block"><div class="figcaption">vantage6 UI tasks page</div>
</figure><p>Likewise, expanding the <code>Administration</code> icon in the left
panel will let you choose vantage6 entities youn can manage:
<code>Organizations</code>, <code>Collaborations</code>,
<code>Roles</code>, <code>Users</code>, and <code>Nodes</code>. You can
click on an entity to see more details or to edit the entity.</p>
<figure><img src="fig/chapter3/ui_admin_page.png" alt="vantage6 UI administration page" class="figure mx-auto d-block"><div class="figcaption">vantage6 UI administration page</div>
</figure><div id="getting-familiar-with-the-vantage6-ui" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="getting-familiar-with-the-vantage6-ui" class="callout-inner">
<h3 class="callout-title">Getting familiar with the vantage6 UI</h3>
<div class="callout-content">
<p>To get familiar with vantage6’s UI, you will start with a simple
task: edit the details of your own user (the connection details for this
activity will be given by the instructors). Log into the UI using the
information provided and navigate to the administration page and try to
update your email, first name, and last name.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<figure><img src="fig/chapter3/user-edit.png" alt="User-entity - edit option" class="figure mx-auto d-block"><div class="figcaption">User-entity - edit option</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="running-a-pet-privacy-enhancing-technology-through-the-user-interface-no-coding-involved">Running a PET (privacy-enhancing technology) through the user
interface (no coding involved!)<a class="anchor" aria-label="anchor" href="#running-a-pet-privacy-enhancing-technology-through-the-user-interface-no-coding-involved"></a>
</h2>
<hr class="half-width">
<p>Now that you are familiar with the UI basics, the next two details
you need to figure out as a researcher, in order to perform you analysis
are (1) which kind of analysis I need perform, and (2) on which data
nodes it will be peformed? There is another important consideration,
though: is my collaboration or my studies ready for my analysis? Keep in
mind that each node within your collaboration is autonomously managed by
the organization it was configured. This means that you although you can
include them in your analysis, you can’t control them (they may just be
offline for no reason).</p>
<div id="challenge-2-checking-the-status-of-the-nodes-through-the-ui" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2-checking-the-status-of-the-nodes-through-the-ui" class="callout-inner">
<h3 class="callout-title">Challenge 2: checking the status of the nodes
through the UI</h3>
<div class="callout-content">
<p>With your researcher credentials, explore the collaboration you have
access to. Check which organizations are part of it and if they are
online. Also check which organizations were assigned to each study
(AGOT2024, GGA2924). Based on this:</p>
<ol style="list-style-type: decimal">
<li>Which study is ready for executing an analysis?</li>
<li>If you need to perform an analysis for the study that is
<strong>not</strong> ready, which organization you would need to contact
to fix this situation?</li>
</ol>
</div>
</div>
</div>
<div class="section level3">
<h3 id="running-a-federated-algorithm">Running a federated algorithm<a class="anchor" aria-label="anchor" href="#running-a-federated-algorithm"></a>
</h3>
<p>Now you will perform an analysis on the <em>study</em> that is ready
for it (i.e., the <em>study</em> with <strong>no</strong> offline
nodes). As this is an introductory exercise, you will first use the
simple algorithm introduced in <a href="./chap2_introduction_v6.html">Chapter 2</a>: the <em>Federated
Average</em>.</p>
<div id="challenge-3-as-a-researcher-requesting-an-algorithm-execution-partial-function" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-3-as-a-researcher-requesting-an-algorithm-execution-partial-function" class="callout-inner">
<h3 class="callout-title">Challenge 3: as a researcher, requesting an
algorithm execution! (partial function)</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Login with your researcher credentials.</p></li>
<li><p>Select <code>Analyze</code> on the Administration option from the
panel on the left, and then select your collaboration.</p></li>
<li>
<p>Select <code>+ Create task</code> to create a new task on your
collaboration.</p>
<figure><img src="fig/chapter3/create-task.png" class="figure mx-auto d-block"></figure>
</li>
<li>
<p>As the first step, you can choose between running the task on the
entire collaboration, or on one particular study (i.e., on a subset of
the collaboration’s institutions). Choose the study that is
<em>ready</em> for an analysis.</p>
<figure><img src="fig/chapter3/select-study.png" class="figure mx-auto d-block"></figure>
</li>
<li>
<p>The ‘Average’ algorithm should be listed under the ‘<em>Select
which algorithm you want to run</em>’ dropdown menu. Select it, and
provide a name and a description.</p>
<figure><img src="fig/chapter3/alg-selection.png" class="figure mx-auto d-block"></figure>
</li>
<li>
<p>Now the UI will let you choose between the two functions you
explored in Challenge #2. For now try to run the
<code>partial_average</code>, selecting ALL the organizations.</p>
<figure><img src="fig/chapter3/selecting-alg-and-nodes.png" class="figure mx-auto d-block"></figure>
</li>
<li><p>Select the ‘default’ database, choose any numerical column
relevant for the study you selected, and then click on
‘Submit’.</p></li>
<li><p>The task you just requested should be listed with a ‘pending’
status. Once finished, download the JSON results and open them on a text
editor.</p></li>
</ol>
<p>Based on these results, discuss the following:</p>
<ol style="list-style-type: decimal">
<li>What does the content of these files mean? Why the
<code>central_average</code> function is returning this?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Each node, after executing the <code>partial_average</code> function,
returns the two values needed by the central function of the ‘federated
average’ algorithm (as described in Chapter 2): the number of records
within the database, and their sum. These values are ‘encoded’ as a JSON
document, so they can be read, programatically, by the
<code>central_average</code>.</p>
<figure><img src="fig/chapter3/task_partial_output.png" alt="Results" class="figure mx-auto d-block"><div class="figcaption">Results</div>
</figure>
</div>
</div>
</div>
</div>
<div id="challenge-4-lets-see-what-the-central-function-does" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-4-lets-see-what-the-central-function-does" class="callout-inner">
<h3 class="callout-title">Challenge 4: let’s see what the central
function does!</h3>
<div class="callout-content">
<p>Repeat the same process from Challenge 3 (again, on the Study that is
ready for it), but this time choose the ‘central’ function. As you see,
when choosing this function only one organization can be selected.</p>
<figure><img src="fig/chapter3/central_avg_screenshot.png" class="figure mx-auto d-block"></figure><p>Once again, wait for the process to finish and check the JSON
results. Keep an eye on the Tasks section, and see how the processes are
created.</p>
<p>Discuss the following:</p>
<ol style="list-style-type: decimal">
<li><p>There is a node that appeared twice in the processes list during
the algorithm execution: in the Main process and on the Child processes
list. Take a look at the source code of the <a href="https://github.com/IKNL/v6-average-py/blob/master/v6-average-py/__init__.py" class="external-link">algorithm
you have just executed</a>. Can you spot in the code why this
happened?</p></li>
<li><p>Can you identify, within the same source code, where the data you
saw on Challenge 3 was created?</p></li>
<li><p>Given the source code above, why does the
<code>central_average</code> function, unlike
<code>partial_average</code>, <strong>not</strong> get any data as an
input?</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<figure><img src="active_tasks.png" class="figure mx-auto d-block"></figure><ol style="list-style-type: decimal">
<li><p>In this exercise you created a task for a ‘central’ function,
which, when executed requests other nodes to run a ‘partial’ one,
combining their results upon completion. The central function is
designed in a way that it make the request to all the nodes within the
collaboration/study. As the node that gets the request to execute the
‘central’ function, is also part of the collaboration, it ends executing
two tasks: the central task, and the partial one.</p></li>
<li><p><a href="https://github.com/IKNL/v6-average-py/blob/5cad1742749de0f5c05a788c8ce3ca5b0a3965b2/v6-average-py/__init__.py#L87" class="external-link">Here,</a>
the ‘partial’ part of the algorithm encodes its result as the JSON
document seen on the previous challenge.</p></li>
<li><p>The <code>central_average</code> function is designed just to
aggregate the results of the partial averages sent by the other nodes.
Hence, it doesn’t need direct access any dataset.</p></li>
</ol>
</div>
</div>
</div>
</div>
<div id="challenge-5-handling-problems-through-the-ui" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-5-handling-problems-through-the-ui" class="callout-inner">
<h3 class="callout-title">Challenge 5: handling problems through the
UI!</h3>
<div class="callout-content">
<p>Based on your current understanding of the <em>federated average</em>
algorithm, speculate on what would happen if you run the ‘central’
function of this algorithm on a study that includes ‘offline’ nodes.
Once you have made your prediction, validate it by repeating the process
from the previous challenge, this time using the <em>study</em> with the
‘offline’ node.</p>
<p>Discuss the following:</p>
<ol style="list-style-type: decimal">
<li>What happened with the Task? What can you do about it with the
UI?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>The algorithm didn’t crash, but is kept on hold (with the Active
status) indefinitely. The Central task requests all the nodes in the
study to run the ‘partial’ function. As the server is unable to transfer
this request to the offline node, this child process is kept on hold,
until the node is back online.</p>
<p>Consequently, the Main process is also kept on hold, and the process
stays with an ‘Active’ status indefinitely (or until the node is back
online).</p>
<figure><img src="fig/chapter3/task_offline_node.png" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="challenge-6-handling-problems-through-the-ui-again." class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-6-handling-problems-through-the-ui-again." class="callout-inner">
<h3 class="callout-title">Challenge 6: handling problems through the UI,
again.</h3>
<div class="callout-content">
<p>This time, let’s try to do something that may make the <em>federated
average</em> algorithm not work as expected. Create a task, this time
selecting the ‘operational’ study (the one with all of its nodes
online), and use the central function in it. This time, choose a
non-numerical variable (see the table sample).</p>
<p>Look at the logs and discuss the following:</p>
<ol style="list-style-type: decimal">
<li>Why did both <code>partial_function</code> and
<code>central_function</code> crash? (<a href="https://github.com/IKNL/v6-average-py/blob/5cad1742749de0f5c05a788c8ce3ca5b0a3965b2/v6-average-py/__init__.py" class="external-link">See
source code</a>)</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>The <code>partial_function</code> crashed while trying to parse the
input as a number. The <code>central_function</code> crashed due to a
division-by-zero.</li>
</ol>
<figure><img src="fig/chapter3/task_error_logs.png" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="challenge-7-play-around-with-other-algorithms" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-7-play-around-with-other-algorithms" class="callout-inner">
<h3 class="callout-title">Challenge 7: Play around with other
algorithms!</h3>
<div class="callout-content">
<p>See if you can run a Kaplan-Meier analysis or Crosstab analysis on
the same study.</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>Go to analyze, and create a new task as before</li>
<li>Select a different algorithm from the dropdown menu <img src="fig/chapter3/select-different-algorithm.png" alt="Select a different algorithm" class="figure">
</li>
<li>Follow the same steps as before to create a task</li>
</ol>
<p>You will encouter different input parameters and output for each
algorithm.</p>
</div>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-chap4_manage_via_ui"><p>Content from <a href="chap4_manage_via_ui.html">Managing vantage6 server via the user interface</a></p>
<hr>
<p>Last updated on 2024-09-24 |

        <a href="https://github.com/vantage6/vantage6-workshop/edit/main/episodes/chap4_manage_via_ui.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is the permission system in vantage6?</li>
<li>What are the default roles in vantage6?</li>
<li>How to create a new organization using vantage6 user interface
(UI)?</li>
<li>How to create a new user using vantage6 UI?</li>
<li>How to create a new collaboration using vantage6 UI?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the permission system of vantage6</li>
<li>Understand the default roles in vantage6</li>
<li>Be able to create a new organization using the vantage6 UI</li>
<li>Be able to create a new user using the vantage6 UI</li>
<li>Be able to create a new collaboration using the vantage6 UI</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="vantage6-permission-system">Vantage6 permission system<a class="anchor" aria-label="anchor" href="#vantage6-permission-system"></a>
</h2>
<hr class="half-width">
<p>Vantage6 uses a permission system to control who can do what in the
system. The permission system is based on <strong>roles</strong>, which
are collections of rules that define the permissions of a user. A user
can have multiple roles, and the permissions of the user are defined by
the assigned <strong>rules</strong>.</p>
<p>The permission rules define what each entity is allowed to do, based
on the operation (view, create, edit, delete, send, receive), the scope
(own, organization, collaboration, global), and the resource
(e.g. users, organizations). Users can be assigned anywhere between zero
and all of these permission rules. For example, having the rules with
<code>create</code> in the scope <code>organization</code> for the
resource <code>user</code> means that the user can create users for the
organization they belong to.</p>
<figure><img src="fig/chapter4/permission_system.png" alt="vantage6 permission system" class="figure mx-auto d-block"><div class="figcaption">vantage6 permission system</div>
</figure><p>There are six operations: view, edit, create, delete, send and
receive. The first four correspond to GET, PATCH, CREATE and DELETE
requests, respectively. The last two allow users to send and receive
data via socket events. For example, sending events would allow them to
kill tasks that are running on a node. For more details about Send and
Receive operations, see the <a href="https://docs.vantage6.ai/en/main/features/inter-component/socket.html" class="external-link">vantage6
documentation</a>.</p>
<p>The scopes are:</p>
<ul>
<li>Global: all resources of all organizations</li>
<li>Organization: resources of the user’s own organization</li>
<li>Collaboration: resources of all organizations that the user’s
organization is in a collaboration with</li>
<li>Own: these are specific to the user endpoint. Permits a user to
see/edit their own user, but not others within the organization.</li>
</ul>
<p>Note that not every resource has all scopes and/or operations. For
example, the <code>collaboration</code> resource does not have
<code>create</code> operation for the <code>organization</code> scope,
as it does not make sense to create a collaboration that only your own
organization can participate in.</p>
<p>To make it easier to assign permissions, there are also predefined
roles:</p>
<ul>
<li>Root: has all permissions (👉 see image below)</li>
<li>Collaboration Admin: can do almost everything for all organizations
in collaborations they are a member of</li>
<li>Organization Admin: can do everything for their own
organization</li>
<li>Researcher: can view the organization’s resources and create tasks
(👉 see image below)</li>
<li>Viewer: can only view the organization’s resources</li>
</ul>
<p>The permissions are set up in the <code>Roles</code> tab in the
administration page. You can click on a role to see the permissions of
that role. You can also create a new role by clicking the
<code>Create role</code> button.</p>
<p>The permission structure allows for a lot of flexibility, but it can
be complex for beginners to set up. The default roles provide a quick
way to set up permissions, but it is recommended to review them before
using them in a project.</p>
<figure><img src="fig/chapter4/permissions_root.png" alt="vantage6 permissions for the role Root" class="figure mx-auto d-block"><div class="figcaption">vantage6 permissions for the role Root</div>
</figure><figure><img src="fig/chapter4/permissions_researcher.png" alt="vantage6 permissions for the role Researcher" class="figure mx-auto d-block"><div class="figcaption">vantage6 permissions for the role
Researcher</div>
</figure><div id="challenge-1-what-can-you-do-in-vantage6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-what-can-you-do-in-vantage6" class="callout-inner">
<h3 class="callout-title">Challenge 1: What can you do in vantage6?</h3>
<div class="callout-content">
<p>Go the administration page in the vantage6 UI, check the permissions
that you have, and answer the following questions:</p>
<ol style="list-style-type: decimal">
<li>What is your role in vantage6?</li>
<li>Do you have the permissions to create a new organization, a new user
or a new collaboration?</li>
<li>Do you have the permission to remove an existing organization, a
user, or a collaboration?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Output </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>Check it with your instructor.</li>
<li>Yes, you should be able to create a new organization, a new user,
and a new collaboration. If not, ask your instructor to give you the
necessary permissions.</li>
<li>Check it with your instructor.</li>
</ol>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="manage-vantage6-project-using-the-ui">Manage vantage6 project using the UI<a class="anchor" aria-label="anchor" href="#manage-vantage6-project-using-the-ui"></a>
</h2>
<hr class="half-width">
<p>In this section, we will go through the steps to create a new
organization, a new user and a new collaboration using the vantage6
UI.</p>
<p>First you need to log in to the vantage6 UI, and then go to the
<code>Administration</code> page. You can find the
<code>Administration</code> tab in the left side of the start page.
Clicking on the <code>Administration</code> tab will show you all tabs
for vantage6 entities.</p>
<figure><img src="fig/chapter4/ui_admin_page.png" alt="vantage6 UI administration page" class="figure mx-auto d-block"><div class="figcaption">vantage6 UI administration page</div>
</figure><div class="section level3">
<h3 id="create-a-new-organization">Create a new organization<a class="anchor" aria-label="anchor" href="#create-a-new-organization"></a>
</h3>
<p>It’s quite straightforward to create a new organization in vantage6.
Here are the steps:</p>
<ol style="list-style-type: decimal">
<li>Click on the <code>Organizations</code> tab in the administration
page.</li>
<li>Click on the <code>Create organization</code> button.</li>
<li>Fill in the details of the new organization.
<ul>
<li>The <code>Upload public key</code> field is optional. You can upload
a public key for the organization if you want to use encryption in the
collaboration. But note that we DO NOT use encryption in this course.
For more details about encryption, see the <a href="https://docs.vantage6.ai/en/main/features/inter-component/encryption.html" class="external-link">vantage6
documentation</a>.</li>
</ul>
</li>
<li>Click on the <code>Submit</code> button to create the new
organization.</li>
</ol>
<figure><img src="fig/chapter4/create_org.png" alt="Create a new organization" class="figure mx-auto d-block"><div class="figcaption">Create a new organization</div>
</figure>
</div>
<div class="section level3">
<h3 id="create-a-new-user">Create a new user<a class="anchor" aria-label="anchor" href="#create-a-new-user"></a>
</h3>
<p>Now let’s create a new user for the organization we just created.
Here are the steps:</p>
<ol style="list-style-type: decimal">
<li>Click on the <code>Users</code> tab in the administration page.</li>
<li>Click on the <code>Create user</code> button.</li>
<li>Fill in the details of the new user.
<ul>
<li>You can assign the user to an organization by selecting it from the
<code>Organization</code> dropdown. Only one organization can be
selected.</li>
<li>You can assign roles to the user by selecting them from the
<code>Roles</code> dropdown. Here we assign the <code>Researcher</code>
role to the new user. You can give the user more permissions by
assigning multiple roles or select the operation boxes in the
<code>Permissions</code> section.</li>
</ul>
</li>
<li>Click on the <code>Submit</code> button to create the new user.</li>
</ol>
<figure><img src="fig/chapter4/create_user.png" alt="Create a new user" class="figure mx-auto d-block"><div class="figcaption">Create a new user</div>
</figure>
</div>
<div class="section level3">
<h3 id="create-a-new-collaboration">Create a new collaboration<a class="anchor" aria-label="anchor" href="#create-a-new-collaboration"></a>
</h3>
<p>A collaboration is a collection of one or more organizations. Let’s
create a new collaboration between two organizations. Here are the
steps:</p>
<ol style="list-style-type: decimal">
<li>Click on the <code>Collaborations</code> tab in the administration
page.</li>
<li>Click on the <code>Create collaboration</code> button.</li>
<li>Fill in the details of the new collaboration.
<ul>
<li>For <code>Encrypted</code> box, you can select whether the
collaboration should be encrypted or not.</li>
<li>You can select the organizations that will participate in the
collaboration by selecting them from the <code>Organizations</code>
dropdown.</li>
<li>By default, we select the <code>Register nodes</code> box. This will
ensure the nodes of the organizations are registered in the
collaboration. If you don’t select this box, you will have to register
the nodes manually later.</li>
</ul>
</li>
</ol>
<figure><img src="fig/chapter4/create_collab_01.png" alt="Create a new collaboration" class="figure mx-auto d-block"><div class="figcaption">Create a new collaboration</div>
</figure><ol start="4" style="list-style-type: decimal">
<li>Click on the <code>Submit</code> button to create the new
collaboration.
<ul>
<li>After submitting the form, you may see a dialog box to ask you to
download the API key (on MacOS) or a dialog points out that the API key
has been downloaded (on Windows). The API key is used to authenticate
the nodes in the collaboration.</li>
</ul>
</li>
</ol>
<figure><img src="fig/chapter4/create_collab_02.png" alt="Download API keys" class="figure mx-auto d-block"><div class="figcaption">Download API keys</div>
</figure><p>You will see a message:</p>
<blockquote>
<p>API key download</p>
<p>The API keys have been downloaded.</p>
<p>Please distribute each of these keys privately to each of the
organizations. Note that they may reset their API key so that no-one but
them knows it.</p>
</blockquote>
<p>You will need the API keys when you run the nodes to authenticate
with the vantage6 server. Please save the API keys properly, we will
need it in <a href="./chap6_setup_node.html">Chapter 6</a>.</p>
<ol start="5" style="list-style-type: decimal">
<li>After creating the collaboration, you can see the details of the
collaboration by clicking on the specific collaboration listed in the
<code>Collaborations</code> tab.
<ul>
<li>You will see what organizations are participating in the
collaboration.</li>
<li>You will see the nodes of the organizations that are registered in
the collaboration. In case one or more organizations did not register
their nodes when creating or updating the collaboration, you can
register them manually by clicking the
<code>Register missing nodes</code> button. Note that this button is not
visible if all nodes are registered.</li>
<li>You can also see the algorithm store available for the
collaboration. You can add a algorithm store for the collaboration by
clicking the <code>Add algorithm store</code> button.</li>
<li>You can also see the studies of the collaboration. You can add a
study by clicking the <code>Add study</code> button.</li>
</ul>
</li>
</ol>
<figure><img src="fig/chapter4/create_collab_03.png" alt="Collaboration details" class="figure mx-auto d-block"><div class="figcaption">Collaboration details</div>
</figure><div id="challenge-2-manage-vantage6-project-using-the-ui" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2-manage-vantage6-project-using-the-ui" class="callout-inner">
<h3 class="callout-title">Challenge 2: Manage vantage6 project using the UI</h3>
<div class="callout-content">
<p>Go to the administration page in the vantage6 UI, and do the
following:</p>
<ol style="list-style-type: decimal">
<li>Create a new role</li>
<li>Create a new user and grant them the new role you created</li>
<li>Re-login to the vantage6 UI with the new user account and check if
they have the permissions you granted them</li>
</ol>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Vantage6 uses a permission system to control who can do what in the
system.</li>
<li>Vantage6 has default roles like <code>Root</code>,
<code>Collaboration Admin</code>, <code>Organization Admin</code>,
<code>Researcher</code>, and <code>Viewer</code>.</li>
<li>Vantage6 UI can be used to manage the entities of vantage6, like
creating or deleting an organization, a user, or a collaboration.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-chap5_python_client"><p>Content from <a href="chap5_python_client.html">Running a PET analysis using the Python client</a></p>
<hr>
<p>Last updated on 2024-10-03 |

        <a href="https://github.com/vantage6/vantage6-workshop/edit/main/episodes/chap5_python_client.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<p>In the context of the Python client:</p>
<ul>
<li>How to connect to the vantage6 server?</li>
<li>How to explore the <code>Client</code> object?</li>
<li>How to check details of a collaborations?</li>
<li>How to start a compute task?</li>
<li>How to collect the results of a finished computation?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<p>After completing this episode, you will be able to:</p>
<ul>
<li>Understand the basic concepts of the vantage6 Python client.</li>
</ul>
<p>use the Python client to …</p>
<ul>
<li>Connect to the vantage6 server.</li>
<li>Use the Python client to get details of a collaboration.</li>
<li>Create a task using the Python client.</li>
<li>Collect the results of a finished computation using the Python
client.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="prerequisite" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="prerequisite" class="callout-inner">
<h3 class="callout-title">Prerequisite</h3>
<div class="callout-content">
<p>Make sure you completed the <a href="index.html">Setup Episode</a>
before starting this episode. Some basic knowledge of Python is also
required to complete the exercises in this episode.</p>
</div>
</div>
</div>
<div class="section level1">
<h1 id="the-python-client">The Python client<a class="anchor" aria-label="anchor" href="#the-python-client"></a>
</h1>
<p>The vantage6 Python client is a library designed to facilitate
interaction with the vantage6 server, to perform various tasks such as
creating computation tasks, managing organizations, collaborations,
users, and collecting results. It is a versatile alternative to the
web-based user interface we have used in previous lessons.</p>
<p>Data scientists and administrators may use it to manage resources
programatically. For example, to automate actions or integrating them on
other applications. The Python client communicates with the <a href="https://en.wikipedia.org/wiki/REST" class="external-link">REST API (wikipedia.org)</a>
of the vantage6 server, handling encryption and decryption where
applicable.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Alternative clients </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>Besides the Python client, there is also an <a href="https://github.com/iknl/vtg" class="external-link">R client (github.com)</a> available.
This client is more focused on starting federated analysis and does not
provide tools to manage the server. Important to note that this client
is poorly maintained and lags behind in terms of features. Therefore we
do <em>not</em> recommend using it. You can find more information in the
<a href="https://docs.vantage6.ai/en/main/user/rclient.html" class="external-link">documentation
(docs.vantage6.ai)</a>.</p>
<p>If your organization uses a different programming language, you can
always create a client in that language by following the <a href="https://docs.vantage6.ai/en/main/user/api.html" class="external-link">API documentation
(docs.vantage6.ai)</a>.</p>
<p><strong>In this workshop, we will only use on the Python
client.</strong></p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="connect-authenticate">Connect &amp; authenticate<a class="anchor" aria-label="anchor" href="#connect-authenticate"></a>
</h2>
<p>Creating an instance of the vantage6 Python client is relatively
straightforward. The user defines server connection details: server
address, login credentials, and the organization’s private key in case
<a href="https://docs.vantage6.ai/en/main/features/inter-component/encryption.html" class="external-link">encryption
(docs.vantage6.ai)</a> is used in the collaboration. In case the server
has <a href="https://docs.vantage6.ai/en/stable/technical-documentation/features/server/2fa.html" class="external-link">two-factor
authentication (docs.vantage6.ai)</a> (2FA) enabled, you should also
enter the corresponding time-based 6-digit code accordingly.</p>
<p>To avoid leaking your username and/or password by accident, they can
be defined in a separate Python file (e.g., <code>config.py</code>),
which is then imported into the main script. This way, the main script
does not contain any sensitive information.</p>

<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>server_url <span class="op">=</span> <span class="st">"https://&lt;vantage6-server-address&gt;"</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>server_port <span class="op">=</span> <span class="dv">443</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>server_api <span class="op">=</span> <span class="st">"/api"</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>username <span class="op">=</span> <span class="st">"MY USERNAME"</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>password <span class="op">=</span> <span class="st">"MY PASSWORD"</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co"># Path to the private key, if encryption is enabled. Can be None if</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co"># encryption is not used. Note that this key is the organization's</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co"># private key. In case of this workshop we do not use encryption, so</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co"># this can be None.</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>organization_key <span class="op">=</span> <span class="va">None</span></span></code></pre>
</div>
<p>Once you have created the Python module with the configuration
settings, you can import it and create the client instance as
follows:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="im">from</span> vantage6.client <span class="im">import</span> Client</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># It is assumed here that the `config.py` you just created is in the current</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># directory. If it is not, then you need to make sure it can be found on</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># your PYTHONPATH</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="im">import</span> config</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co"># Initialize the client object, and authenticate</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>client <span class="op">=</span> Client(config.server_url, config.server_port, config.server_api,</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>                log_level<span class="op">=</span><span class="st">'info'</span>)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>client.authenticate(config.username, config.password)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co"># In the case of 2FA, you should also include the 6-digit code:</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co"># client.authenticate(config.username, config.password, '123456')</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co"># In case encryption is used, this line can be used to set the organizations private</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co"># key.</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co"># client.setup_encryption(config.organization_key)</span></span></code></pre>
</div>
<div id="connect" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="connect" class="callout-inner">
<h3 class="callout-title">1. Connect 🌍!</h3>
<div class="callout-content">
<p>Connect to the vantage6 server using the Python client!</p>
</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1"> Give me a hint </h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" data-bs-parent="#accordionHint1" aria-labelledby="headingHint1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>Create the <code>config.py</code> with the your credentials and
connection details.</li>
<li>Create a cell with the <code>client</code> script with the code
above.</li>
<li>Run the <code>client</code> cell as defined above to create the
client instance.</li>
<li>Make sure to use the correct user / password</li>
<li>Check the output to see if there are any errors</li>
</ol>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><p>Make sure you have created the <code>config.py</code> file with
your credentials and the <code>client</code> cell with the code
above.</p></li>
<li>
<p>Run the <code>client</code> cell. If the connection is
successful, you should see the message
<code>--&gt; Succesfully authenticated</code>:</p>
<pre><code>Welcome to
                  _                     __
                 | |                   / /
__   ____ _ _ __ | |_ __ _  __ _  ___ / /_
\ \ / / _` | '_ \| __/ _` |/ _` |/ _ \ '_ \
 \ V / (_| | | | | || (_| | (_| |  __/ (_) |
  \_/ \__,_|_| |_|\__\__,_|\__, |\___|\___/
                            __/ |
                           |___/

--&gt; Join us on Discord! https://discord.gg/rwRvwyK
--&gt; Docs: https://docs.vantage6.ai
--&gt; Blog: https://vantage6.ai
------------------------------------------------------------
Cite us!
If you publish your findings obtained using vantage6,
please cite the proper sources as mentioned in:
https://vantage6.ai/vantage6/references
------------------------------------------------------------

...

--&gt; Succesfully authenticated</code></pre>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="using-the-client">Using the client<a class="anchor" aria-label="anchor" href="#using-the-client"></a>
</h2>
<p>The <code>Client</code> instance offers a set of attributes that
correspond to the <a href="./chap3_run_analysis_ui.html#vantage6-user-interface-basics">vantage6
server resources (Episode 3)</a> also described in the <a href="https://docs.vantage6.ai/en/main/introduction/introduction.html#vantage6-resources" class="external-link">official
documentation (docs.vantage6.ai)</a>. The available attributes are:</p>
<table class="table">
<colgroup>
<col width="23%">
<col width="77%">
</colgroup>
<thead><tr class="header">
<th>Resource</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>client.user</code></td>
<td>Manage users including your own user details</td>
</tr>
<tr class="even">
<td><code>client.organization</code></td>
<td>Manage organizations or the organization that you are part of</td>
</tr>
<tr class="odd">
<td><code>client.rule</code></td>
<td>View all available permission rules</td>
</tr>
<tr class="even">
<td><code>client.role</code></td>
<td>Manage roles (are collections of rules)</td>
</tr>
<tr class="odd">
<td><code>client.collaboration</code></td>
<td>Manage collaborations</td>
</tr>
<tr class="even">
<td><code>client.task</code></td>
<td>Create new tasks and view their run data</td>
</tr>
<tr class="odd">
<td><code>client.result</code></td>
<td>Obtain results from the tasks</td>
</tr>
<tr class="even">
<td><code>client.util</code></td>
<td>Provides utility functions for the vantage6 Python client. For
example to reset your password</td>
</tr>
<tr class="odd">
<td><code>client.node</code></td>
<td>Manage nodes</td>
</tr>
<tr class="even">
<td><code>client.store</code></td>
<td>Manage algorithm stores</td>
</tr>
<tr class="odd">
<td><code>client.algorithm</code></td>
<td>Manage algorithms that can be used for the computations</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="method-and-parameter-documentation">Method and parameter documentation<a class="anchor" aria-label="anchor" href="#method-and-parameter-documentation"></a>
</h3>
<p>There are many methods available in each of the resources and each
method has its own set of parameters. To know which parameters are
available for a specific method, you can use the <code>help()</code>
function in Python. For example, to get the documentation of the
<code>client.organization.list()</code> method, you can use the
following command:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="bu">help</span>(client.organization.<span class="bu">list</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>list(self, name: 'str' = None, country: 'int' = None, collaboration: 'int' = None, study: 'int' = None, page: 'int' = None, per_page: 'int' = None) -&gt; 'list[dict]'
    List organizations

    Parameters
    ----------
    name: str, optional
        Filter by name (with LIKE operator)
    country: str, optional
        Filter by country
    collaboration: int, optional
        Filter by collaboration id. If client.setup_collaboration() was called,
        the previously setup collaboration is used. Default value is None
</code></pre>
</div>
<p>This shows you that you can filter the list of organizations (among
others) by name, country, and collaboration. It is also possible to
request documentation of a higher level method, for example
<code>help(client.organization)</code> or even
<code>help(client)</code>.:</p>
<div id="accordionSpoiler2" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler2" aria-expanded="false" aria-controls="collapseSpoiler2">
  <h3 class="accordion-header" id="headingSpoiler2">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Online documentation </h3>
</button>
<div id="collapseSpoiler2" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler2" aria-labelledby="headingSpoiler2">
<div class="accordion-body">
<p>To view all <code>Client</code> functions and their arguments without
using <code>help()</code> you can use the <a href="https://docs.vantage6.ai/en/main/function-docs/_autosummary/vantage6.client.Client.html#vantage6-client-client" class="external-link">official
documentation (docs.vantage6.ai)</a>. Which is the same as the Python
client’s docstring.</p>
<p>Make sure you are viewing the documentation of the version of the
client you are using. You can find the version of the client by one of
the following commands:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="im">import</span> vantage6.client</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="bu">print</span>(vantage6.client.__version__)</span></code></pre>
</div>
<p>or by running the following command in the terminal:</p>
<div class="tabs">
<nav><div id="nav-tab-1" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-1-1" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-1" type="button" role="tab" aria-controls="nav-tabpanel-1-1" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-1-1">
  Linux / MacOS
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-2" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-2" type="button" role="tab" aria-controls="nav-tabpanel-1-2" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-2">
  Windows
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-1" class="tab-content">
<div id="nav-tabpanel-1-1" class="tab-pane show active" aria-labelledby="nav-tab-1-1" role="tabpanel">
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">pip</span> show vantage6-client <span class="kw">|</span> <span class="fu">grep</span> Version</span></code></pre>
</div>
</div>
<div id="nav-tabpanel-1-2" class="tab-pane" aria-labelledby="nav-tab-1-2" role="tabpanel">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">CMD<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode cmd" tabindex="0"><code class="sourceCode dosbat"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>pip show vantage6<span class="at">-client</span> <span class="kw">|</span> <span class="kw">findstr</span> Version</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="permissions" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="permissions" class="callout-inner">
<h3 class="callout-title">Permissions</h3>
<div class="callout-content">
<p>Note that the authenticated user may not be allowed to perform all
operations or view all resources. For example, a user may not be allowed
to create a new organization, but may be allowed to list the
organizations within all collaboration its organization participates in.
The server will only allow the user to perform operations on the
resources that the user has permission to perform.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="the-5-basic-operations">The 5 basic operations<a class="anchor" aria-label="anchor" href="#the-5-basic-operations"></a>
</h3>
<p>Almost all of the resources provide a <a href="#get">get</a>, <a href="#list">list</a>, <a href="#create">create</a>, <a href="#update">update</a> and <a href="#delete">delete</a> operation.
When using the <code>get</code> and <code>list</code> methods a
dictionary is returned with the requested information. In the case of
the <code>create</code> and <code>update</code> methods typically the
created resource is returned. Finally in the case of <code>delete</code>
nothing is returned but a message is printed to confirm the
deletion.</p>
<div class="tabs">
<nav><div id="nav-tab-2" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-2-1" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-1" type="button" role="tab" aria-controls="nav-tabpanel-2-1" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-2-1">
  List
  </h3>
</button>
<button class="nav-link" id="nav-tab-2-2" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-2" type="button" role="tab" aria-controls="nav-tabpanel-2-2" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-2-2">
  Get
  </h3>
</button>
<button class="nav-link" id="nav-tab-2-3" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-3" type="button" role="tab" aria-controls="nav-tabpanel-2-3" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-2-3">
  Create
  </h3>
</button>
<button class="nav-link" id="nav-tab-2-4" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-4" type="button" role="tab" aria-controls="nav-tabpanel-2-4" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-2-4">
  Update
  </h3>
</button>
<button class="nav-link" id="nav-tab-2-5" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-5" type="button" role="tab" aria-controls="nav-tabpanel-2-5" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-2-5">
  Delete
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-2" class="tab-content">
<div id="nav-tabpanel-2-1" class="tab-pane show active" aria-labelledby="nav-tab-2-1" role="tabpanel">
<p>Get all <em>resource</em> items that the user is allowed to see with
<code>client.&lt;resource&gt;.list()</code>. For example:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>client.organization.<span class="bu">list</span>()</span></code></pre>
</div>
<p>The output should look similar to the following:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[
    {'id': 1, 'name': 'Huckleberry Holdings', ...}
    {'id': 2, 'name': 'Lychee Labs', ...},
    {'id': 3, 'name': 'Pineapple Paradigm', ...},
    {'id': 4, 'name': 'Huckleberry Hub', ...},
    {'id': 5, 'name': 'Mango Matrix', ...},
    {'id': 6, 'name': 'Apple Innovations', ...},
    {'id': 7, 'name': 'eScience center', ...},
    {'id': 8, 'name': 'Grapefruit Group', ...},
    {'id': 9, 'name': 'Raspberry Revolution', ...},
]</code></pre>
</div>
<p>The <code>list()</code> method returns a paginated result. Pagination
divides the complete list of items into smaller parts, called pages. By
default, the <code>list()</code> method returns the first page of 10
items. The page and the number of items per page can be specified with
the <code>page</code> and <code>per_page</code> parameters.</p>
</div>
<div id="nav-tabpanel-2-2" class="tab-pane" aria-labelledby="nav-tab-2-2" role="tabpanel">
<p>Get a specific <em>resource</em> with
<code>client.&lt;resource&gt;.get(&lt;id&gt;)</code>. For example:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>client.organization.get(<span class="dv">1</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{
    'nodes': '/api/node?organization_id=1',
    'public_key': '',
    'studies': '/api/study?organization_id=1',
    'name': 'Huckleberry Holdings',
    'tasks': '/api/task?init_org_id=1',
    'address2': '',
    'users': '/api/user?organization_id=1',
    'domain': 'huckleberryholdings.mc',
    'country': 'Monaco',
    'zipcode': '98000',
    'runs': '/api/run?organization_id=1',
    'address1': '4747 Huckleberry Ln',
    'id': 1,
    'collaborations': '/api/collaboration?organization_id=1'
}</code></pre>
</div>
</div>
<div id="nav-tabpanel-2-3" class="tab-pane" aria-labelledby="nav-tab-2-3" role="tabpanel">
<p>Register a new <em>resource</em> at the server with
<code>client.&lt;resource&gt;.create(...)</code>. For example, let’s
create a new organization:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>client.organization.create(</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>    name<span class="op">=</span><span class="st">'new_organization'</span>,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>    address1<span class="op">=</span><span class="st">'street 1'</span>,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>    address2<span class="op">=</span><span class="st">''</span>,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>    zipcode<span class="op">=</span><span class="st">'1234AB'</span>,</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>    country<span class="op">=</span><span class="st">'NL'</span>,</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>    domain<span class="op">=</span><span class="st">'example.com'</span>,</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{
    'nodes': '/api/node?organization_id=172',
    'public_key': '',
    'studies': '/api/study?organization_id=172',
    'name': 'new_organization',
    'tasks': '/api/task?init_org_id=172',
    'address2': '',
    'users': '/api/user?organization_id=172',
    'domain': 'example.com',
    'country': 'NL',
    'zipcode': '1234AB',
    'runs': '/api/run?organization_id=172',
    'address1': 'street 1',
    'id': 172,
    'collaborations': '/api/collaboration?organization_id=172'
}</code></pre>
</div>
</div>
<div id="nav-tabpanel-2-4" class="tab-pane" aria-labelledby="nav-tab-2-4" role="tabpanel">
<p>Update an specific <em>resource</em>. For example:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>client.organization.update(id_, name<span class="op">=</span><span class="st">'new_name'</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{
    'nodes': '/api/node?organization_id=173',
    'public_key': '',
    'studies': '/api/study?organization_id=173',
    'name': 'new_name',
    'tasks': '/api/task?init_org_id=173',
    'address2': '',
    'users': '/api/user?organization_id=173',
    'domain': 'example.com',
    'country': 'NL',
    'zipcode': '1234AB',
    'runs': '/api/run?organization_id=173',
    'address1': 'street 1',
    'id': 173,
    'collaborations': '/api/collaboration?organization_id=173'
}</code></pre>
</div>
</div>
<div id="nav-tabpanel-2-5" class="tab-pane" aria-labelledby="nav-tab-2-5" role="tabpanel">
<p>To delete an specific instance of the given <em>resource</em> you can
use <code>client.&lt;resource&gt;.delete(id_)</code> . Sometimes you
need to also delete all the related instances of the given
<em>resource</em> as well.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>client.organization.delete(<span class="dv">1</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>--&gt; Organization id=1 was removed from the database</code></pre>
</div>
</div>
</div>
</div>
<div id="collect-collaboration-details" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="collect-collaboration-details" class="callout-inner">
<h3 class="callout-title">2. Collect collaboration details</h3>
<div class="callout-content">
<p>Before starting a task, you need to know the details of the
collaboration you are working with. Use the Python client to get the
details of the collaboration you have access to. Write down the
<strong>name</strong> and <strong>ID</strong> of each collaboration.</p>
</div>
</div>
</div>
<div id="accordionHint2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint2" aria-expanded="false" aria-controls="collapseHint2">
  <h4 class="accordion-header" id="headingHint2"> Give me a hint </h4>
</button>
<div id="collapseHint2" class="accordion-collapse collapse" data-bs-parent="#accordionHint2" aria-labelledby="headingHint2">
<div class="accordion-body">
<p>Use the <code>client.collaboration.list()</code> method to get the
details of the collaborations you have access to.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>client.collaboration.<span class="bu">list</span>()</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionHint3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint3" aria-expanded="false" aria-controls="collapseHint3">
  <h4 class="accordion-header" id="headingHint3"> Give me a hint </h4>
</button>
<div id="collapseHint3" class="accordion-collapse collapse" data-bs-parent="#accordionHint3" aria-labelledby="headingHint3">
<div class="accordion-body">
<p>Use <code>help(client.collaboration.list)</code> to see which
arugments you can use to filter the collaborations.</p>
</div>
</div>
</div>
</div>
<div id="accordionHint4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint4" aria-expanded="false" aria-controls="collapseHint4">
  <h4 class="accordion-header" id="headingHint4"> Give me a hint </h4>
</button>
<div id="collapseHint4" class="accordion-collapse collapse" data-bs-parent="#accordionHint4" aria-labelledby="headingHint4">
<div class="accordion-body">
<p>You can use the <code>fields</code> parameter to specify which fields
you want to see in the output.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>client.collaboration.<span class="bu">list</span>(fields<span class="op">=</span>[<span class="st">'id'</span>, <span class="st">'name'</span>])</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>client.collaboration.<span class="bu">list</span>(fields<span class="op">=</span>[<span class="st">'id'</span>, <span class="st">'name'</span>])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[
    {'id': 168, 'name': 'Lychee Labs', ...},
    {'id': 158, 'name': 'Pineapple Paradigm', ...},
    {'id': 155, 'name': 'Huckleberry Hub', ...},
    {'id': 140, 'name': 'Mango Matrix', ...},
    {'id': 128, 'name': 'Apple Innovations', ...},
    {'id': 170, 'name': 'eScience center', ...},
    {'id': 165, 'name': 'Grapefruit Group', ...},
    {'id': 145, 'name': 'Raspberry Revolution', ...},
    {'id': 136, 'name': 'Ivy Berry Solutions', ...},
    {'id': 166, 'name': 'Huckleberry Holdings', ...}
]</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="additional-operations">Additional operations<a class="anchor" aria-label="anchor" href="#additional-operations"></a>
</h3>
<p>Some resources do not provide all five operations and some resource
provide additional operations. For example:</p>
<ul>
<li>it is not possible to create new rules. In other words:
<code>client.rule.create</code> does not exist.</li>
<li>the <code>client.task</code> has a <code>client.task.kill</code>
method which is able to stop a task that currently is running.</li>
</ul>
</div>
<div class="section level3">
<h3 id="top-level-methods">Top level methods<a class="anchor" aria-label="anchor" href="#top-level-methods"></a>
</h3>
<p>Up untill now we only discussed <code>Client</code> methods that are
bound to an resource. There are also some methods that are not bound to
a specific resource. Examples are:</p>
<ul>
<li>
<code>client.authenticate()</code> to authenticate the user. You
have already used this method when you authenticated to the server.</li>
<li>
<code>client.setup_encryption()</code> to setup the encryption.</li>
<li>
<code>client.wait_for_results()</code> to wait for the results of a
task.</li>
</ul>
<div id="find-documentation" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="find-documentation" class="callout-inner">
<h3 class="callout-title">3. Find documentation</h3>
<div class="callout-content">
<p>Find the documentation on how to reset your password 🔑 in case you
forgot it. You can use the <code>help()</code> to explore the client
functions.</p>
</div>
</div>
</div>
<div id="accordionHint5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint5" aria-expanded="false" aria-controls="collapseHint5">
  <h4 class="accordion-header" id="headingHint5"> Give me a hint </h4>
</button>
<div id="collapseHint5" class="accordion-collapse collapse" data-bs-parent="#accordionHint5" aria-labelledby="headingHint5">
<div class="accordion-body">
<p>Have a look at the <a href="#using-the-client">client table</a>, and
see if you can find a resource group that might contain the method you
are looking for.</p>
</div>
</div>
</div>
</div>
<div id="accordionHint6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint6" aria-expanded="false" aria-controls="collapseHint6">
  <h4 class="accordion-header" id="headingHint6"> Give me a hint </h4>
</button>
<div id="collapseHint6" class="accordion-collapse collapse" data-bs-parent="#accordionHint6" aria-labelledby="headingHint6">
<div class="accordion-body">
<p>Use the <code>help()</code> function to find the documentation of the
<code>client.util</code> resource.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>To obtain a token:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="bu">help</span>(client.util.reset_my_password)</span></code></pre>
</div>
<p>Then you can use:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="bu">help</span>(client.util.change_my_password)</span></code></pre>
</div>
<p>The function <code>client.util.change_my_password</code> is used to
change the password of the authenticated user.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="identifiers-are-key">Identifiers are key<a class="anchor" aria-label="anchor" href="#identifiers-are-key"></a>
</h3>
<p>It is important to note that the Python client use identifiers rather
than names to select resources. For example, to filter the organizations
that belong to a a given collaboration, you need to know the
collaboration’s identifier first.</p>
<p>In a previous challenge, you were asked to get the details of the
collaborations you have access to. This is common practice when working
with the vantage6 Python client.</p>
<p>It is also possible to obtain these identifiers through the UI.
However, when working with the UI, identifiers are not as important as
the names can be used to identify the resources. But also for the UI, it
is important to know the identifiers of the resources as names are not
always unique.</p>
<div id="accordionSpoiler3" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler3" aria-expanded="false" aria-controls="collapseSpoiler3">
  <h3 class="accordion-header" id="headingSpoiler3">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Why identifiers? </h3>
</button>
<div id="collapseSpoiler3" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler3" aria-labelledby="headingSpoiler3">
<div class="accordion-body">
<p>The reason for this is that the UI is designed to more be
user-friendly, and it is expected that users will interact with the
resources using their names. Typically they will select the resources
from a list or dropdown. Since names do not always have to be unique
(e.g. task names) it is impossible to identify a resource uniquely by
its name.</p>
</div>
</div>
</div>
</div>
<p>Now that we understand the basic concepts of the vantage6 Python
client, let us get some more details about our collaborations. First, as
before, we collect the details of the collaborations we have access to.
We do so by specifying an additional parameter <code>fields</code> to
the <code>list()</code> method. This parameter allows us to specify
which fields we want to see in the output. This makes it more readable
and easier to find the information we are looking for.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>client.collaboration.<span class="bu">list</span>(fields<span class="op">=</span>[<span class="st">'id'</span>, <span class="st">'name'</span>])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[
    {'id': 12, 'name': 'Birch Brotherhood'},
    {'id': 9, 'name': 'Pine Partners'},
    {'id': 11, 'name': 'Cedar Coalition'},
    {'id': 10, 'name': 'Maple Consortium'},
    {'id': 15, 'name': 'demo'},
    {'id': 8, 'name': 'Oak Alliance'},
    {'id': 14, 'name': 'Redwood Union'},
    {'id': 13, 'name': 'Willow Network'}
]</code></pre>
</div>
<p>Then, we are interested in all the organizations that participate in
one of the collaborations. Lets assume that the collaboration ID is 1.
We then can get the organizations that are part of this collaboration by
using the <code>client.organization.list()</code> method with the
<code>collaboration</code> parameter set to 1.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>client.organization.<span class="bu">list</span>(collaboration<span class="op">=</span><span class="dv">1</span>, fields<span class="op">=</span>[<span class="st">'id'</span>, <span class="st">'name'</span>])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[
    {'id': 171, 'name': 'IKNL'},
    {'id': 172, 'name': 'new_organization'}
]</code></pre>
</div>
<p>Write down the <strong>ID</strong> of each organization and
collaboration. You will need them in the next challenges.</p>
</div>
<div class="section level3">
<h3 id="creating-a-new-task">Creating a new task<a class="anchor" aria-label="anchor" href="#creating-a-new-task"></a>
</h3>
<p>Before starting an analysis we need several details about the
collaboration and the analysis to be performed. This includes the
organization and collaboration identifiers, we have just collected.</p>
<p>Before we start the analysis, let us check if everything is in
place:</p>
<div id="checklist1" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Checklist</h3>
<div class="callout-content">
<p><strong>Network</strong></p>
<ul>
<li>✔ Connect to the vantage6 server using the Python client.</li>
<li>✔ Use the Python client to get the details of the collaboration and
its organizations you have access to.</li>
<li>⚠ Check the status of the nodes</li>
</ul>
<p><strong>Average Algorithm</strong></p>
<ul>
<li>✔ published at: <code>harbor2.vantage6.ai/demo/average</code>.</li>
<li>✔ We are going to use the <code>partial_average()</code>
function.</li>
<li>✔ The function requires a <code>column_name</code> parameter, we are
setting this to ‘age’.</li>
</ul>
</div>
</div>
</div>
<div class="section level4">
<h4 id="node-status">Node status<a class="anchor" aria-label="anchor" href="#node-status"></a>
</h4>
<p>As the checklist above indicates, we have not checked the status of
the nodes. You can start an analys when nodes are offline, they will
start the analysis once they are online. In case a node is offline, you
might need to inquire with the node owner to get it back online.</p>
<div id="check-the-status-of-the-nodes" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="check-the-status-of-the-nodes" class="callout-inner">
<h3 class="callout-title">4. Check the status of the nodes</h3>
<div class="callout-content">
<p>Use the Python client to check the status of the nodes that are part
of the collaboration you are interested in.</p>
</div>
</div>
</div>
<div id="accordionHint7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint7" aria-expanded="false" aria-controls="collapseHint7">
  <h4 class="accordion-header" id="headingHint7"> Give me a hint </h4>
</button>
<div id="collapseHint7" class="accordion-collapse collapse" data-bs-parent="#accordionHint7" aria-labelledby="headingHint7">
<div class="accordion-body">
<p>To check the status of the nodes, you can use the
<code>client.node</code> resource.</p>
</div>
</div>
</div>
</div>
<div id="accordionHint8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint8" aria-expanded="false" aria-controls="collapseHint8">
  <h4 class="accordion-header" id="headingHint8"> Give me a hint </h4>
</button>
<div id="collapseHint8" class="accordion-collapse collapse" data-bs-parent="#accordionHint8" aria-labelledby="headingHint8">
<div class="accordion-body">
<p>See <code>help(client.node.list)</code> to see how to get the details
of the nodes of a given collaboration. You can also use the
<code>fields</code> parameter to get only the information you are
interested in.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>You can obtain node details by using the
<code>client.node.list()</code> method. To filter the nodes you are
interested in, you can use the <code>collaboration</code> parameter in
the <code>client.node.list()</code> method:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>client.node.<span class="bu">list</span>(collaboration<span class="op">=</span><span class="dv">1</span>)</span></code></pre>
</div>
<p>You can also specify the <code>fields</code> parameter to get only
the information you are interested in:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>client.node.<span class="bu">list</span>(collaboration<span class="op">=</span><span class="dv">1</span>, fields<span class="op">=</span>[<span class="st">'id'</span>, <span class="st">'name'</span>, <span class="st">'status'</span>])</span></code></pre>
</div>
<p>You can also use the <code>is_online</code> parameter to filter the
nodes that are online. But for now it would be good to see both online
and offline nodes.</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[
    {
        'id': 155,
        'name': 'IKNL demo node',
        'status': None
    }
]</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>One of the nodes in our collaboration is offline. In the real world,
you would need to contact the node owner to get the node back online.
But for the purpose of this workshop we have defined a <a href="./chap2_introduction_v6.html#project-administration-in-vantage6">study</a>
that contains only online nodes. Which has a name that ends with
<em>Subset</em>. You can find the study ID by using the
<code>client.study.list()</code> method. Write down the ID of the
study.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>client.study.<span class="bu">list</span>(fields<span class="op">=</span>(<span class="st">"id"</span>, <span class="st">"name"</span>))</span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="task-definition">Task definition<a class="anchor" aria-label="anchor" href="#task-definition"></a>
</h4>
<p>A task in vantage6 is a request to execute an algorithm on a given
organization. When creating a task, you need to specify the
following:</p>
<ul>
<li>The collaboration[, study] and organization identifiers.</li>
<li>The algorithm to be executed.</li>
<li>The input parameters for the algorithm.</li>
</ul>
<p>The average algorithm we are going to use is the same as in <a href="./chap3_run_analysis_ui.html#running-a-simple-federated-algorithm">Episode
3</a>.</p>
<p>This algorithm has two functions: <code>partial_average()</code> and
<code>central_average()</code>. If you do not know the difference
between <em>partial</em> and <em>central</em> function, you should read
<a href="./chap2_introduction_v6.html#how-algorithms-run-in-vantage6">How
algorithms run in vantage6 (Episode 2)</a> again.</p>
<p>We can use the <code>client.task.create()</code> method to create a
new task to be executed by the nodes.</p>
<div id="accordionSpoiler4" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler4" aria-expanded="false" aria-controls="collapseSpoiler4">
  <h3 class="accordion-header" id="headingSpoiler4">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Documentation of client.task.create() </h3>
</button>
<div id="collapseSpoiler4" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler4" aria-labelledby="headingSpoiler4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="bu">help</span>(client.task.create)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>create(organizations: 'list', name: 'str', image: 'str', description: 'str', input_: 'dict', collaboration: 'int' = None, study: 'int' = None, store: 'int' = None, databases: 'list[dict]' = None) -&gt; 'dict' method of vantage6.client.Task instance
    Create a new task

    Parameters
    ----------
    organizations : list
        Organization ids (within the collaboration) which need
        to execute this task
    name : str
        Human readable name
    image : str
        Docker image name which contains the algorithm
    description : str
        Human readable description
    input_ : dict
        Algorithm input
    collaboration : int, optional
        ID of the collaboration to which this task belongs. Should be set if
        the study is not set
    study : int, optional
        ID of the study to which this task belongs. Should be set if the
        collaboration is not set
    store : int, optional
        ID of the algorithm store to retrieve the algorithm from
    databases: list[dict], optional
        Databases to be used at the node. Each dict should contain
        at least a 'label' key. Additional keys are 'query' (if using
        SQL/SPARQL databases), 'sheet_name' (if using Excel databases),
        and 'preprocessing' information.

    Returns
    -------
    dict
        A dictionairy containing data on the created task, or a message
        from the server if the task could not be created</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Lets start by defining the input for the task. The
<code>partial_average()</code> function requires a
<code>column_name</code> parameter. We can define the input as
follows:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>input_ <span class="op">=</span> {</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>    <span class="st">'method'</span>: <span class="st">'partial_average'</span>,</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>    <span class="st">'args'</span>: [],</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>    <span class="st">'kwargs'</span>: {<span class="st">'column_name'</span>: <span class="st">'age'</span>}</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>}</span></code></pre>
</div>
<p>Basically we are defining the method to be executed, the arguments
and keyword arguments for the method. In other words, we just created a
function call in Python that would look like this:
<code>partial_average(column_name=age)</code>. If you are not familiar
with Python’s args and kwargs, you can read more about them at W3C
Schools: <a href="https://www.w3schools.com/python/gloss_python_function_arbitrary_arguments.asp" class="external-link">args
(w3schools.com)</a> and <a href="https://www.w3schools.com/python/gloss_python_function_arbitrary_keyword_arguments.asp" class="external-link">kwargs
(w3schools.com)</a>.</p>
<p>Now that you have defined the task input, you can create and start it
by also specifying (using the IDs we collected earlier) which
organizations and for which collaboration, it will be executed:</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>average_task <span class="op">=</span> client.task.create(</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>   collaboration<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>   organizations<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>],</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>   study<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>   name<span class="op">=</span><span class="st">"name_for_the_task"</span>,</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>   image<span class="op">=</span><span class="st">"harbor2.vantage6.ai/demo/average"</span>,</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>   description<span class="op">=</span><span class="st">''</span>,</span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>   input_<span class="op">=</span>input_,</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>   databases<span class="op">=</span>[</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a>      {<span class="st">'label'</span>: <span class="st">'default'</span>}</span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>   ]</span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a>)</span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="database-parameter">Database parameter<a class="anchor" aria-label="anchor" href="#database-parameter"></a>
</h4>
<p>We have not yet explained the <code>databases</code> parameter. This
parameter is used to specify the database that the nodes will use to
execute the algorithm. Each node can have multiple databases, and you
can specify them in the <code>databases</code> parameter. We will go
into more detail about this in <a href="./chap6_setup_node.html">Seting
up a vantage6 node (Episode 6)</a>.</p>
</div>
</div>
<div class="section level3">
<h3 id="obtaining-results">Obtaining results<a class="anchor" aria-label="anchor" href="#obtaining-results"></a>
</h3>
<p>A client’s task execution request is asynchronous. This means that
once the <code>client.task.create()</code> method is invoked, the task
will begin running in the background, returning the control to the
Python program immediately (i.e., without waiting for the task to
complete).</p>
<p>This means that in case you want to use the task result in the
remainder of your code, your program needs to wait until the task is
completed, so you can get access to the results (or to the error
details, if something goes wrong).</p>
<p>You can use the <code>client.wait_for_result()</code> method to make
the program execution wait until the task is completed. For that, you
need the ID of the task you just created, which was included in the
dictionary returned by the <code>client.task.create()</code> method. For
the task execution request of the code snippet above, this will look
like:</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>task_id <span class="op">=</span> average_task[<span class="st">'id'</span>]</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>result <span class="op">=</span> client.wait_for_results(task_id)</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="aggregate-results">Aggregate results<a class="anchor" aria-label="anchor" href="#aggregate-results"></a>
</h3>
<p>The results contain the output of the algorithm. In the case of the
<code>partial_average()</code> function, the output is not yet
aggregated. This means that the output of each node is returned
separately. In the case of the <code>central_average()</code> function,
the output is aggregated and only the aggregated result is returned.</p>
<p>For now we can aggregate the results ourselfs:</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>global_sum <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>global_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a><span class="cf">for</span> output <span class="kw">in</span> results[<span class="st">"data"</span>]:</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>    output <span class="op">=</span> json.loads(output[<span class="st">"result"</span>])</span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a>    global_sum <span class="op">+=</span> output[<span class="st">"sum"</span>]</span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a>    global_count <span class="op">+=</span> output[<span class="st">"count"</span>]</span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a><span class="bu">print</span>(global_sum <span class="op">/</span> global_count)</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="create-a-central-task">Create a central task<a class="anchor" aria-label="anchor" href="#create-a-central-task"></a>
</h3>
<p>In the previous section you created a task to run the
<code>partial_average()</code> function. Now, create a task to run the
<code>central_average()</code> function.</p>
<div id="run-central-method" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="run-central-method" class="callout-inner">
<h3 class="callout-title">5. Run central method</h3>
<div class="callout-content">
<p>In section <a href="#creating-a-new-task">Creating a new task</a> it
is explained how to create a task to run the
<code>partial_average()</code> function. Now, create a task to run the
<code>central_average()</code> function. ⚠ Make sure to
<strong>only</strong> send the task to a single organization.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>input_ <span class="op">=</span> {</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>    <span class="st">'method'</span>: <span class="st">'central_average'</span>,</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>    <span class="st">'args'</span>: [],</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>    <span class="st">'kwargs'</span>: {<span class="st">'column_name'</span>: <span class="st">'age'</span>}</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>}</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>average_task <span class="op">=</span> client.task.create(</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>   organizations<span class="op">=</span>[<span class="dv">1</span>],</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>   study<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>   name<span class="op">=</span><span class="st">"name_for_the_task"</span>,</span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>   image<span class="op">=</span><span class="st">"harbor2.vantage6.ai/demo/average"</span>,</span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>   description<span class="op">=</span><span class="st">''</span>,</span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>   input_<span class="op">=</span>input_,</span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>   databases<span class="op">=</span>[</span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a>      {<span class="st">'label'</span>: <span class="st">'default'</span>}</span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a>   ]</span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a>)</span></code></pre>
</div>
<p>Then you can obtain the results by using the
<code>client.wait_for_results()</code> method:</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>task_id <span class="op">=</span> average_task[<span class="st">'id'</span>]</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>result <span class="op">=</span> client.wait_for_results(task_id)</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a><span class="co"># '{"average": 48.8}'</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="inspecting-log-files">Inspecting log files<a class="anchor" aria-label="anchor" href="#inspecting-log-files"></a>
</h3>
<p>Each task consists of several runs. Each node included in the task
execution will at least have one run. But in case of multi-step
algorithms or iterative algorithms, a node can have multiple runs. Each
run has a log file that contains information about the execution of the
algorithm on the node.</p>
<div id="inspect-log-files" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="inspect-log-files" class="callout-inner">
<h3 class="callout-title">6. Inspect log files</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Retrieve the log files from the central method from previous
challenge.</li>
<li>Rerun the central method, but this time use a column name that does
not exist in the dataset (e.g. <code>abc123</code>). Retrieve the log
files from this task as well.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<p>To retrieve the log files from any task, you can use the
<code>client.run.from_task()</code> method:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>runs <span class="op">=</span> client.run.from_task(task_id)</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="cf">for</span> run <span class="kw">in</span> runs[<span class="st">"data"</span>]:</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>    <span class="bu">print</span>(run[<span class="st">'log'</span>])</span></code></pre>
</div>
<p>In the second case you should be able to find an exception in the log
file. Is the error message clear enough to understand what went
wrong?</p>
</div>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</div>
</div></section><section id="aio-chap6_setup_node"><p>Content from <a href="chap6_setup_node.html">Setting up a vantage6 node</a></p>
<hr>
<p>Last updated on 2024-10-22 |

        <a href="https://github.com/vantage6/vantage6-workshop/edit/main/episodes/chap6_setup_node.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are the requirements to install a node?</li>
<li>How to install the command line interface (CLI)?</li>
<li>Which commands are available in the CLI?</li>
<li>How to set up a new node?</li>
<li>How to reset and update an API key?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the requirements for setting up vantage6 node</li>
<li>Understand the basic <code>v6</code> commands</li>
<li>Be able to create a new vantage6 node using <code>v6</code>
commands</li>
<li>Be able to reset and update an API key for a node</li>
<li>Be able to observe the logs of vantage6 node</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Vantage6 node is the software that runs on a data station. It allows
the data owner to share their data within the vantage6 network in a
privacy enhancing way. Also, it is responsible for the execution of the
federated learning tasks and the communication with the vantage6
server.</p>
<p>Each organization that is involved in a federated learning
collaboration has its own node in that collaboration. They should
therefore install the node software on a (virtual) machine hosted in
their own infrastructure. The machine should have access to the data
that is used in the federated learning collaboration.</p>
<p>This chapter will explain how to set up and run the vantage6 node
software.</p>
<section><h2 class="section-heading" id="requirements-on-hardware-and-software">Requirements on hardware and software<a class="anchor" aria-label="anchor" href="#requirements-on-hardware-and-software"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="hardware-requirements">Hardware requirements<a class="anchor" aria-label="anchor" href="#hardware-requirements"></a>
</h3>
<p>The minimal hardware requirements are:</p>
<ul>
<li>x86 CPU architecture + virtualization enabled. This setting is
usually the default in most of the systems.</li>
<li>1 GB memory</li>
<li>Sufficient storage to install Python, docker and vantage6, and to
store the required docker images (50GB+ recommended).</li>
<li>Stable and fast internet connection (1 Mbps+).</li>
</ul>
<p>The hardware requirements of vantage6 node also depend on the
algorithms that the node will run. For example, you need much less
compute power for a descriptive statistical algorithm than for a machine
learning model.</p>
<p>Even though a vantage6 node can be installed and run on Linux,
Windows and Mac, Linux is the recommended OS.</p>
<p>In this lesson, you will use your laptop, but in a production
scenario, we recommend to use a server or virtual machine to run the
node.</p>
</div>
<div class="section level3">
<h3 id="software-requirements">Software requirements<a class="anchor" aria-label="anchor" href="#software-requirements"></a>
</h3>
<p>The following software must be installed before installing the
vantage6 node:</p>
<ul>
<li>Recommended operating system: Ubuntu 20.04+ , MacOS Big Sur+, or
Windows 10+</li>
<li>Docker Desktop (Windows, MacOS) or the Docker Engine (Linux)</li>
<li>Miniconda (latest version)</li>
<li>Python v3.10</li>
<li>Python packages:
<ul>
<li><a href="https://pypi.org/project/vantage6/" class="external-link">vantage6==4.7.1</a></li>
<li><a href="https://pypi.org/project/jupyterlab/" class="external-link">jupyterlab</a></li>
</ul>
</li>
</ul>
<p>You should already have installed the requirements before coming to
this lesson. They are detailed in the <a href="index.html#setup">Setup
section</a>.</p>
<div id="docker-installation" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="docker-installation" class="callout-inner">
<h3 class="callout-title">⚠️ Docker installation</h3>
<div class="callout-content">
<ul>
<li><p>For Linux users, some <a href="https://docs.docker.com/engine/install/linux-postinstall/" class="external-link">post-installation
steps</a> may be required (as also mentioned in the <a href="index.html#setup">setup section</a>). Vantage6 needs to be able to run
docker without sudo, and these steps ensure just that.</p></li>
<li><p>For Windows users, if you are using Docker Desktop, it may be
preferable to limit the amount of memory Docker can use - in some cases
it may otherwise consume much memory and slow down the system. This may
be achieved as described <a href="https://stackoverflow.com/questions/62405765/memory-allocation-to-docker-containers-after-moving-to-wsl-2-in-windows" class="external-link">here</a>.</p></li>
</ul>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<hr class="half-width">
<p>The Python package <code>vantage6</code> provides a command-line
interface (CLI) to manage the vantage6 infrastructure.</p>
<p>To install this CLI package, run the following command in your Python
environment, provided you had not done so already in the <a href="index.html#setup">Setup section</a>:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># First go to your python virtual environment</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="ex">conda</span> create <span class="at">-n</span> v6-workshop python=3.10</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="ex">conda</span> activate v6-workshop</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co"># Then install the package</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="ex">pip</span> install vantage6 jupyterlab</span></code></pre>
</div>
<p>To verify the installed CLI, run the command,</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">v6</span> <span class="at">--help</span></span></code></pre>
</div>
<p>If the installation is successful, it will print out a message
explaining the CLI usage.</p>
</section><section><h2 class="section-heading" id="v6-node-commands">
<code>v6 node</code> commands<a class="anchor" aria-label="anchor" href="#v6-node-commands"></a>
</h2>
<hr class="half-width">
<p>The vantage6 CLI provides the <code>v6 node</code> command to manage
the vantage6 node instances.</p>
<p>To see how to use it, run the command <code>v6 node --help</code> in
your terminal, and it will print out the following messages:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">Usage:</span> v6 node <span class="pp">[</span><span class="ss">OPTIONS</span><span class="pp">]</span> COMMAND <span class="pp">[</span><span class="ss">ARGS</span><span class="pp">]</span>...</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="ex">Manage</span> your vantage6 node instances.</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="ex">Options:</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="ex">--help</span>  Show this message and exit.</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="ex">Commands:</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="ex">attach</span>              Show the node logs in the current console.</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  <span class="ex">clean</span>               Erase temporary Docker volumes.</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  <span class="ex">create-private-key</span>  Create and upload a new private key</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>  <span class="ex">files</span>               Prints the location of important node files.</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>  <span class="ex">list</span>                Lists all node configurations.</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>  <span class="ex">new</span>                 Create a new node configuration.</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>  <span class="ex">remove</span>              Delete a node permanently.</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>  <span class="ex">set-api-key</span>         Put a new API key into the node configuration file</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>  <span class="ex">start</span>               Start the node.</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>  <span class="ex">stop</span>                Stop one or all running nodes.</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>  <span class="ex">version</span>             Returns current version of a vantage6 node.</span></code></pre>
</div>
<p>For example, to view the list of available nodes, you can run the
command <code>v6 node list</code>.</p>
<div class="section level3">
<h3 id="view-the-list-of-nodes">View the list of nodes<a class="anchor" aria-label="anchor" href="#view-the-list-of-nodes"></a>
</h3>
<p>You can use the <code>v6 node list</code> command to see the list of
nodes:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">v6</span> node list</span></code></pre>
</div>
<p>If it print out a long error message, it means the Docker engine is
not running:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">Cannot</span> reach the Docker engine! Please make sure Docker is running.</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="ex">Error</span> while fetching server API version: 502 Server Error for http+docker://localhost/version: Bad Gateway</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="ex">Traceback</span> <span class="er">(</span><span class="ex">most</span> recent call last<span class="kw">)</span><span class="bu">:</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="ex">...</span></span></code></pre>
</div>
<p>⚠️ Please make sure Docker is running when you’re using the
<code>v6 node</code> commands.</p>
<div id="start-docker-engine" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="start-docker-engine" class="callout-inner">
<h3 class="callout-title">Start Docker engine</h3>
<div class="callout-content">
<ul>
<li>For Windows and MacOS, open Docker Desktop to start the Docker
engine.</li>
<li>For Linux, Docker engine usually starts automatically when you
login. Otherwise, use the commmand
<code>sudo systemctl start docker</code> to start the Docker
engine.</li>
</ul>
</div>
</div>
</div>
<p>If the Docker engine is running, you will see the following
message:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">Name</span>                     Status          System/User</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="ex">-----------------------------------------------------</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="ex">-----------------------------------------------------</span></span></code></pre>
</div>
<p>You don’t see any nodes in the list because you haven’t created any
nodes yet. Next, we will create a new node configuration.</p>
</div>
</section><section><h2 class="section-heading" id="configure-a-new-node">Configure a new node<a class="anchor" aria-label="anchor" href="#configure-a-new-node"></a>
</h2>
<hr class="half-width">
<p>We will now create a new node configuration using the
<code>v6 node new</code> command for the collaboration we created in <a href="./chap4_manage_via_ui.html">Chapter 4</a>. This process will
create a configuration <code>yaml</code> file that the vantage6 node
requires to run.</p>
<div class="section level3">
<h3 id="prepare-the-api-key-and-data">Prepare the API key and data<a class="anchor" aria-label="anchor" href="#prepare-the-api-key-and-data"></a>
</h3>
<p>Make sure you have the API key downloaded from the vantage6 UI in <a href="./chap4_manage_via_ui.html#create-a-new-collaboration">Episode
4</a>. If you haven’t done so or lost the API key, you can reset the API
key for the node in the vantage6 UI, check the <a href="#reset-api-key-for-a-node-via-the-vantage6-ui">Reset API key for a
node via the vantage6 UI</a> section.</p>

<p>Go back to the terminal and go to a directory you want to work
in:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="bu">cd</span>  path/to/your/directory</span></code></pre>
</div>
<p>Open the jupyter lab in the terminal:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">jupyter</span> lab</span></code></pre>
</div>
<p>In the Jupyter Lab, create a new csv data file
<code>data_node1.csv</code> with the following content:</p>
<pre class="csv"><code><span><span class="va">age</span></span>
<span><span class="fl">1</span></span>
<span><span class="fl">1</span></span>
<span><span class="fl">1</span></span></code></pre>

<p>Let’s run the command:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">v6</span> node new</span></code></pre>
</div>
<p>The command will show a wizard to guide you through the configuration
process in a step-by-step manner:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">?</span> Please enter a configuration-name: node1</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="ex">?</span> Enter given api-key: <span class="pp">***</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="ex">?</span> The base-URL of the server: https://server.workshop.vantage6.ai</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="ex">?</span> Enter port to which the server listens: 443</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="ex">?</span> Path of the api: /api</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="ex">?</span> Task directory path: <span class="pp">***</span>/vantage6/node/node1</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="ex">?</span> Do you want to add a database<span class="pp">?</span> Yes</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="ex">?</span> Enter unique label for the database: default</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="ex">?</span> Database URI: <span class="pp">***</span>/data_node1.csv</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="ex">?</span> Database type: csv</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="ex">?</span> Do you want to add a database<span class="pp">?</span> No</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="ex">?</span> Do you want to connect to a VPN server<span class="pp">?</span> No</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="ex">?</span> Do you want to add limit the algorithms allowed to run on your node<span class="pp">?</span> This should always be done for production scenarios. No</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="ex">?</span> Which level of logging would you like<span class="pp">?</span> DEBUG</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="ex">?</span> Encryption is disabled for this collaboration. Accept<span class="pp">?</span> Yes</span></code></pre>
</div>
<p>It is important to note the meaning of following configuration
parameters:</p>
<ul>
<li>The <code>api-key</code> is the API key that you downloaded from
vantage6 UI in <a href="./chap4_manage_via_ui.html">Chapter 4</a>. It is
used to authenticate the node at the server.</li>
<li>The <code>base-URL of the server</code> is the URL of the vantage6
server. If you are running the server on your local machine using
Docker, the URL has to be set to <code>http://localhost</code>
</li>
<li>The <code>port to which the server listens</code> is the port number
of the server. Check with the server administrator to get the correct
port number.</li>
<li>The <code>path of the api</code> is the path of the API of the
server. By default it is <code>/api</code>.</li>
<li>The <code>database URI</code> is the path of the database file
containing the sensitive data. You can add multiple databases by
repeating the process. The database type can be ‘csv’, ‘parquet’, ‘sql’,
‘sparql’, ‘excel’ or ‘omop’.</li>
<li>The <code>unique label for the database</code> is the name of the
database. It must be unique. It’s used when you want to refer to the
database in the algorithms.</li>
<li>The <code>VPN server</code> is used to connect the node to a VPN
server. A VPN connection allows nodes to communicate directly with one
another, which is useful when some algorithms require direct or a lot of
communication between nodes. For more information, see the <a href="https://docs.vantage6.ai/en/main/features/inter-component/vpn.html" class="external-link">vantage6
documentation</a>.</li>
</ul>
<p>To see all configuration options, please check <a href="https://docs.vantage6.ai/en/main/node/configure.html#all-configuration-options" class="external-link uri">https://docs.vantage6.ai/en/main/node/configure.html#all-configuration-options</a>.</p>
<p>When you finish the configuration, you will see the following
message:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">[info</span> ] <span class="at">-</span> New configuration created: <span class="pp">***</span>/vantage6/node/node1.yaml</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="ex">[info</span> ] <span class="at">-</span> You can start the node by running v6 node start</span></code></pre>
</div>
<p>It means that the node configuration file is created successfully,
and it also gives the path of the configuration file.</p>
</div>
<div class="section level3">
<h3 id="where-is-the-node-configuration-file">Where is the node configuration file?<a class="anchor" aria-label="anchor" href="#where-is-the-node-configuration-file"></a>
</h3>
<p>You can always use the <code>v6 node files</code> command to check
the location of the node configuration file:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">v6</span> node files</span></code></pre>
</div>
<p>It will ask you which node you want to see. You can choose the one
you just created:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="ex">?</span> Select the configuration you want to use: <span class="er">(</span><span class="ex">Use</span> arrow keys<span class="kw">)</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a> <span class="ex">»</span> node1</span></code></pre>
</div>
<p>In the printed message, you will see not only the path of the
configuration file is printed out, but also the locations of the log
file, the data folders and the database files are shown.</p>
<div id="challenge-1-create-a-new-node-configuration" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1-create-a-new-node-configuration" class="callout-inner">
<h3 class="callout-title">Challenge 1: Create a new node configuration</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Create a new node configuration <code>node2</code> using the
<code>v6 node new</code> command for another organization in the
collaboration you created in <a href="./chap4_manage_via_ui.html">Episode 4</a>:
<ul>
<li>add a new database in the format of <code>csv</code> with only one
column named <code>age</code>, you need to make up the data.</li>
</ul>
</li>
<li>Find the path to the configuration file using the
<code>v6 node files</code> command. Open the configuration file with a
text editor and check the configuration options. Are they correct?</li>
<li>Open your configuration file, do the following:
<ul>
<li>add another database in the format of <code>excel</code> with only
one column named <code>age</code>, you need to make up the data.</li>
</ul>
</li>
</ol>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="start-a-node">Start a node<a class="anchor" aria-label="anchor" href="#start-a-node"></a>
</h2>
<hr class="half-width">
<p>Before starting a vantage6 node, you need to make sure the vantage6
server and Docker are running.</p>
<p>To start a node, you can run the command
<code>v6 node start</code>:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="ex">v6</span> node start</span></code></pre>
</div>
<p>It will ask you which node you want to start. You can choose the one
you just created:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="ex">[info</span> ] <span class="at">-</span> Starting node...</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="ex">[info</span> ] <span class="at">-</span> Finding Docker daemon</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="ex">?</span> Select the configuration you want to use: <span class="er">(</span><span class="ex">Use</span> arrow keys<span class="kw">)</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a> <span class="ex">»</span> node1</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>   <span class="ex">node2</span></span></code></pre>
</div>
<p>then it will start the node and print out the following messages:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="ex">?</span> Select the configuration you want to use: node1</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="ex">[info</span> ] <span class="at">-</span> Starting node...</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="ex">[info</span> ] <span class="at">-</span> Finding Docker daemon</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="ex">[info</span> ] <span class="at">-</span> Checking that data and log dirs exist</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="ex">[info</span> ] <span class="at">-</span> Connecting to server at <span class="st">'https://server.workshop.vantage6.ai:443/api'</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="ex">[info</span> ] <span class="at">-</span> Pulling latest node image <span class="st">'harbor2.vantage6.ai/infrastructure/node:4.7'</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="ex">[info</span> ] <span class="at">-</span> Creating file <span class="kw">&amp;</span> <span class="ex">folder</span> mounts</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="ex">[warn</span> ] <span class="at">-</span> private key file provided <span class="pp">***</span>/vantage6/node/node1/private_key.pem, but does not exists</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="ex">[info</span> ] <span class="at">-</span> Setting up databases</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="ex">[info</span> ] <span class="at">-</span>   Processing csv database default:<span class="pp">***</span>/data_node1.csv</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="ex">[debug]</span> <span class="at">-</span>   <span class="at">-</span> file-based database added</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="ex">[info</span> ] <span class="at">-</span> Running Docker container</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="ex">[info</span> ] <span class="at">-</span> Node container was started!</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="ex">[info</span> ] <span class="at">-</span> Please check the node logs to see if the node successfully connects to the server.</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="ex">[info</span> ] <span class="at">-</span> To see the logs, run: v6 node attach <span class="at">--name</span> node1</span></code></pre>
</div>
<p>Now the node container is running, but it does not mean the node is
connected to the server. You need to check the logs to see if the node
successfully connects to the server.</p>
</section><section><h2 class="section-heading" id="watch-the-logs">Watch the logs<a class="anchor" aria-label="anchor" href="#watch-the-logs"></a>
</h2>
<hr class="half-width">
<p>You can show the logs in the current console by running the
command:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="ex">v6</span> node attach <span class="at">--name</span> node1</span></code></pre>
</div>
<p>then it will print out the logs of the node in the console:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> <span class="at">---------------------------------------------</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>  Welcome to</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>                   _                     __</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>                  <span class="kw">|</span> <span class="kw">|</span>                   <span class="ex">/</span> /</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> __   ____ _ _ __ <span class="kw">|</span> <span class="kw">|</span><span class="ex">_</span> __ _  __ _  ___ / /_</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> <span class="dt">\ \ </span>/ / _<span class="kw">`</span> <span class="kw">|</span> <span class="st">'_ \| __/ _` |/ _` |/ _ \ '</span><span class="ex">_</span> <span class="dt">\</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>2024-09-23 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>  <span class="dt">\ </span>V / <span class="er">(</span><span class="ex">_</span><span class="kw">|</span> <span class="kw">|</span> <span class="kw">|</span> <span class="kw">|</span> <span class="kw">|</span> <span class="kw">||</span> <span class="kw">(</span><span class="ex">_</span><span class="kw">|</span> <span class="kw">|</span> <span class="kw">(</span><span class="ex">_</span><span class="kw">|</span> <span class="kw">|</span>  <span class="ex">__/</span> <span class="er">(</span><span class="ex">_</span><span class="kw">)</span> <span class="kw">|</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>   <span class="dt">\_</span>/ <span class="dt">\_</span>_,_<span class="kw">|</span><span class="ex">_</span><span class="kw">|</span> <span class="kw">|</span><span class="ex">_</span><span class="kw">|</span><span class="ex">\__\__,_</span><span class="kw">|</span><span class="ex">\__,</span> <span class="kw">|</span><span class="ex">\___</span><span class="kw">|</span><span class="ex">\___/</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>                             __/ <span class="kw">|</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>                            <span class="kw">|</span><span class="ex">___/</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>  <span class="at">--</span><span class="op">&gt;</span> Join us on Discord! https://discord.gg/rwRvwyK</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>  <span class="at">--</span><span class="op">&gt;</span> Docs: https://docs.vantage6.ai</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>  <span class="at">--</span><span class="op">&gt;</span> Blog: https://vantage6.ai</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> <span class="at">------------------------------------------------------------</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> Cite us!</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> If you publish your findings obtained using vantage6,</span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> please cite the proper sources as mentioned in:</span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> https://vantage6.ai/vantage6/references</span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> <span class="at">------------------------------------------------------------</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> Started application vantage6</span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> Current working directory is <span class="st">'/'</span></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> Successfully loaded configuration from <span class="st">'/mnt/config/node1.yaml'</span></span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> Logging to <span class="st">'/mnt/log/node_user.log'</span></span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> Common package version <span class="st">'4.7.1'</span></span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> vantage6 version <span class="st">'4.7.1'</span></span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> Node package version <span class="st">'4.7.1'</span></span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> node           <span class="at">-</span> INFO     <span class="at">-</span> Connecting server: https://server.workshop.vantage6.ai:443/api</span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> node           <span class="at">-</span> DEBUG    <span class="at">-</span> Authenticating</span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:09:59 <span class="at">-</span> common         <span class="at">-</span> DEBUG    <span class="at">-</span> Authenticating node...</span>
<span id="cb21-31"><a href="#cb21-31" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:03 <span class="at">-</span> common         <span class="at">-</span> INFO     <span class="at">-</span> Successfully authenticated</span>
<span id="cb21-32"><a href="#cb21-32" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:03 <span class="at">-</span> common         <span class="at">-</span> DEBUG    <span class="at">-</span> Making request: GET <span class="kw">|</span> <span class="ex">https://server.workshop.vantage6.ai:443/api/node/268</span> <span class="kw">|</span> <span class="ex">None</span></span>
<span id="cb21-33"><a href="#cb21-33" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:04 <span class="at">-</span> common         <span class="at">-</span> DEBUG    <span class="at">-</span> Making request: GET <span class="kw">|</span> <span class="ex">https://server.workshop.vantage6.ai:443/api/organization/170</span> <span class="kw">|</span> <span class="ex">None</span></span>
<span id="cb21-34"><a href="#cb21-34" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:05 <span class="at">-</span> node           <span class="at">-</span> INFO     <span class="at">-</span> Node name: eScience-UvA <span class="at">-</span> eScience</span>
<span id="cb21-35"><a href="#cb21-35" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:05 <span class="at">-</span> common         <span class="at">-</span> DEBUG    <span class="at">-</span> Making request: GET <span class="kw">|</span> <span class="ex">https://server.workshop.vantage6.ai:443/api/collaboration/93</span> <span class="kw">|</span> <span class="ex">None</span></span>
<span id="cb21-36"><a href="#cb21-36" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:05 <span class="at">-</span> node           <span class="at">-</span> WARNING  <span class="at">-</span> Disabling encryption!</span>
<span id="cb21-37"><a href="#cb21-37" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:05 <span class="at">-</span> node           <span class="at">-</span> INFO     <span class="at">-</span> Setting up proxy server</span>
<span id="cb21-38"><a href="#cb21-38" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:05 <span class="at">-</span> node           <span class="at">-</span> INFO     <span class="at">-</span> Starting proxyserver at <span class="st">'proxyserver:80'</span></span>
<span id="cb21-39"><a href="#cb21-39" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:05 <span class="at">-</span> node           <span class="at">-</span> INFO     <span class="at">-</span> Setting up VPN client container</span>
<span id="cb21-40"><a href="#cb21-40" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:05 <span class="at">-</span> vpn_manager    <span class="at">-</span> INFO     <span class="at">-</span> Updating VPN images...</span>
<span id="cb21-41"><a href="#cb21-41" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:05 <span class="at">-</span> vpn_manager    <span class="at">-</span> DEBUG    <span class="at">-</span> Pulling Alpine image</span>
<span id="cb21-42"><a href="#cb21-42" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> addons         <span class="at">-</span> DEBUG    <span class="at">-</span> Succeeded to pull image harbor2.vantage6.ai/infrastructure/alpine:4.7</span>
<span id="cb21-43"><a href="#cb21-43" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> vpn_manager    <span class="at">-</span> DEBUG    <span class="at">-</span> Pulling VPN client image</span>
<span id="cb21-44"><a href="#cb21-44" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> addons         <span class="at">-</span> DEBUG    <span class="at">-</span> Succeeded to pull image harbor2.vantage6.ai/infrastructure/vpn-client:4.7</span>
<span id="cb21-45"><a href="#cb21-45" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> vpn_manager    <span class="at">-</span> DEBUG    <span class="at">-</span> Pulling network config image</span>
<span id="cb21-46"><a href="#cb21-46" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> addons         <span class="at">-</span> DEBUG    <span class="at">-</span> Succeeded to pull image harbor2.vantage6.ai/infrastructure/vpn-configurator:4.7</span>
<span id="cb21-47"><a href="#cb21-47" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> vpn_manager    <span class="at">-</span> INFO     <span class="at">-</span> Done updating VPN images</span>
<span id="cb21-48"><a href="#cb21-48" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> vpn_manager    <span class="at">-</span> DEBUG    <span class="at">-</span> Used VPN images:</span>
<span id="cb21-49"><a href="#cb21-49" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> vpn_manager    <span class="at">-</span> DEBUG    <span class="at">-</span>   Alpine: harbor2.vantage6.ai/infrastructure/alpine:4.7</span>
<span id="cb21-50"><a href="#cb21-50" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> vpn_manager    <span class="at">-</span> DEBUG    <span class="at">-</span>   Client: harbor2.vantage6.ai/infrastructure/vpn-client:4.7</span>
<span id="cb21-51"><a href="#cb21-51" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> vpn_manager    <span class="at">-</span> DEBUG    <span class="at">-</span>   Config: harbor2.vantage6.ai/infrastructure/vpn-configurator:4.7</span>
<span id="cb21-52"><a href="#cb21-52" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> node           <span class="at">-</span> WARNING  <span class="at">-</span> VPN subnet is not defined! VPN disabled.</span>
<span id="cb21-53"><a href="#cb21-53" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> node           <span class="at">-</span> INFO     <span class="at">-</span> No SSH tunnels configured</span>
<span id="cb21-54"><a href="#cb21-54" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> node           <span class="at">-</span> INFO     <span class="at">-</span> No squid proxy configured</span>
<span id="cb21-55"><a href="#cb21-55" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> node           <span class="at">-</span> DEBUG    <span class="at">-</span> Setting up the docker manager</span>
<span id="cb21-56"><a href="#cb21-56" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> docker_manager <span class="at">-</span> DEBUG    <span class="at">-</span> Initializing DockerManager</span>
<span id="cb21-57"><a href="#cb21-57" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> docker_manager <span class="at">-</span> WARNING  <span class="at">-</span> No policies on allowed algorithms have been set for this node!</span>
<span id="cb21-58"><a href="#cb21-58" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> docker_manager <span class="at">-</span> WARNING  <span class="at">-</span> This means that all algorithms are allowed to run on this node.</span>
<span id="cb21-59"><a href="#cb21-59" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> docker_manager <span class="at">-</span> INFO     <span class="at">-</span> Copying /mnt/default.csv to /mnt/data</span>
<span id="cb21-60"><a href="#cb21-60" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> docker_manager <span class="at">-</span> INFO     <span class="at">-</span> Copying /mnt/age.csv to /mnt/data</span>
<span id="cb21-61"><a href="#cb21-61" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> docker_manager <span class="at">-</span> DEBUG    <span class="at">-</span> Databases: {<span class="st">'default'</span>: {<span class="st">'uri'</span>: PosixPath<span class="er">(</span><span class="st">'/mnt/data/default.csv'</span><span class="kw">)</span><span class="ex">,</span> <span class="st">'is_file'</span>: True, <span class="st">'type'</span>: <span class="st">'csv'</span>, <span class="st">'env'</span>: {}}, <span class="st">'age'</span>: {<span class="st">'uri'</span>: PosixPath<span class="er">(</span><span class="st">'/mnt/data/age.csv'</span><span class="kw">)</span><span class="ex">,</span> <span class="st">'is_file'</span>: True, <span class="st">'type'</span>: <span class="st">'csv'</span>, <span class="st">'env'</span>: {}}}</span>
<span id="cb21-62"><a href="#cb21-62" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> node           <span class="at">-</span> DEBUG    <span class="at">-</span> Creating websocket connection with the server</span>
<span id="cb21-63"><a href="#cb21-63" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> node           <span class="at">-</span> INFO     <span class="at">-</span> Connected to host=https://server.workshop.vantage6.ai on port=443</span>
<span id="cb21-64"><a href="#cb21-64" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> node           <span class="at">-</span> DEBUG    <span class="at">-</span> Starting thread to ping the server to notify this node is online.</span>
<span id="cb21-65"><a href="#cb21-65" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> network_man..  <span class="at">-</span> DEBUG    <span class="at">-</span> Connecting vantage6-node1-user to network <span class="st">'vantage6-node1-user-net'</span></span>
<span id="cb21-66"><a href="#cb21-66" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> node           <span class="at">-</span> DEBUG    <span class="at">-</span> Start thread for sending messages <span class="er">(</span><span class="ex">results</span><span class="kw">)</span></span>
<span id="cb21-67"><a href="#cb21-67" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> node           <span class="at">-</span> DEBUG    <span class="at">-</span> Waiting for results to send to the server</span>
<span id="cb21-68"><a href="#cb21-68" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> node           <span class="at">-</span> DEBUG    <span class="at">-</span> Starting thread for incoming messages <span class="er">(</span><span class="ex">tasks</span><span class="kw">)</span></span>
<span id="cb21-69"><a href="#cb21-69" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> node           <span class="at">-</span> DEBUG    <span class="at">-</span> Listening for incoming messages</span>
<span id="cb21-70"><a href="#cb21-70" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> node           <span class="at">-</span> INFO     <span class="at">-</span> Init complete</span>
<span id="cb21-71"><a href="#cb21-71" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:06 <span class="at">-</span> node           <span class="at">-</span> INFO     <span class="at">-</span> Waiting for new tasks....</span>
<span id="cb21-72"><a href="#cb21-72" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:07 <span class="at">-</span> socket         <span class="at">-</span> INFO     <span class="at">-</span> Websocket connection established</span>
<span id="cb21-73"><a href="#cb21-73" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:07 <span class="at">-</span> socket         <span class="at">-</span> INFO     <span class="at">-</span> <span class="er">(</span><span class="ex">Re</span><span class="kw">)</span><span class="ex">Connected</span> to the /tasks namespace</span>
<span id="cb21-74"><a href="#cb21-74" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:07 <span class="at">-</span> common         <span class="at">-</span> DEBUG    <span class="at">-</span> Making request: GET <span class="kw">|</span> <span class="ex">https://server.workshop.vantage6.ai:443/api/run</span> <span class="kw">|</span> <span class="ex">{</span><span class="st">'state'</span><span class="ex">:</span> <span class="st">'open'</span>, <span class="st">'node_id'</span>: 268, <span class="st">'include'</span>: <span class="st">'task'</span>}</span>
<span id="cb21-75"><a href="#cb21-75" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:07 <span class="at">-</span> socket         <span class="at">-</span> INFO     <span class="at">-</span> Node <span class="op">&lt;</span>eScience-UvA <span class="at">-</span> eScience<span class="op">&gt;</span> joined room <span class="op">&lt;</span>collaboration_93<span class="op">&gt;</span></span>
<span id="cb21-76"><a href="#cb21-76" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:07 <span class="at">-</span> socket         <span class="at">-</span> INFO     <span class="at">-</span> Node <span class="op">&lt;</span>eScience-UvA <span class="at">-</span> eScience<span class="op">&gt;</span> joined room <span class="op">&lt;</span>collaboration_93_organization_170<span class="op">&gt;</span></span>
<span id="cb21-77"><a href="#cb21-77" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:08 <span class="at">-</span> node           <span class="at">-</span> DEBUG    <span class="at">-</span> task_results: []</span>
<span id="cb21-78"><a href="#cb21-78" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:08 <span class="at">-</span> node           <span class="at">-</span> INFO     <span class="at">-</span> Received 0 tasks</span>
<span id="cb21-79"><a href="#cb21-79" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:08 <span class="at">-</span> socket         <span class="at">-</span> DEBUG    <span class="at">-</span> Tasks synced again with the server...</span>
<span id="cb21-80"><a href="#cb21-80" tabindex="-1"></a><span class="ex">2024-09-23</span> 09:10:08 <span class="at">-</span> node           <span class="at">-</span> DEBUG    <span class="at">-</span> Sharing node configuration: {<span class="st">'encryption'</span>: False, <span class="st">'allowed_algorithms'</span>: <span class="st">'all'</span>, <span class="st">'database_labels'</span>: [<span class="st">'default'</span>, <span class="st">'age'</span>], <span class="st">'database_types'</span>: {<span class="st">'db_type_default'</span>: <span class="st">'csv'</span>, <span class="st">'db_type_age'</span>: <span class="st">'csv'</span>}, <span class="st">'database_columns'</span>: {<span class="st">'columns_default'</span>: <span class="pp">[</span><span class="st">'age'</span><span class="pp">]</span>, <span class="st">'columns_age'</span>: <span class="pp">[</span><span class="st">'age'</span><span class="pp">]</span>}}</span></code></pre>
</div>
<p>From there, you can see the running status of the node, the
connection to the server, the databases, the websocket connection, and
the incoming tasks.</p>
<div id="challenge-2-start-a-node-and-watch-the-logs" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-start-a-node-and-watch-the-logs" class="callout-inner">
<h3 class="callout-title">Challenge 2: Start a node and watch the logs</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Start the node <code>node2</code> you created in last exercise using
the <code>v6 node start</code> command.</li>
<li>Watch the logs of the node using the
<code>v6 node attach --name node2</code> command. Observe the logs and
see if the node is connected to server successfully.</li>
<li>How do you know if the node is connected to the server without
checking the logs?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ol start="3" style="list-style-type: decimal">
<li>You can use vantage6 UI to check if a node is online or not. There
are two ways:
<ul>
<li>Click on the <code>Nodes</code> tab in the administration page, then
click on the tab of the node you want to check. You will see the node
status is <code>Online</code> if the node is connected to the server
successfully.</li>
<li>Or click on the <code>Collaborations</code> tab in the
administration page, then click on the tab of the collaboration you want
to check. You will see the Nodes section, if nodes are in green color,
it means they are online, otherwise they are in red color with a message
<code>Offline</code>.</li>
</ul>
</li>
</ol>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="stop-a-node">Stop a node<a class="anchor" aria-label="anchor" href="#stop-a-node"></a>
</h2>
<hr class="half-width">
<p>To stop a running node, you can run the command:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="ex">v6</span> node stop</span></code></pre>
</div>
<p>then it will ask you which node you want to stop:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="ex">?</span> Select the node you wish to stop: <span class="er">(</span><span class="ex">Use</span> arrow keys<span class="kw">)</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a> <span class="ex">»</span> vantage6-node1-user</span></code></pre>
</div>
<p>after you choose the node, it will print out the following
messages:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="ex">?</span> Select the node you wish to stop: vantage6-node1-user</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="ex">[info</span> ] <span class="at">-</span> Stopped the vantage6-node1-user Node.</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="update-the-api-key-of-your-node">Update the API key of your node<a class="anchor" aria-label="anchor" href="#update-the-api-key-of-your-node"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="reset-api-key-for-a-node-via-the-vantage6-ui">Reset API key for a node via the vantage6 UI<a class="anchor" aria-label="anchor" href="#reset-api-key-for-a-node-via-the-vantage6-ui"></a>
</h3>
<p>If you want to reset the API key for a node, you can do so by
following these steps:</p>
<ol style="list-style-type: decimal">
<li>Login to the vantage6 UI.</li>
<li>Click on the <code>Nodes</code> tab in the administration page.</li>
<li>Click on the tab of the node you want to reset the API key for in
the list of nodes.</li>
</ol>
<figure><img src="fig/chapter6/reset_api_key_01.png" alt="Reset API key for a node" class="figure mx-auto d-block"><div class="figcaption">Reset API key for a node</div>
</figure><ol start="4" style="list-style-type: decimal">
<li>Click on the <code>Reset API key</code> button.
<ul>
<li>You may see a dialog box asking you to download the new API
key.</li>
</ul>
</li>
</ol>
<figure><img src="fig/chapter6/reset_api_key_02.png" alt="Download new API key" class="figure mx-auto d-block"><div class="figcaption">Download new API key</div>
</figure><p>You will see a message:</p>
<blockquote>
<p>API key download</p>
<p>Your API key has been reset. Please read your new key in the file
that has been downloaded.</p>
</blockquote>
<p>You can open the downloaded text file to copy the new API key. Next,
you’ll use it to update your node configuration.</p>
</div>
<div class="section level3">
<h3 id="update-api-key-in-the-node-configuration-file">Update API key in the node configuration file<a class="anchor" aria-label="anchor" href="#update-api-key-in-the-node-configuration-file"></a>
</h3>
<p>You can use v6 CLI to update the API key of a node. For that, you can
run the command:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="ex">v6</span> node set-api-key</span></code></pre>
</div>
<p>then it will ask you which node you want to update the API key
of:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="ex">?</span> Select the configuration you want to use: <span class="er">(</span><span class="ex">Use</span> arrow keys<span class="kw">)</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a> <span class="ex">»</span> node1</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>   <span class="ex">node2</span></span></code></pre>
</div>
<p>after you choose the node, it will ask you to enter the new API key,
then you can paste the new API key you just copied from the downloaded
file:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="ex">?</span> Select the configuration you want to use: node1</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="ex">?</span> Please enter your new API key: the-new-api-key</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> <span class="at">---------------------------------------------</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>  Welcome to</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>                   _                     __</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>                  <span class="kw">|</span> <span class="kw">|</span>                   <span class="ex">/</span> /</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> __   ____ _ _ __ <span class="kw">|</span> <span class="kw">|</span><span class="ex">_</span> __ _  __ _  ___ / /_</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> <span class="dt">\ \ </span>/ / _<span class="kw">`</span> <span class="kw">|</span> <span class="st">'_ \| __/ _` |/ _` |/ _ \ '</span><span class="ex">_</span> <span class="dt">\</span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>2024-09-23 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>  <span class="dt">\ </span>V / <span class="er">(</span><span class="ex">_</span><span class="kw">|</span> <span class="kw">|</span> <span class="kw">|</span> <span class="kw">|</span> <span class="kw">|</span> <span class="kw">||</span> <span class="kw">(</span><span class="ex">_</span><span class="kw">|</span> <span class="kw">|</span> <span class="kw">(</span><span class="ex">_</span><span class="kw">|</span> <span class="kw">|</span>  <span class="ex">__/</span> <span class="er">(</span><span class="ex">_</span><span class="kw">)</span> <span class="kw">|</span></span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>   <span class="dt">\_</span>/ <span class="dt">\_</span>_,_<span class="kw">|</span><span class="ex">_</span><span class="kw">|</span> <span class="kw">|</span><span class="ex">_</span><span class="kw">|</span><span class="ex">\__\__,_</span><span class="kw">|</span><span class="ex">\__,</span> <span class="kw">|</span><span class="ex">\___</span><span class="kw">|</span><span class="ex">\___/</span></span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>                             __/ <span class="kw">|</span></span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>                            <span class="kw">|</span><span class="ex">___/</span></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span></span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>  <span class="at">--</span><span class="op">&gt;</span> Join us on Discord! https://discord.gg/rwRvwyK</span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>  <span class="at">--</span><span class="op">&gt;</span> Docs: https://docs.vantage6.ai</span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span>  <span class="at">--</span><span class="op">&gt;</span> Blog: https://vantage6.ai</span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> <span class="at">------------------------------------------------------------</span></span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> Cite us!</span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> If you publish your findings obtained using vantage6,</span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> please cite the proper sources as mentioned in:</span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> https://vantage6.ai/vantage6/references</span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> <span class="at">------------------------------------------------------------</span></span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> Started application vantage6</span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> Current working directory is <span class="st">'***'</span></span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> Successfully loaded configuration from <span class="st">'***/vantage6/node/node1.yaml'</span></span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> Logging to <span class="st">'***/vantage6/node/node1/node_user.log'</span></span>
<span id="cb27-27"><a href="#cb27-27" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> Common package version <span class="st">'4.7.1'</span></span>
<span id="cb27-28"><a href="#cb27-28" tabindex="-1"></a><span class="ex">2024-09-23</span> 11:30:33 <span class="at">-</span> context        <span class="at">-</span> INFO     <span class="at">-</span> vantage6 version <span class="st">'4.7.1'</span></span>
<span id="cb27-29"><a href="#cb27-29" tabindex="-1"></a><span class="ex">[info</span> ] <span class="at">-</span> Your new API key has been uploaded to the config file <span class="pp">***</span>/vantage6/node/node1.yaml.</span></code></pre>
</div>
<p>When you finish the process, the node configuration file will be
updated with the new API key.</p>
<p>To make the new API key effective, you need to restart the node by
running the command <code>v6 node stop</code> and then
<code>v6 node start</code>.</p>
<div id="challenge-3-update-the-api-key-of-a-node" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3-update-the-api-key-of-a-node" class="callout-inner">
<h3 class="callout-title">Challenge 3: Update the API key of a node</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Update the API key of the node <code>node1</code>, WITHOUT using the
<code>v6 node set-api-key</code> command.</li>
<li>How do you verify that the new API key is effective?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>We can update the API key in the configuration file:</li>
</ol>
<ul>
<li>Run the <code>v6 node files</code> command to locate the
configuration file.</li>
<li>Open the configuration file and write the new API key in the
<code>api_key</code> field.</li>
<li>Stop the node with the <code>v6 node stop</code> command.</li>
<li>Restart the node with the <code>v6 node start</code> command.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>In order to verify the effectiveness of the API key change, we can
restart the node with active logging:</li>
</ol>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="ex">v6</span> node start <span class="at">--attach</span></span></code></pre>
</div>
<p>In the log, we have to look for the node authentication message:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="ex">2024-05-30</span> 14:41:13 <span class="at">-</span> common         <span class="at">-</span> DEBUG    <span class="at">-</span> Authenticating node...</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="ex">2024-05-30</span> 14:41:13 <span class="at">-</span> common         <span class="at">-</span> INFO     <span class="at">-</span> Successfully authenticated</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="run-a-task-on-the-nodes">Run a task on the nodes<a class="anchor" aria-label="anchor" href="#run-a-task-on-the-nodes"></a>
</h2>
<hr class="half-width">
<p>Now start all your nodes and go to the vantage6 UI to create a new
task for your nodes.</p>
<div id="challenge-4-run-a-task-on-the-nodes" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-4-run-a-task-on-the-nodes" class="callout-inner">
<h3 class="callout-title">Challenge 4: Run a task on the nodes</h3>
<div class="callout-content">
<p>Start all your nodes <code>node1</code> and <code>node2</code> and go
to the vantage6 UI to run a new task for your nodes using the
<code>Average</code> algorithm for the <code>age</code> data.</p>
<ol style="list-style-type: decimal">
<li>Run a centralized task on the nodes.</li>
<li>Run a federated task on the nodes.</li>
</ol>
</div>
</div>
</div>
<div id="v6-server-and-v6-algorithm-store-commands" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="v6-server-and-v6-algorithm-store-commands" class="callout-inner">
<h3 class="callout-title">
<code>v6 server</code> and
<code>v6 algorithm-store</code> commands</h3>
<div class="callout-content">
<p>In this lesson we have focussed on the CLI commands to manage the
vantage6 node. Note that the commands to manage the server
(<code>v6 server</code>) and the algorithm store
(<code>v6 algorithm-store</code>) are similar to the ones presented for
the node. However, they are less commonly used for production scenarios
where administrators often prefer to deploy via <code>nginx</code> or
<code>docker compose</code>. We will not cover those commands in this
course.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Install the vantage6 CLI package by running
<code>pip install vantage6</code>.</li>
<li>Use the <code>v6 --help</code> command to see the available commands
of the vantage6 CLI.</li>
<li>Use the <code>v6 node</code> command to manage the vantage6 node
instances.</li>
<li>Use the <code>v6 node new</code> command to create a new node
configuration.</li>
<li>Use the <code>v6 node start</code> command to start a node.</li>
<li>Use the <code>v6 node attach --name xxx</code> command to show the
logs of the node <code>xxx</code>.</li>
<li>Use the <code>v6 node stop</code> command to stop a node.</li>
<li>Use the <code>v6 node set-api-key</code> command to set a new API
key of a node.</li>
<li>Use the <code>v6 node files</code> command to check the location of
the node configuration file.</li>
<li>The commands similar to the ones presented for the node are also
available for <code>v6 server</code> and
<code>v6 algorithm-store</code>.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-chap7_algo_dev"><p>Content from <a href="chap7_algo_dev.html">Algorithm development</a></p>
<hr>
<p>Last updated on 2024-10-02 |

        <a href="https://github.com/vantage6/vantage6-workshop/edit/main/episodes/chap7_algo_dev.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What do the algorithm tools in vantage6 provide?</li>
<li>How do you create a personalized boilerplate using the v6 cli?</li>
<li>What is the process for adapting the boilerplate into a simple
algorithm?</li>
<li>How can you test your algorithm using the mock client?</li>
<li>How do you build your algorithm into a docker image?</li>
<li>How do you set up a local test environment using the v6 cli
(<code>v6 dev</code>)?</li>
<li>How can you publish your algorithm in the algorithm store?</li>
<li>How can you run your algorithm?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the available algorithm tools</li>
<li>Create a personalized boilerplate using the v6 cli</li>
<li>Adapt the boilerplate into a simple algorithm</li>
<li>Test your algorithm using the mock client</li>
<li>Build your algorithm into a docker image</li>
<li>Set up a local test environment using the v6 cli
(<code>v6 dev</code>)</li>
<li>Publish your algorithm in the algorithm store</li>
<li>Run your algorithm in the UI</li>
<li>Run your algorithm with the Python client</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>The goal of this lesson is to develop a simple average algorithm, and
walk through all the steps from creating the proper code up until
running it in the User Interface and via the Python client. We will
start by explaining how the algorithm interacts with the vantage6
infrastructure. Then, you will start to build, test and run your own
algorithm.</p>
</section><section><h2 class="section-heading" id="algorithm-tools">Algorithm tools<a class="anchor" aria-label="anchor" href="#algorithm-tools"></a>
</h2>
<hr class="half-width">
<p>The vantage6 infrastructure provides a set of tools to help you
develop your algorithm. You have probably already done this in the <a href="index.html#setup">setup</a> of the workshop, but you can install the
algorithm tools with:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">pip</span> install vantage6-algorithm-tools</span></code></pre>
</div>
<p>The following sections handle the most important parts of the
algorithm tools.</p>
<div class="section level3">
<h3 id="algorithm-client">Algorithm client<a class="anchor" aria-label="anchor" href="#algorithm-client"></a>
</h3>
<p>The algorithm client provides functionality that is similar to the
Python client, but can only do a subset of the operations, because the
algorithm is not allowed to execute operations like creating a
collaboration or deleting a user. This client can be used to interact
with the server, e.g. to create a subtask, retrieve results, or get the
organizations participating in the collaboration.</p>
<p>A typical example of how to use the algorithm client is as
follows:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="im">from</span> vantage6.algorithm.client <span class="im">import</span> AlgorithmClient</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="im">from</span> vantage6.algorithm.tools.decorators <span class="im">import</span> algorithm_client</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># Load the algorithm client to interact with the server</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="at">@algorithm_client</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="kw">def</span> central_function(client: AlgorithmClient):</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    organizations_in_collaboration <span class="op">=</span> client.organization.<span class="bu">list</span>()</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    task <span class="op">=</span> client.task.create(</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>        input_<span class="op">=**</span>my_input,</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>        organizations<span class="op">=</span>organizations_in_collaboration,</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>        name<span class="op">=</span><span class="st">"Subtask name"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>    )</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>    results <span class="op">=</span> client.wait_for_results(task.get(<span class="st">'id'</span>))</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>    <span class="cf">return</span> aggregate_results(results)</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="data-loading">Data loading<a class="anchor" aria-label="anchor" href="#data-loading"></a>
</h3>
<p>The algorithm tools provide a way to load the data from the node and
provide it to the algorithm as a Pandas dataframe.</p>
<p>Example:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="im">from</span> vantage6.algorithm.tools.decorators <span class="im">import</span> data</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># Load two data sources from the node</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="at">@data</span>(<span class="dv">2</span>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="kw">def</span> partial_function(df1: pd.DataFrame, df2: pd.DataFrame, column: <span class="bu">str</span>):</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>        <span class="st">"sum1"</span>: df1[column].<span class="bu">sum</span>(),</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>        <span class="st">"sum2"</span>: df2[column].<span class="bu">sum</span>()</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    }</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="wrapping-the-algorithm-functions">Wrapping the algorithm functions<a class="anchor" aria-label="anchor" href="#wrapping-the-algorithm-functions"></a>
</h3>
<p>The algorithm client and data loading tools provide you with the
vantage6 tools in the algorithm code itself. However, the algorithm
tools also provide an interface between the algorithm and the node,
which we call the algorithm wrapper. The wrapper ensures that all the
necessary information is passed to the algorithm, and that the output is
returned to the server. Mostly this is ‘magic’ that happens in the
background. It is important to know about it though, as it can help you
understand how the algorithm interacts with the vantage6 infrastructure,
and you can use the wrapper to e.g. pass environment variables to the
algorithm.</p>
<figure><img src="fig/chapter7/algorithm_wrapper.png" alt="Algorithm wrapper" class="figure mx-auto d-block"><div class="figcaption">Algorithm wrapper</div>
</figure><p>The following items are handled by the wrapper:</p>
<ul>
<li>
<strong>Input handling</strong>: the algorithm tools read the input
from the node and provide it to the arguments of the algorithm function.
In the example above, the <code>column</code> argument is provided by
the node to the function via the algorithm tools.</li>
<li>
<strong>Environment variables</strong>: the algorithm tools get the
environment variables from the node and pass them on to the algorithm.
You can also define environment variables in the node configuration file
that are passed to the algorithm. This can e.g. be useful if you want to
pass the database connection string to the algorithm.</li>
<li>
<strong>Token</strong>: the algorithm tools ensure that the
algorithm uses the security token to be able to get the allowed
resources from the server.</li>
<li>
<strong>Data</strong>: while the actual data is handled by the
<code>@data</code> decorator, the algorithm tools provide the decorator
with environment variables so that it knows where to find the data.</li>
<li>
<strong>Output handling</strong>: the output from the algorithm
functions is written to a file that the node will send back to the
server.</li>
</ul>
<p>It is possible to write your algorithm without the algorithm tools.
If you want to write your algorithm in a different language than Python,
you cannot use the algorithm tools.</p>
<p>For more information about the algorithm tools, please check out the
relevant <a href="https://docs.vantage6.ai/en/main/algorithms/concepts.html" class="external-link">documentation</a>.</p>
<div id="challenge-1-creating-non-python-algorithms" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-creating-non-python-algorithms" class="callout-inner">
<h3 class="callout-title">Challenge 1: Creating non-Python algorithms</h3>
<div class="callout-content">
<p>You want to create a vantage6 algorithm, but Python is not your
favorite programming language. What extra work do you need to do to
create a vantage6 algorithm in a different language?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>You would need to implement parts of the wrapper and algorithm client
yourself:</p>
<ul>
<li>You should use the environment variables to load the token, input
and data</li>
<li>You should create your own HTTP requests to replace the algorithm
client</li>
<li>You should make sure the output is written to the correct place</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="create-a-simple-algorithm">Create a simple algorithm<a class="anchor" aria-label="anchor" href="#create-a-simple-algorithm"></a>
</h2>
<hr class="half-width">
<p>As discussed above, vantage6 algorithms require a certain structure
to interact properly with the vantage6 infrastructure. For example,
vantage6 requires the functions in the algorithm to be at the base level
of a Python package that is defined within the Docker image. Such
requirements can be cumbersome to get right if you have to write all the
code yourself. Fortunately, vantage6 provides tools to create a
boilerplate for you, so that you can focus on the development of your
algorithm functions rather than worry about the infrastructure.</p>
<p>To create a personalized boilerplate, use the vantage6 CLI. You
should have installed the CLI in the <a href="index.html#setup">workshop
setup</a>. Be sure to activate the <a href="index.html#python-environment-and-python-packages">conda
environment</a> you created for the workshop.</p>
<p>You can create a new algorithm boilerplate repository with:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">v6</span> algorithm create</span></code></pre>
</div>
<p>The first step in creating your own algorithm is to enter the command
<code>v6 algorithm create</code> and type along to create your own
personalized boilerplate:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="op">&gt;</span> v6 <span class="ex">algorithm</span> create</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="ex">?</span> Name of your new algorithm: my-vantage6-average</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="ex">?</span> Directory to put the algorithm in: <span class="dt">\s</span>ome<span class="dt">\l</span>ocal<span class="dt">\d</span>irectory<span class="dt">\f</span>or<span class="dt">\a</span>lgorithms<span class="dt">\m</span>y-vantage6-average</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="ex">Welcome</span> to the vantage6 algorithm template creator!</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="ex">You</span> will be asked a series of questions to generate the basis of your new</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="ex">vantage6</span> algorithm in Python.</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="ex">🎤</span> Please enter a short description <span class="er">(</span><span class="ex">one</span> sentence<span class="kw">)</span> <span class="ex">of</span> your algorithm.</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>   <span class="ex">My</span> very first vantage6 algorithm, computing the average of a single data column</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="ex">🎤</span> The open source license to use</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>   <span class="ex">MIT</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="ex">🎤</span> Do you want to use a central function in your algorithm<span class="pp">?</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>   <span class="ex">Yes</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="ex">🎤</span> What is the name of your central function<span class="pp">?</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>   <span class="ex">central</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="ex">🎤</span> Do you want to use a client in your central function<span class="pp">?</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>   <span class="ex">Yes</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="ex">🎤</span> Do you want to use data in your central function<span class="pp">?</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>   <span class="ex">No</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="ex">🎤</span> Add a list of arguments to the central function <span class="st">'central'</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>    <span class="kw">(</span><span class="ex">Finish</span> with <span class="st">'Alt+Enter'</span> or <span class="st">'Esc then Enter'</span><span class="kw">)</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="op">&gt;</span> <span class="bu">[</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>    <span class="st">"column"</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>  <span class="bu">]</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="ex">🎤</span> Do you want to use a partial function in your algorithm<span class="pp">?</span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>   <span class="ex">Yes</span></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a><span class="ex">🎤</span> What is the name of your partial function<span class="pp">?</span></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>   <span class="ex">partial</span></span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a><span class="ex">🎤</span> Do you want to use a client in your partial function<span class="pp">?</span></span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a>   <span class="ex">No</span></span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a><span class="ex">🎤</span> Do you want to use data in your partial function<span class="pp">?</span></span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a>   <span class="ex">Yes</span></span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a><span class="ex">🎤</span> How many databases do you want to use in your partial function<span class="pp">?</span></span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a>   <span class="ex">1</span></span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a><span class="ex">🎤</span> Add a list of arguments to the partial function <span class="st">'partial'</span></span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a>    <span class="kw">(</span><span class="ex">Finish</span> with <span class="st">'Alt+Enter'</span> or <span class="st">'Esc then Enter'</span><span class="kw">)</span></span>
<span id="cb5-39"><a href="#cb5-39" tabindex="-1"></a><span class="op">&gt;</span> <span class="bu">[</span></span>
<span id="cb5-40"><a href="#cb5-40" tabindex="-1"></a>    <span class="st">"column"</span></span>
<span id="cb5-41"><a href="#cb5-41" tabindex="-1"></a>  <span class="bu">]</span></span>
<span id="cb5-42"><a href="#cb5-42" tabindex="-1"></a><span class="ex">🎤</span> Do you want to add documentation to your algorithm<span class="pp">?</span></span>
<span id="cb5-43"><a href="#cb5-43" tabindex="-1"></a>   <span class="ex">No</span></span>
<span id="cb5-44"><a href="#cb5-44" tabindex="-1"></a><span class="ex">🎤</span> Do you want to see the advanced options<span class="pp">?</span></span>
<span id="cb5-45"><a href="#cb5-45" tabindex="-1"></a>   <span class="ex">No</span></span></code></pre>
</div>
<p>That should give you a nice head-start to develop your own
algorithm!</p>
<div id="challenge-2-learn-about-your-personalized-boilerplate" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-learn-about-your-personalized-boilerplate" class="callout-inner">
<h3 class="callout-title">Challenge 2: Learn about your personalized boilerplate</h3>
<div class="callout-content">
<p>Inspect your personalized boilerplate code. What does it contain?
Multiple answers are possible.</p>
<p>A. Templates of your algorithm functions B. Arguments of your
algorithm functions C. Scripts to test your algorithm functions D.
Checklist of what to do to complete your algorithm E. A JSON file that
helps to include the algorithm in an algorithm store</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>The answers is that it contains <em>all</em> those things. The
boilerplate was designed to be as complete as possible!</p>
<p>A. Templates of your algorithm functions: the boilerplate contains
the central and partial functions that you specified in the creation
process, in the files <code>central.py</code> and
<code>partial.py</code>, in the folder with the algorithm name you
specified in the first question. B. Arguments of your algorithm
functions: within the files specified in the previous point, you can see
that the parameters are already defined in the function signature. C.
Scripts to test your algorithm functions: the boilerplate contains a
<code>test.py</code> file in the <code>test/</code> directory. Some
details still need to be adjusted to test your algorithm - we’ll come to
that later in this lesson. D. Checklist of what to do to complete your
algorithm: the <code>README.md</code> file in the root directory of your
algorithm contains a checklist of what you need to do to complete your
algorithm. E. A JSON file that helps to include the algorithm in an
algorithm store: the boilerplate contains an
<code>algorithm_store.json</code> file that contains a JSON description
of your algorithm. This file is used to upload your algorithm to the
algorithm store.</p>
<p>Missing anything? Let us know!</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="modifying-the-boilerplate">Modifying the boilerplate<a class="anchor" aria-label="anchor" href="#modifying-the-boilerplate"></a>
</h3>
<p>If you want to modify the answers you gave in
<code>v6 algorithm create</code>, you can do so by running:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">v6</span> algorithm update <span class="at">--change-answers</span></span></code></pre>
</div>
<p>This is recommended to do whenever you want to change something like
the name of the function, as it will ensure that it will be updated in
all places it was mentioned.</p>
<p>The update command can also be used without
<code>--change-answers</code> to update your algorithm to a new version,
even after you have implemented your functions. This is helpful when
there is new functionality or changes in vantage6 that require
algorithms to update.</p>
</div>
<div class="section level3">
<h3 id="implement-the-algorithm-functions">Implement the algorithm functions<a class="anchor" aria-label="anchor" href="#implement-the-algorithm-functions"></a>
</h3>
<p>Your personalized boilerplate is now ready to be adapted into a
simple algorithm. We are now going to implement the average algorithm in
several steps. First, we will explain how this can be done, and then you
can try it yourself in a challenge.</p>
<p>First step is to implement the central and partial functions. The
easiest is to start with the partial function. Using the Pandas
dataframe that is provided by the algorithm tools, the following should
be extracted for the requested column:</p>
<ul>
<li>The number of rows that contains a number</li>
<li>The sum of all these numbers</li>
</ul>
<p>The boilerplate code for the central function already a large part of
the code that will be required to gather the results from the partial
functions. To compute the final average, we will need to:</p>
<ul>
<li>Modify how the subtasks are created - we need to provide the column
to the partial functions</li>
<li>Combine the results from the partial functions to compute the
average</li>
</ul>
<p>Remember that both functions should return the results as valid JSON
serializable objects - we recommend returning a Python dictionary.</p>
</div>
<div class="section level3">
<h3 id="test-your-algorithm-using-the-mock-client">Test your algorithm using the mock client<a class="anchor" aria-label="anchor" href="#test-your-algorithm-using-the-mock-client"></a>
</h3>
<p>As discussed before, the algorithm tools contain an algorithm client
that helps the algorithm container to communicate with the server. When
testing your algorithm, it would be cumbersome to test your algorithm in
the real infrastructure on every code change, as this requires you to
build your algorithm Docker image, ensure all nodes in your
collaboration are online, etc.</p>
<p>To facilitate the testing phase, the algorithm tools also provide an
algorithm mock client. This client can be used to test your algorithm
locally without having to start up the server and nodes. The mock client
provides the same functions as the algorithm client, but instead of
communicating with the server, it simply returns a smart mock response.
The mock client does <em>not</em> mock the output of the algorithm
functions, but actually calls them with locally defined test data. This
way, you can easily test locally if your algorithm functions give the
answer you expect without worrying about the infrastructure.</p>
<p>Your personalized template already contains a
<code>test/test.py</code> file that contains boilerplate code to test
your algorithm. You just need to make small adjustments to test your
average algorithm.</p>
<div id="challenge-3-implement-the-functions-and-test-them" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3-implement-the-functions-and-test-them" class="callout-inner">
<h3 class="callout-title">Challenge 3: Implement the functions and test them</h3>
<div class="callout-content">
<p>Implement your partial and central functions as described above.</p>
<p>Adapt and run <code>test.py</code> to test your function
implementation:</p>
<ul>
<li>In your Python environment, run <code>pip install -e .</code>. This
installs the local Python package and also the algorithm tools (which
contain the mock client).</li>
<li>Adjust <code>test.py</code> to compute the average over the
<strong>Age</strong> column. Do this both for the test of the central
and of the partial function</li>
<li>Run <code>test.py</code> to test your functions.</li>
</ul>
</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1"> Give me a hint </h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" aria-labelledby="headingHint1" data-bs-parent="#accordionHint1">
<div class="accordion-body">
<p>We provide a <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html" class="external-link">pandas
dataframe</a>. Pandas is a well-known Python library for data
manipulation and analysis. It also provides a <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sum.html#pandas.DataFrame.sum" class="external-link">sum</a>
method that can be used to calculate the sum of a column.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>You can find the solution in the <a href="https://github.com/vantage6/workshop-average-boilerplate/tree/implemented-functions" class="external-link">workshop-average-boilerplate
repository</a>. This branch contains the implementation of the average
algorithm. Below is a description of what you need to change compared to
the boilerplate you generated in Challenge 1.</p>
<p>In your central function:</p>
<ul>
<li>When creating the subtask, fill in the <code>column</code> argument
from the input parameters.</li>
<li>Aggregate the results from the partial functions to compute the
average, which may look something like this:</li>
</ul>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="kw">def</span> central_function(client: AlgorithmClient, column: <span class="bu">str</span>):</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>    ...</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>    results <span class="op">=</span> client.wait_for_results(task_id<span class="op">=</span>task.get(<span class="st">"id"</span>))</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>    info(<span class="st">"Computing global average"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>    global_sum <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>    global_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>    <span class="cf">for</span> output <span class="kw">in</span> results:</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>        global_sum <span class="op">+=</span> output[<span class="st">"sum"</span>]</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>        global_count <span class="op">+=</span> output[<span class="st">"count"</span>]</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>    <span class="co"># return the final results of the algorithm</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>    <span class="cf">return</span> {<span class="st">"average"</span>: global_sum <span class="op">/</span> global_count}</span></code></pre>
</div>
<p>In your partial function:</p>
<ul>
<li>Extract the column from the dataframe and calculate the sum and
count of the column values. The output should be a dictionary with the
keys <code>sum</code> and <code>count</code>:</li>
</ul>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="at">@data</span>(<span class="dv">1</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="kw">def</span> partial_function(df: pd.DataFrame, column: <span class="bu">str</span>) <span class="op">-&gt;</span> Any:</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>    col_data <span class="op">=</span> df[column]</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>    local_sum <span class="op">=</span> <span class="bu">float</span>(col_data.<span class="bu">sum</span>())</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>    local_count <span class="op">=</span> <span class="bu">len</span>(col_data)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>    <span class="cf">return</span> {<span class="st">"sum"</span>: local_sum, <span class="st">"count"</span>: local_count}</span></code></pre>
</div>
<p>In test.py:</p>
<ul>
<li>In the <code>client.task.create()</code> calls, replace the
<code>column</code> argument with the column you want to calculate the
average over: <code>"Age"</code>.</li>
</ul>
<p>Then, you can run <code>python test/test.py</code> and the output
should look something like:</p>
<pre><code>
[{'id': 0, 'name': 'mock-0', 'domain': 'mock-0.org', 'address1': 'mock', 'address2': 'mock', 'zipcode': 'mock', 'country': 'mock', 'public_key': 'mock', 'collaborations': '/api/collaboration?organization_id=0', 'users': '/api/user?organization_id=0', 'tasks': '/api/task?init_org_id=0', 'nodes': '/api/node?organization_id=0', 'runs': '/api/run?organization_id=0'}, {'id': 1, 'name': 'mock-1', 'domain': 'mock-1.org', 'address1': 'mock', 'address2': 'mock', 'zipcode': 'mock', 'country': 'mock', 'public_key': 'mock', 'collaborations': '/api/collaboration?organization_id=1', 'users': '/api/user?organization_id=1', 'tasks': '/api/task?init_org_id=1', 'nodes': '/api/node?organization_id=1', 'runs': '/api/run?organization_id=1'}]
info &gt; Defining input parameters
info &gt; Creating subtask for all organizations in the collaboration
info &gt; Waiting for results
info &gt; Mocking waiting for results
info &gt; Results obtained!
info &gt; Mocking waiting for results
[{'average': 34.666666666666664}]
{'id': 2, 'runs': '/api/run?task_id=2', 'results': '/api/results?task_id=2', 'status': 'completed', 'name': 'mock', 'databases': ['mock'], 'description': 'mock', 'image': 'mock_image', 'init_user': {'id': 1, 'link': '/api/user/1', 'methods': ['GET', 'DELETE', 'PATCH']}, 'init_org': {'id': 0, 'link': '/api/organization/0', 'methods': ['GET', 'PATCH']}, 'parent': None, 'collaboration': {'id': 1, 'link': '/api/collaboration/1', 'methods': ['DELETE', 'PATCH', 'GET']}, 'job_id': 1, 'children': None}
info &gt; Mocking waiting for results
[{'sum': 624.0, 'count': 18}, {'sum': 624.0, 'count': 18}]
</code></pre>
<p>Hence, the average age is 34.67!</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="build-your-algorithm-into-a-docker-image">Build your algorithm into a docker image<a class="anchor" aria-label="anchor" href="#build-your-algorithm-into-a-docker-image"></a>
</h2>
<hr class="half-width">
<p>To be able to run your algorithm in the vantage6 infrastructure, you
need to make your algorithm available online. To do so, you need access
to a Docker registry. The easiest way to do this is to use Dockerhub. To
create an account there, go <a href="https://app.docker.com/signup?" class="external-link">here</a>.</p>
<p>Your algorithm boilerplate contains a <code>Dockerfile</code> in the
root folder. Enter the following commands to build your algorithm into a
docker image. Be sure to replace <code>$myusername</code> with your
Dockerhub username.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="bu">cd</span> /go/to/directory/with/my/algorithm/and/the/dockerfile</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="ex">docker</span> login</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="ex">docker</span> build <span class="at">-t</span> <span class="va">$myusername</span>/average .</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="ex">docker</span> push <span class="va">$myusername</span>/average</span></code></pre>
</div>
<p>This uses the command <code>docker build</code> to build your
algorithm into a Docker image, and then the image is uploaded with
<code>docker push</code>.</p>
</section><section><h2 class="section-heading" id="set-up-a-local-test-environment">Set up a local test environment<a class="anchor" aria-label="anchor" href="#set-up-a-local-test-environment"></a>
</h2>
<hr class="half-width">
<p>When the algorithm image is available, it is recommended to test
locally if it also works with an actual server and nodes - not just
using the mock client. In this section, we will test your algorithm via
vantage6 on your own machine. The easiest way to set up a server and a
few nodes locally is with:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">v6</span> dev create-demo-network</span></code></pre>
</div>
<p>This command creates a vantage6 server configuration, and then
registers a collaboration with 3 organizations in it. It registers a
node for each organization and finally, it creates the vantage6 node
configuration for each node with the correct API key.</p>
<p>Each node in the <code>v6 dev</code> network has part of a dataset on
olympic medal winners in the 2016 Olympics. The dataset contains the
columns <code>Age</code>, <code>Sex</code>, <code>Height</code>,
<code>Weight</code>, <code>Country</code>, <code>Sport</code> and
<code>Medal</code>. We are mainly interested in the <code>Age</code>
column for our average computation, but of course you can also compute
the average over other columns, as long as they are numeric.</p>
<p>The other available commands are:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Start the server and nodes</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="ex">v6</span> dev start-demo-network</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co"># Stop the server and nodes</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="ex">v6</span> dev stop-demo-network</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co"># Remove the server and nodes</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="ex">v6</span> dev remove-demo-network</span></code></pre>
</div>
<p>In <a href="./chap5_python_client.html">Chapter 5</a>, you have
learned how to run an algorithm using the Python client. Now, you can
run your own algorithm using the Python client!</p>
<div id="challenge-4-test-your-algorithm-on-a-local-vantage6-network" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4-test-your-algorithm-on-a-local-vantage6-network" class="callout-inner">
<h3 class="callout-title">Challenge 4: Test your algorithm on a local vantage6 network</h3>
<div class="callout-content">
<p>Create and start a local vantage6 network with the
<code>v6 dev</code> commands. Then, run your algorithm using the Python
client. Note that the data in the <code>v6 dev</code> network is
different from the mock data you used before - however it contains the
same column “Age”.</p>
<p>If you are on Linux and are <em>not</em> using Docker Desktop, you
will need to run
<code>v6 dev create-demo-network --server-url http://172.17.0.1</code> -
this to let vantage6 know where they can reach localhost from within the
Docker container.</p>
<p>You can use the following data to login:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># login credentials</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>username <span class="op">=</span> <span class="st">"dev_admin"</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>password <span class="op">=</span> <span class="st">"password"</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co"># server details</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>server_url <span class="op">=</span> <span class="st">"http://localhost"</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>port <span class="op">=</span> <span class="dv">7601</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>api_path <span class="op">=</span> <span class="st">"/api"</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co"># task details</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>databases <span class="op">=</span> [{<span class="st">"label"</span>: <span class="st">"default"</span>}]</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>column_name <span class="op">=</span> <span class="st">"Age"</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionHint2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint2" aria-expanded="false" aria-controls="collapseHint2">
  <h4 class="accordion-header" id="headingHint2"> Give me a hint </h4>
</button>
<div id="collapseHint2" class="accordion-collapse collapse" aria-labelledby="headingHint2" data-bs-parent="#accordionHint2">
<div class="accordion-body">
<p>Use <code>help(client.task.create)</code> to see the available
arguments for the <code>create</code> method. Your command should be
similar to the command in the test script, but with the correct
collaboration/organization ID</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>After doing <code>v6 dev create-demo-network</code> and
<code>v6 dev start-demo-network</code>, you can run the following Python
script to run your algorithm on the local network. Take care to provide
the correct username, password, and image name.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="im">from</span> vantage6.client <span class="im">import</span> Client</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>client.authenticate(username, password)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>image <span class="op">=</span> <span class="st">"myusername/average"</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>task <span class="op">=</span> client.task.create(</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>    input_<span class="op">=</span>{</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>        <span class="st">"method"</span>: <span class="st">"central_function"</span>,</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>        <span class="st">"kwargs"</span>: {</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>            <span class="st">"column"</span>: <span class="st">"Age"</span>,</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>        },</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>    },</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>    organizations<span class="op">=</span>[<span class="dv">1</span>],</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>    databases <span class="op">=</span> [{<span class="st">"label"</span>: <span class="st">"default"</span>}],</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"test task"</span>,</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>    description<span class="op">=</span><span class="st">"My description"</span>,</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>    collaboration<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>    image<span class="op">=</span>image</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>)</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>results <span class="op">=</span> client.wait_for_results(central_task.get(<span class="st">"id"</span>))</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="bu">print</span>(results)</span></code></pre>
</div>
<p>which should print:</p>
<pre><code>{'data': [{'result': '{"average": 27.613448844884488}',
   'task': {'id': 2, 'link': '/api/task/2', 'methods': ['DELETE', 'GET']},
   'run': {'id': 4, 'link': '/api/run/4', 'methods': ['GET', 'PATCH']},
   'id': 4}],
 'links': {'first': '/api/result?task_id=2&amp;page=1',
  'self': '/api/result?task_id=2&amp;page=1',
  'last': '/api/result?task_id=2&amp;page=1'}}</code></pre>
<p>So the average age is 27.61!</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="publish-your-algorithm-in-the-algorithm-store">Publish your algorithm in the algorithm store<a class="anchor" aria-label="anchor" href="#publish-your-algorithm-in-the-algorithm-store"></a>
</h2>
<hr class="half-width">
<p><a href="./chap3_run_analysis_ui.html">Previously</a>, we have
discussed how to run algorithms from the algorithm store. Now, it is
time to publish your own algorithm in the algorithm store. This is
required if you want to run your algorithm in the user interface: the
user interface gathers information about how to run the algorithm from
the algorithm store. For example, this helps the UI to construct a
dropdown of available functions, and to know what arguments the function
expects.</p>
<p>The boilerplate you create should already contain an
<code>algorithm_store.json</code> file that contains a JSON description
of your algorithm - how many databases each function uses, for
example.</p>
<p>You can put the algorithm in the store by selecting the local
algorithm store in the UI. You should upload this algorithm into your
local test store, which is part of the <code>v6 dev</code> network. You
can do this by selecting that store in the UI, and then by clicking on
the “Add algorithm” button on the page with approved algorithms. You can
upload the <code>algorithm_store.json</code> file in the top. After
uploading it, you can change the details of the algorithm before
submitting it.</p>
<div id="challenge-5-add-your-algorithm-to-the-algorithm-store" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-5-add-your-algorithm-to-the-algorithm-store" class="callout-inner">
<h3 class="callout-title">Challenge 5: Add your algorithm to the algorithm store</h3>
<div class="callout-content">
<p>Your local <code>v6 dev</code> network is running an algorithm store
locally on <code>http://localhost:7602</code>, and a user interface on
<code>http://localhost:7600</code>. Log in to the UI and upload your
algorithm to the algorithm store. Note: the UI requests a link to your
code - you can fill in a dummy link for now.</p>
<p>Then, can you download the revised JSON file so you can update it in
your algorithm repository?</p>
</div>
</div>
</div>
<div id="accordionHint3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint3" aria-expanded="false" aria-controls="collapseHint3">
  <h4 class="accordion-header" id="headingHint3"> Give me a hint </h4>
</button>
<div id="collapseHint3" class="accordion-collapse collapse" aria-labelledby="headingHint3" data-bs-parent="#accordionHint3">
<div class="accordion-body">
<p>Use the <code>algorithm_store.json</code> which is present in your
algorithm code repository to fill in most of the details. Note, however,
that not everything is prefilled and you also need to adjust some
existing fields. Which fields do you need to adjust?</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<p>Go to the UI and log in. Then, go to the ‘Algorithm store’ section
and select the local algorithm store. Go to ‘Approved algorithms’, click
on ‘Add algorithm’ and upload the <code>algorithm_store.json</code>
file. Fill in the correct image name and set the type of the argument
‘column’ to ‘Column’ (this will ensure that the UI displays a dropdown
of all available columns).</p>
<p>You can find the revised JSON file on the page with the algorithm
details.</p>
</div>
</div>
</div>
</div>
<div id="challenge-6-run-your-algorithm-in-the-ui" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-6-run-your-algorithm-in-the-ui" class="callout-inner">
<h3 class="callout-title">Challenge 6: Run your algorithm in the UI</h3>
<div class="callout-content">
<p>Run your algorithm in the UI. The <code>v6 dev</code> network should
already provide you with a collaboration where all nodes are online.</p>
<p>Verify that the average age is still the same. Can you also get the
average height and weight?</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>Make sure that your <code>v6 dev</code> network is running. If not,
start it again with <code>v6 dev start-demo-network</code>.</li>
<li>Login to the UI, go to ‘Analyze’ section, select ‘Task’ and ‘Create
task’.</li>
<li>Select your algorithm from the dropdown.</li>
<li>Fill in the required fields. You should select the central function
and provide the column you want to calculate the average over.</li>
<li>Your algorithm should run successfully in the UI. The result should
- obviously - be the same as when you ran it with the Python client, so
we are expecting:</li>
</ol>
<p><code>Average ~= 27.61</code>.</p>
<p>Similarly, you can get the average height at 178.5 and the average
weight at 74.3.</p>
</div>
</div>
</div>
</div>
<div id="challenge-7-advanced-calculate-the-average-per-group" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-7-advanced-calculate-the-average-per-group" class="callout-inner">
<h3 class="callout-title">Challenge 7 (Advanced): Calculate the average per group</h3>
<div class="callout-content">
<p>Extend your algorithm to answer the following question: in the
<code>v6 dev</code> dataset, are gold medal winners older or younger
than silver medal winners?</p>
</div>
</div>
</div>
<div id="accordionHint4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint4" aria-expanded="false" aria-controls="collapseHint4">
  <h4 class="accordion-header" id="headingHint4"> Give me a hint </h4>
</button>
<div id="collapseHint4" class="accordion-collapse collapse" aria-labelledby="headingHint4" data-bs-parent="#accordionHint4">
<div class="accordion-body">
<p>Add a <code>group_by</code> argument to both the central and the
partial function. Pass this argument to the partial function when
creating the subtask, and use it in the partial function to group the
data.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7"> Show me the solution </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" aria-labelledby="headingSolution7" data-bs-parent="#accordionSolution7">
<div class="accordion-body">
<p>A working solution is provided in the <a href="https://github.com/vantage6/workshop-average-boilerplate/tree/advanced-challenge" class="external-link">workshop-average-boilerplate
repository</a>. Of course, multiple solutions are possible. Below is a
description of what you need to change compared to the algorithm
implementation you created in Challenge 2.</p>
<p>Your partial function may now look like this:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="at">@data</span>(<span class="dv">1</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="kw">def</span> partial_function(df: pd.DataFrame, column, group_by) <span class="op">-&gt;</span> Any:</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>    <span class="co">"""Decentral part of the algorithm"""</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>    grouped <span class="op">=</span> df.groupby(group_by)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>        <span class="st">"sum"</span>: grouped[column].<span class="bu">sum</span>().to_dict(),</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>        <span class="st">"count"</span>: grouped[column].size().to_dict(),</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>    }</span></code></pre>
</div>
<p>Your central function should be adapted to pass the
<code>group_by</code> argument to the partial function, and it should
aggregate the results per group, as something like this:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="kw">def</span> central_function(client: AlgorithmClient, column: <span class="bu">str</span>, group_by: <span class="bu">str</span>):</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>    ...</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>    results <span class="op">=</span> client.wait_for_results(task_id<span class="op">=</span>task.get(<span class="st">"id"</span>))</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>    global_sums <span class="op">=</span> {}</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>    global_counts <span class="op">=</span> {}</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>    <span class="cf">for</span> output <span class="kw">in</span> results:</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>        <span class="cf">for</span> key, value <span class="kw">in</span> output[<span class="st">"sum"</span>].items():</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>            <span class="cf">if</span> key <span class="kw">not</span> <span class="kw">in</span> global_sums:</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>                global_sums[key] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>            global_sums[key] <span class="op">+=</span> value</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>        <span class="cf">for</span> key, value <span class="kw">in</span> output[<span class="st">"count"</span>].items():</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>            <span class="cf">if</span> key <span class="kw">not</span> <span class="kw">in</span> global_counts:</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>                global_counts[key] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a>            global_counts[key] <span class="op">+=</span> value</span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>    results <span class="op">=</span> {}</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>    <span class="cf">for</span> key, value <span class="kw">in</span> global_sums.items():</span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a>        results[key] <span class="op">=</span> value <span class="op">/</span> global_counts[key]</span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a>    <span class="cf">return</span> results</span></code></pre>
</div>
<p>And when running this, the final results are:</p>
<pre><code>{"Bronze":27.39364035087719,"Gold":27.86445366528354,"Silver":27.637515842839036}</code></pre>
<p>Gold medal winners are older than silver medal winners. Practice
makes perfect!</p>
<p>In case you also aspire to be perfect, feel free to practice some
more. Be creative and think of other questions you can answer with this
dataset!</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="next-steps">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<hr class="half-width">
<p>Congratulations! You have successfully developed your first vantage6
algorithm. You have learned how to create a personalized boilerplate,
implement the algorithm functions, and run the algorithm using the
Python client and the UI. The resulting algorithm, however, is not
suitable yet for real-world use. For instance, if a node contains only a
single data point for a given column, there are no guards implemented
that prevent that such sensitive data is shared with the server. The
following steps are usually important to address before your algorithm
is ready for real-world use:</p>
<ul>
<li>
<strong>Privacy guards</strong>: implement privacy guards to ensure
that sensitive data is not shared with the server.</li>
<li>
<strong>Error handling</strong>: implement error handling to ensure
that the algorithm does not crash when unexpected input is provided.
Note that there are <a href="https://docs.vantage6.ai/en/main/function-docs/_autosummary/vantage6.algorithm.tools.exceptions.html#module-vantage6.algorithm.tools.exceptions" class="external-link">custom
vantage6 errors</a> that you can raise to provide more information about
what went wrong.</li>
<li>
<strong>Documentation</strong>: document your algorithm so that
others can understand how to use it, what their data should look like,
how to interpret the results, etc.</li>
</ul>
<p>Other next steps could be to extend the algorithm with more
functionality, such as allowing to calculate the average over multiple
columns, or to add a <code>group_by</code> argument to compute the
average per group.</p>
<p>In the final lesson of this course, you will have the opportunity to
work on your own projects. You can also use that to further develop your
algorithm!</p>
</section><section><h2 class="section-heading" id="future-changes">Future changes<a class="anchor" aria-label="anchor" href="#future-changes"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="sessions">Sessions<a class="anchor" aria-label="anchor" href="#sessions"></a>
</h3>
<p>We are currently using vantage6 version 4.7.1. The vantage6 team is
working on vantage6 version 5.0, which will bring changes to the
algorithm development process. Version 5.0 will introduce sessions,
which are a way to split up the algorithm into smaller parts: data
preparation, data preprocessing, data analysis, and post-processing. A
major advantage of this is that extensive data preparation only needs to
be done once per node instead of once per task, which can save a lot of
time. Also, it will be possible for a more experienced user to prepare
the data, while a less experienced user can simply run the algorithm on
the prepared data.</p>
<p>For algorithm developers, the sessions mean that you should then
split your algorithm functions into data preparation, analysis,
postprocessing, etc. The vantage6 team will make sure that proper
documentation will be available to help you with this transition.</p>
</div>
<div class="section level3">
<h3 id="algorithm-build-service">Algorithm build service<a class="anchor" aria-label="anchor" href="#algorithm-build-service"></a>
</h3>
<p>As was already mentioned <a href="./chap2_introduction_v6.html#build-services">previously</a>, the
vantage6 team is working on a build service that will automatically
build your algorithm into a Docker image. This will alleviate the
algorithm developer from having to worry about the Docker image, and
will allow them to focus on the algorithm itself. Also, it will ensure
that the image is built in a consistent and secure way, which may
enhance the trust in an algorithm image.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>v6 algorithm create</code> to create a personalized
boilerplate</li>
<li>Implement the partial functions to run on each node and the central
function to aggregate the results</li>
<li>Build your algorithm into a docker image</li>
<li>Test it with the mock client and with a local <code>v6 dev</code>
test environment</li>
<li>Publish your algorithm in the algorithm store to run it in the
UI</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-chap8_own_project"><p>Content from <a href="chap8_own_project.html">Work on your own project</a></p>
<hr>
<p>Last updated on 2024-10-02 |

        <a href="https://github.com/vantage6/vantage6-workshop/edit/main/episodes/chap8_own_project.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can you use vantage6 in your own project?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Start working on your own research project</li>
</ul>
<p>OR</p>
<ul>
<li>Complete some advanced challenges</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="working-on-your-own-project">Working on your own project<a class="anchor" aria-label="anchor" href="#working-on-your-own-project"></a>
</h1>
<p>In this chapter, we will give you the opportunity to work on your own
project. Feel free to ask questions and discuss your project with the
instructors. We are here to help you!</p>
<p>If you prefer, you can also complete some advanced challenges that we
have prepared for you. Note that these challenges don’t have one
solution - discuss your solutions with the workshop instructors!</p>
</div>
<div class="section level1">
<h1 id="advanced-challenges">Advanced challenges<a class="anchor" aria-label="anchor" href="#advanced-challenges"></a>
</h1>
<div id="challenge-1-add-privacy-filters-to-your-algorithm" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-add-privacy-filters-to-your-algorithm" class="callout-inner">
<h3 class="callout-title">Challenge 1: Add privacy filters to your
algorithm</h3>
<div class="callout-content">
<p>In the <a href="./chap7_algo_dev.html">previous lesson</a>, you have
created a simple algorithm. Now, you can add privacy filters to your
algorithm.</p>
<ul>
<li>Create an algorithm that does not return the results unless there
are more than 10 data points.</li>
<li>Make this value configurable by the node administrator. Hint: look
up the node configuration options in the <a href="https://docs.vantage6.ai" class="external-link">documentation</a> to provide environment
variables to your algorithm.</li>
<li>When the privacy filters are triggered, use one of the <a href="https://docs.vantage6.ai/en/main/function-docs/_autosummary/vantage6.algorithm.tools.exceptions.html" class="external-link">vantage6
exceptions</a> to return an error message.</li>
<li>What else could you do to protect the privacy of the data?</li>
</ul>
</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1"> Give me a hint </h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" data-bs-parent="#accordionHint1" aria-labelledby="headingHint1">
<div class="accordion-body">
<p>The <a href="https://github.com/vantage6/v6-crosstab-py/blob/main/v6-crosstab-py/partial.py#L64" class="external-link">contingency
table algorithm</a> already has a few privacy filters implemented. You
can use this algorithm as an example.</p>
</div>
</div>
</div>
</div>
<div id="challenge-2-use-your-own-data-the-v6-dev-network" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2-use-your-own-data-the-v6-dev-network" class="callout-inner">
<h3 class="callout-title">Challenge 2: Use your own data the v6 dev
network</h3>
<div class="callout-content">
<p>The algorithm that you created in the <a href="./chap7_algo_dev.html">previous lesson</a> uses dummy data. In
this challenge, you will use your own data in the <code>v6 dev</code>
network. If you don’t have any data, you can use the <a href="https://archive.ics.uci.edu/ml/datasets/iris" class="external-link">Iris
dataset</a>.</p>
<p>Locate and modify the node configuration files. Before starting the
algorithm, how can you make sure that the data is available to the
nodes?</p>
</div>
</div>
</div>
<div id="challenge-3-document-your-algorithm" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-3-document-your-algorithm" class="callout-inner">
<h3 class="callout-title">Challenge 3: Document your algorithm</h3>
<div class="callout-content">
<p>In the <a href="./chap7_algo_dev.html">previous lesson</a>, you have
created a simple algorithm. For this challenge, learn how to document
your algorithm.</p>
<ul>
<li>Make sure a documentation template is available in the algorithm
repository. If it is not, you can generate it using the
<code>v6 algorithm update --change-answers</code> command.</li>
<li>Install the dependencies required to run the documentation locally.
You can find the dependencies in the <code>requirements.txt</code> file
in <code>docs</code> folder.</li>
<li>Run the documentation locally in your browser. Use
<code>docs/README.md</code> to find out how to do this.</li>
</ul>
<p>For more details, learn about restructured text (rst) files
online!</p>
</div>
</div>
</div>
<div id="challenge-4-visualize-the-results-of-your-algorithm-in-the-ui" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4-visualize-the-results-of-your-algorithm-in-the-ui" class="callout-inner">
<h3 class="callout-title">Challenge 4: Visualize the results of your
algorithm in the UI</h3>
<div class="callout-content">
<p>In the <a href="./chap7_algo_dev.html">previous lesson</a>, you have
created a simple algorithm. In this challenge, modify the algorithm in
the algorithm store to include a table visualization. You can do this in
the UI by modifying your algorithm in the algorithm store.</p>
<p>Then, check that your algorithm’s results are displayed in a
table!</p>
</div>
</div>
</div>
<div id="accordionHint2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint2" aria-expanded="false" aria-controls="collapseHint2">
  <h4 class="accordion-header" id="headingHint2"> Hint: What do the docs say? </h4>
</button>
<div id="collapseHint2" class="accordion-collapse collapse" data-bs-parent="#accordionHint2" aria-labelledby="headingHint2">
<div class="accordion-body">
<p>Check the <a href="https://docs.vantage6.ai/en/main/algorithm_store/processes.html#algorithm-submission" class="external-link">documentation</a></p>
</div>
</div>
</div>
</div>
<div id="challenge-5-expand-your-average-algorithm" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-5-expand-your-average-algorithm" class="callout-inner">
<h3 class="callout-title">Challenge 5: Expand your average
algorithm</h3>
<div class="callout-content">
<p>In the <a href="./chap7_algo_dev.html">previous lesson</a>, you have
created a simple average algorithm. In this challenge, expand your
algorithm to calculate the one or more of the following:</p>
<ul>
<li>Standard deviation</li>
<li>Minimum</li>
<li>Maximum</li>
</ul>
<p>Consider which data you share in the partial results and how you can
minimize this to protect the privacy of the data.</p>
</div>
</div>
</div>
<div id="challenge-6-make-your-dev-environment-more-secure" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-6-make-your-dev-environment-more-secure" class="callout-inner">
<h3 class="callout-title">Challenge 6: Make your dev environment more
secure</h3>
<div class="callout-content">
<p>In the <a href="./chap7_algo_dev.html">previous lesson</a>, you have
created a simple algorithm with the <code>v6 dev</code> command. In this
challenge, make your development environment more secure.</p>
<p>Use the documentation to find configuration options that can help you
to:</p>
<ul>
<li>Enable two-factor authentication in the vantage6 server.</li>
<li>Change your node configuration to only allow running algorithms from
the local algorithm store. Verify that it then no longer allows running
the algorithms from the community store. Note that you can both
whitelist single algorithms or entire algorithm stores.</li>
<li>The <code>v6 dev</code> algorithm store has a specific setting that
turns off the need for review of algorithms - they are automatically
accepted. Change this setting to require review of algorithms. Feel free
to explore the review process in the Algorithm Store section of the
UI!</li>
</ul>
<p>Are there any other security measures you can take to make your
development environment more secure?</p>
</div>
</div>
</div>
<div id="accordionHint3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint3" aria-expanded="false" aria-controls="collapseHint3">
  <h4 class="accordion-header" id="headingHint3"> Hint: Ajdusting configuration </h4>
</button>
<div id="collapseHint3" class="accordion-collapse collapse" data-bs-parent="#accordionHint3" aria-labelledby="headingHint3">
<div class="accordion-body">
<p>To complete this challenge, locate the configuration files of the
<code>v6 dev</code> network and modify them. You may need to use the
<code>--user</code> flag to locate the server and algorithm store
configuration files.</p>
</div>
</div>
</div>
</div>
<div id="accordionHint4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint4" aria-expanded="false" aria-controls="collapseHint4">
  <h4 class="accordion-header" id="headingHint4"> Hint: Configuration changes don’t take effect </h4>
</button>
<div id="collapseHint4" class="accordion-collapse collapse" data-bs-parent="#accordionHint4" aria-labelledby="headingHint4">
<div class="accordion-body">
<p>Try restarting the <code>v6 dev</code> network after changing the
configuration files.</p>
</div>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/vantage6/vantage6-workshop/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/vantage6/vantage6-workshop/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/vantage6/vantage6-workshop/" class="external-link">Source</a></p>
				<p><a href="https://github.com/vantage6/vantage6-workshop/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:d.smits@esciencecenter.nl">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.10" class="external-link">sandpaper (0.16.10)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.7" class="external-link">pegboard (0.7.7)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.5" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://vantage6.github.io/vantage6-workshop/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "federated learning, privacy enhancing technology, python",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://vantage6.github.io/vantage6-workshop/aio.html",
  "identifier": "https://vantage6.github.io/vantage6-workshop/aio.html",
  "dateCreated": "2024-03-26",
  "dateModified": "2024-11-18",
  "datePublished": "2024-11-18"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

